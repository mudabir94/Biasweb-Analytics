<!DOCTYPE html>
<html lang="en">
<head>
        <title>Mobile Analytics</title>
		<meta charset="utf-8" >
		<meta name="viewport" content = "width=device-width, initial-scale=1.0">
        {% load staticfiles %}
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type="text/javascript" src="{% static 'webapp/js/jquery-ui.js' %}" charset="utf-8" ></script>
        <script type="text/javascript" src="{% static 'webapp/js/jquery.js' %}" charset="utf-8" ></script>
        <link rel="stylesheet" href="{% static 'webapp/css/jquery-ui.css' %}" type="text/css" />
        <link rel="stylesheet" href="{% static 'webapp/css/jquery-ui.structure.css' %}" type="text/css" />
        <link rel="stylesheet" href="{% static 'webapp/css/jquery-ui.theme.css' %}" type="text/css" />
        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
        <script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
		<script type="text/javascript" src="{% static 'webapp/js/one_mobile.js' %}" charset="utf-8"></script>
        <link rel="stylesheet" href="{% static 'webapp/bootstrap-4.1.3-dist/css/bootstrap.min.css' %}" type = "text/css"/>
        <script type="text/javascript" src="{% static 'webapp/bootstrap-4.1.3-dist/js/bootstrap.min.js' %}" charset="utf-8"></script>
        <link rel="stylesheet" href="{% static 'webapp/css/2by2tablecss.css' %}" type = "text/css"/>
        <link rel="stylesheet" href="{% static 'webapp/css/style.css' %}" type = "text/css"/>
    </head>
    <body>
        <nav class="navbar navbar-dark bg-dark">
                    <!-- <div class="container-fluid"> -->
                      <!-- <div class="navbar-header" > -->
                          
                        <a class="navbar-brand" href="#">Mobile Analytics</a>
                          
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                      <!-- </div> -->
                      <div class="collapse navbar-collapse" id="myNavbar">
                        <ul class=" navbar-nav mr-auto">
                         
                          <li><a href="{%url 'homepage'%}">Home </a></li>
                          <li><a href="#" >About</a></li>
                          {% if  user.is_authenticated %}
                          <li><p id="username">{{ user.get_username }}</p></li>
                          <li><p id="role">{{ user.role_id.role_name }}</p></li>
                          <li><a href="{% url 'logout'%}">Logout</a></li> 
                          {% else %}
                          <li><a href="{% url 'login'%}?next={{request.path}}">Login</a></li>   
                          {% endif %}  
                        </ul>
                        <!--<ul class="nav navbar-nav navbar-right">
                          <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                        </ul>-->
                      </div>
                    <!-- </div> -->
        </nav>

        <div class='container-fluid'>
            <div class='row'>
                <div class="col-md-2" style="background:black"></div>
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12" >
                            <div id="tablediv"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-2" style="background:hotpink"></div>
            </div>
        </div>
        
    </body>
</html>
<script >

  
   // Global variable 
   var allmobile={}
   $(document).ready(function(){
    $.ajax({
                type: 'POST',
                dataType: "json",
                'data': {

                'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
        // the ajax call is sent to subdetails url name in the post function.  
                url: "{% url 'comparemobile_specs' %}",
                success: function(data){
                    console.log(data)
                    allmobile=data
                    makeTable(allmobile)
                    }

                }); 
   });
function makeTable(allmobile){
    features=['Model','price']
    var table=document.createElement("TABLE");
    table.setAttribute('class','table-bordered')
    var thead=document.createElement("THEAD");
    table.appendChild(thead)
    var tbody=document.createElement("TBODY");
    table.appendChild(tbody);
    var trh=document.createElement("TR");
    thead.appendChild(trh);
    var th=document.createElement('TH')
    trh.appendChild(th);
    th.append("Criteria");
    var count=0;
    var mobilename=[]
    var specs=[]
    for (var namekey  in allmobile){
        
        mobilename.push(namekey)
        console.log("namekey",namekey)
        console.log('allmobile[namekey]',allmobile[namekey])
        var th=document.createElement('TH')
        trh.appendChild(th);
        th.append(namekey)
        if (count==0){
            var rowcount=0
            for (var mobilespec in allmobile[namekey]){
            if (mobilespec==='imagepath1'){
                specs.push('imagepath1')
                
                var tr=document.createElement('TR');
                tr.setAttribute('id','imagepath1'+rowcount)
                tbody.appendChild(tr);
                var td=document.createElement('TD');
               
                tr.appendChild(td);
                td.append('imagepath1');
                var td=document.createElement('TD');
                
                tr.appendChild(td);
                var img=document.createElement('img');
                img.setAttribute('class','img-responsive')
                var im=allmobile[namekey][mobilespec]
                console.log("hhbjn",im)
                img.src="/static/"+im;
                img.style="height: 154px;"
                td.append(img);
                console.log('mobilespec',mobilespec)
                console.log('allmobile[namekey][mobilespec]',allmobile[namekey][mobilespec])
                
                rowcount++;
                $('#tablediv').append(table) 
                }
            else{
                specs.push(mobilespec)
                
                var tr=document.createElement('TR');
                tr.setAttribute('id',mobilespec+rowcount)
                tbody.appendChild(tr);
                var td=document.createElement('TD');
                tr.appendChild(td);
                td.append(mobilespec);
                var td=document.createElement('TD');
                
                tr.appendChild(td);
                td.append(allmobile[namekey][mobilespec]);
                console.log('mobilespec',mobilespec)
                console.log('allmobile[namekey][mobilespec]',allmobile[namekey][mobilespec])
                
                rowcount++;
                $('#tablediv').append(table) 
            }
        }
           
        }
        else{
            var rowcount=0
            for (var mobilespec in allmobile[namekey]){
                if (mobilespec==='imagepath1'){
                    var img=document.createElement('img');
                img.setAttribute('class','img-responsive')
                var im=allmobile[namekey][mobilespec]
                console.log("hhbjn",im)
                img.src="/static/"+im;
                img.style="height: 154px;"
                    var extendrow=document.getElementById(mobilespec+rowcount)
                     td_cell=extendrow.insertCell(-1);
                    td_cell.append(img)
                rowcount++;
                 
                }
                else{
                var extendrow=document.getElementById(mobilespec+rowcount)
                td_cell=extendrow.insertCell(-1);
                td_cell.innerHTML=allmobile[namekey][mobilespec]
                rowcount++;
                }
            }
        
        }
        count++;
    }
    console.log(specs)
    var rowcount=0;
    for (var mbs in specs){
       
        console.log("mbs",specs[mbs])
        
    var refrow =document.getElementById(specs[mbs]+rowcount);

    if (refrow!=null){
        var newrow = document.createElement("TR");
        newrow.setAttribute('id','imageSlider-'+mobilename)
        var td=document.createElement('TD');
        newrow.appendChild(td);
        td.append("Slider ");
        var td=document.createElement('TD');
        newrow.appendChild(td);
        var input = document.createElement("input");
        input.type = "range";
        input.id='range1'
        input.min="1"
        input.max="9"
        input.step="1"
        input.value="1"
        input.setAttribute('oninput',"showSliderRangeVal(this)")
        td.append(input)
        td.setAttribute('colSpan',"2")
        
        refrow.parentNode.insertBefore(newrow, refrow.nextSibling);
        rowcount++;
        }
    }
}

function showSliderRangeVal(element){
    console.log(element.value)
    
}
// for (var i in features){
    //     if (features[i]===mobilespec){
    //         var td=document.createElement('TD');
    //         console.log("mobilespec",mobilespec)
    //         tr.appendChild(td);
    //         td.append(features[i]);
            
    //      }           
    //     else if (features[i]==="imagepath1")
    //     {
    //         var td=document.createElement('TD');
    //         tr.appendChild(td);
    //         td.append(features[i]);
    //         console.log('asdasdasd')
    //     }
    // }
</script>



