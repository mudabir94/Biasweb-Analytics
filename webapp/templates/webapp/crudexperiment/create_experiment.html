{% extends "webapp/crudexperiment/base_experiment.html" %}
{% block content %}
{%load static from staticfiles%}

<div class="container-fluid text-center "> 
    <!-- MAIN ROW CONTENT DIV  -->

    <div class="row is-flex content">
        <!-- 1st SIDEBAR COL DIV -->
        <div class="col-md-2" style='background-color:#c6c8ca'>
            <div class='container-fluid'>
              {% with template_sidebar=creat_exp_template_sidebar %}
              {% include template_sidebar %}
              {% endwith %}
            </div>
        </div>
        <div class="col-md-7 text-left" > 
             
            <div class='row-fluid'>
                    <div class='row' id='custom_nav_div' >
                        <div class='col'><button id='ftlvl' class='custom_nav_btn active 'onclick='showFeatureLvls($(this))'><span class="custom_span">Feature Levels</span></button> </div>
                        <div class='col'><button id='btchmng' class='custom_nav_btn'onclick='showBatchManagement()'><span class="custom_span">Manage Batch</span> </button></div>
                        <div class='col'><button id='blkmng' class='custom_nav_btn' onclick='showBlockManagement()'><span class="custom_span">Manage Block</span></button></div>
                        <div class='col'><button id='create_exp_mobile_catalog' class='custom_nav_btn' onclick='mobileCatalog()'><span class="custom_span">Phone Set Management</span></button></div>
                        <div class='col'><button id='def_crit_list_btn' class='custom_nav_btn' onclick='showCritrtia()'><span class="custom_span">Criteria List</span></button></div>

                    </div>    
                </div>
                <br>
            <!-- Bread Crumbs -->
            <div class="row-fluid" id="breadcrumb_div">
                <nav>
                    <ol class="breadcrumb bg-dark" id="ol1">
                        
                    </ol>
                    <ol class="breadcrumb bg-dark" id="ol2">
                        
                    </ol>
                    <ol class="breadcrumb bg-dark" id="ol3">
                        
                    </ol>
                    <ol class="breadcrumb bg-dark" id="ol4">
                        
                    </ol>
                </nav>
            </div>
            <!-- Catalog Selection Criteria -->
            <div class="row-fluid" id="catalog_crit_sel">

            </div>
            <!-- Default Criteria  -->
            <div class="row-fluid" id="default_criteria_main_div"> 
              
                <div class="row-fluid" id="default_criteria_div">

                </div>
            </div>
             <!-- Order Criteria  -->
             <div class="row-fluid" id="order_criteria_div">

            </div>
             <!-- CDM DIV  -->
             <div class="row-fluid" id="cdm_criteria_div">

            </div>
             <!-- CDM ON CO ON DIV  -->
            <div class="row-fluid" id="cdm_co_on_show_Option">

            </div>
            <div class="row-fluid" id="cdm_co_on_cfull_cprune_btn_div">

            </div>
             <div class="row-fluid" id="cdm_co_on_div">

            </div>
        

            <!-- CREATE EXP ROW DIV  -->
            <div class ="row-fluid">     
                    <div class ="row">   
                        <div class='col-md-12' >
                          
                        <!-- <p1>Create Experiment </p1> Show Experiment Id here e.g. ses-007 (admin id) + experiment no. (5 digits) -->
                        </div>  
                    </div>
                    <div class ="row"> 
                        <div class='col-md-12' id='cr_exp_header' >    
                        <!-- <p1>Admin id {{admin_id}}</p1> -->
                        </div>                            
                    </div>
                    <div class ="row"> 
                        <div class='col-md-12' >
                        <!-- <p1>Experiment id {{experiment_id}}</p1> -->
                        </div>                            
                    </div>
            </div>
            <!-- CUSTOM NAV ROW DIV -->
           
            <!--FEATURES LEVELS ROW DIV -->
            <div class='row-fluid' id='feat_lvl_div'>
                <div class='row'>
                    <div class='col-md-3' id="ft_levels_div">
                            <p1><b>Select features to enable:</b></p1>
                    {% for feature in platformfeatobj%}
                        <div class='row-fluid'>
                            <div class='col-md-12'>
                                <input type="checkbox"  id='{{feature.id}}' action='{%url "createexp"%}'
                                        method="post" 
                                        value="{{feature.feature_symbol}}" 
                                        onclick="outerCheckBox($(this).attr('value'),$(this).attr('id'))">
                                        {{feature.feature_name}} 
                                        <div  id='{{feature.id}}-innercheckboxdiv' class='innerchecksboxdivs' title='{{feature.feature_symbol}}' value='{{feature.feature_symbol}}'>
                                        </div>
                                </input>
                                <br>
                            </div>
                        </div>
                        {%endfor%}
                    
                        <div class='row-fluid'>
                            <button id="sendfeatlvl_btn" onclick='sendFeatureLevels()'> Set Feature Levels </button>
                        </div> 
                    </div>
                    <div class=col-md-5>
                        <div id='defaultfeatLevel_tablediv'>
                            <hr>
                            <h4>Status Report Default</h4>

                        </div>
                    </div>
                    <div class='col-md-3'  >
                        <div class='row'>
                            <div class='col-md-12'>
                            </div>
                        </div>
                        <div class='row'>
                            <div class='col-md-12'>
                                <div class='table-responsive' id='generated_blocks' style="height:500px"></div>
                            </div>    
                        </div>
                       

                    </div>
                    
                    <div class='col-md-1' >
                      
                       
                             <button id="nextbtn_to_batch"  class="btn btn-primary" onclick='showImportSubdiv()'>NEXT</button>

                            
                    
                    </div>
                </div>
            </div>  
            <br>
           
            <!-- IMPORT SUBJECT DIV ROW DIV-->
            <div class='row-fluid' id='importSubdiv'> 
                    <div class='row'>
                        <div class='col-md-1'>
                            <div class='row-fluid'></div>
                        </div>
                        <div class='col-md-5'>
                            <!-- Import Subjects Div -->
                            <div class='row-fluid'>
                                    <div class='row'>
                                        <div class='col-md-12'>
                                        <label>Import Subjects</label>
                                        </div>
                                    </div>
                                <br>
                             
                                    <div class='row'>
                                            <div class='col-md-2'>
                                                <label>Import CSV File</label>
                                            </div>
                                            <div class='col-md-5'>
                                                <input type="file"  id="fileUpload" onclick="chooseFileFunc()"/>
                                            </div>
                                            <div class='col-md-5'>
                                                <input type="button" id="upload" value="Upload" /> 
                                            </div>
                                
                                    </div>
                                <br>
                                    <div class='row'>
                                        <div class='col-md-2'>
                                            <label>Import Excel File</label>
                                        </div>
                                        <div class='col-md-5'>
                                                <input type="file"  id="excelFile" />
                                        </div>
                                        <div class='col-md-5'>
                                                <input type="button" id="excelFileUpload" value="Upload" /> 
                                        </div>

                                       
                                       
                                    </div>
                                </div>
                            <hr />
                            <!--SET COLUMN LABELS SELECTORS-->
                            <div class='row'>
                                    <div class='col-md-12'  >
                                            <div class='row'>
                                                    <div class='col-md-6' ><div class='map_select_label' id='custom_label_id'>Custom id</div> </div>
                                                    <div class='col-md-6'> <div class="show_select_tag" id="show_s1"></div></div>
                                            </div>
                                    </div>
                                    <div class='col-md-12' >
                                            <div class='row'>
                                                    <div class='col-md-6' > <div class='map_select_label' id='email_label_id'>Email</div></div>
                                                    <div class='col-md-6'> <div class="show_select_tag" id="show_s2"></div></div>
                                            </div>
                                    </div>
                                    <div class='col-md-12' >
                                            <div class='row'>
                                                    <div class='col-md-6' > <div class='map_select_label' id='batchT_label_id'>Batch Title</div></div>
                                                    <div class='col-md-6'> <div class="show_select_tag" id="show_s3"></div></div>
                                            </div>
                                    </div>
                            </div>
                            <!-- Proceed Btn Div -->
                            <div class='row'>
                                    <div class='col-md-12' >
                                        <div class='col-md-6' > </div>
                                        <!-- postExpData -->
                                        <div class='col-md-6'> <div id='proceedbtndiv'></div></div>
                                    </div>
                            </div>
                        
                            <!-- Self Defined DIV -->
                            <div class='row-fluid' >
                                        <!-- Ask USER FOR SELF DEFAULT OR CUSTOM -->
                                        <div class='row-fluid'>
                                                <div id='self_permission_text_div'></div>
                                        </div>
                                        <div class='row-fluid'>
                                               <div class='row'>
                                                   <div class='col-md-6' >
                                                       <div id='self_button_yes_div'></div>
                                                   </div>
                                                   <div class='col-md-6'>
                                                        <div id='self_button_no_div'></div>
                                                   </div>
                                               </div>
                                        </div>
                                        <!-- Self Button Display -->
                                        <div class='row-fluid' >
                                               
                                                <div class='col-md-12' id='selfbuttondiv'>
                                                
                                                </div>
                                        </div>
                                        
                                        <!-- Self defined Input Fields -->
                                        <div class='row-fluid' >
                                            <div class='col-md-12'  id='self-defined'>
                                                    <hr/>
                                                    <div class='row'>
                                                        <div class='col-md-6'><div class='self-defined-inputs' id='batchtitle_name'></div></div>
                                                        <div class='col-md-6'><div class='self-defined-inputs'  id='batchtitle_input'></div></div>

                                                    </div>
                                                    <div class='row'>
                                                        <div class='col-md-6' ><div class='self-defined-inputs'  id='batchnum_name'></div></div>
                                                        <div class='col-md-6' ><div class='self-defined-inputs'  id='batchnum_input'></div></div>
                                                    </div>
                                                    <div class='row'>
                                                        <div class='col-md-6'><div class='self-defined-inputs'  id='batchlabel_name'></div></div>
                                                        <div class='col-md-6'><div class='self-defined-inputs'  id='batchlabel_input'></div></div>
                                                    </div>
                                                    <div class='row'>
                                                        <div class='col-md-6' ></div>
                                                        <div class='col-md-6' id='self-assignbuttondiv'></div>
                                                    </div>

                                            </div>
                                        </div>
                            </div>
                            <!-- PreDefined Div-->
                            <div class='row-fluid'>
                                    <div class='row-fluid' >
                                        <div class='col-md-12' id='predefbuttondiv'>
                                            
                                        </div>
                                    </div>

                                    <div class='row-fluid' >

                                        <div class='col-md-12' id='pre-defined'> 
                                            <hr/>
                                            <div class='row'>
                                                    <div class='col-md-6'><div id='custom_label_id1'></div></div>
                                                    <div class='col-md-6'><div id='custom_tag_id1'></div></div>
                                            </div>
                                            <div class='row'>
                                                    <div class='col-md-6'><div id='email_label_id1'></div></div>
                                                    <div class='col-md-6'><div id='email_tag_id1'></div></div>
                                            </div>
                                            <div class='row'>
                                                    <div class='col-md-6'><div id='batchT_label_id1'></div></div>
                                                    <div class='col-md-6'><div id='batchT_tag_id1'></div></div>
                                            </div>
                                            <!-- <div class='row'>
                                                    <div class='col-md-12' id="pre-batchtitletext"></div>
                                            </div>
                                            <div class='row'>
                                                <div class='col-md-12' id="pre-RadioDiv"></div>
                                            </div>-->
                                            <div class='row'>
                                                    <div class='col-md-6' ></div>
                                                    <div class='col-md-6' id="pre-assignbuttondiv"></div>
                                            </div> 
                                        </div> 
                                
                                    </div>
                            </div>
                        </div>
                      
                        <div class='col-md-6'>
                            <div class='row-fluid'>
                                <div class='col-md-12'>
                                            <div>Batch Summary</div>
                                </div>
                            </div>
                            <div class='row-fluid'>
                                <div class='col-md-12'>  
                                        <div class='batchsize_div'></div>
                                </div>
                            </div>
                            <br>  
                            
                        </div>      
                    </div> 
                    <!-- Row Ending -->
                    <br>   
            </div>
            <!--Hiding Feature level  -->
            <!-- <div class='row-fluid' id='dispFileFeatLvldiv' style='background:aqua'>
                    <div class='col-md-1'></div>
                    
                   
                     <div class='col-md-5'> 
                             <div class='row-fluid'>
                                     <div class='col-md-12'>
                                          <label> Feature Levels</label>
                                     </div>
                                 </div>
                                 <div class='row-fluid'>
                                     <div class='col-md-12'>

                                     </div>    
                                 </div>
                                 <div class='row-fluid'>
                                         <div class='col-md-12' >
                                             <div class='displayfeaturelevelTable'>

                                             </div>
                                         </div>
                                 </div>
                     </div>
                     <div class='col-md-1'></div>
            </div> -->
            <!--  -->
            <div class='row-fluid' id='dataDiv' style="background:lawngreen" >
                  
                            <div class='row-fluid'>
                                <div id='dataDiv-label'>  
                                    <label> Uploaded data from file. </label>
                                </div>
                              
                            </div>
                             <!--DATA & DETAILS EDITING DISPLAY SECTION-->
                            <div class='row-fluid' >
                                <div class='col-md-12'>
                                    <div id="showfiledatadiv">
                                     </div>
                                </div>
                            </div>
                    
            </div>
            <!--  -->
            <div class='row-fluid' id='subj_split_batch_rowdiv'>
                                    
                    <div class='col-md-12'>
                            <div class='row-fluid'>
                                <div id='subj_split_batch_rowdiv_batch_label'>
                                <label>Subject Split to Batches</label>
                                </div>
                            </div>
                            <div class='row-fluid'>
                                <div id='subj_split_batch_tabel' class=" table-bordered">
                                </div>
                            </div>
                    </div>

            </div>

             <!--BLOCK ASSIGNMENT ROW DIV-->
            <div class='row-fluid' id='block_assign_row_div' >
                    <div class='row'>
                        <div class="col-md-6" >
                                <br>
                                <br>
                                    <div class='row-fluid'>

                                        <p1><b><i>Assign subjects to latest set of feature blocks?</b></i></p1>
                                        <br>
                                        <br>
                                        <button style="background: #1f8c6e;box-shadow: 0 0 0.5px 0.5px #1f8c6e;border: none; cursor:pointer" onclick='assignToBlocks()'> Assign to Blocks </button>
                                    </div>
                        </div>
                    </div>
            </div>
          
                <br>
            <!--MY OUTPUT DIV ROW DIV-->
            <div class='row-fluid' id='blkoutputsDiv' style='background:rgb(252, 227, 8)'>  
                      
                        <div class='row'>
                                <!-- <div class='col-md-6'>
                                    <div id='blocksListDiv'></div>
                                </div> -->
                                <div class='col-md-12'>
                                   
                                    <div id='blocksBreakUpDiv'></div>
                                    
                                </div>
                        </div>
            </div> 
            <!-- Previous Btn -->
            <div class='row-fluid' id='batchmngprvbtn_div'>
                    <!-- <div class='col-md-1'>
                        <div id='prev_btn_div'>
                        <button style="background: #105796;box-shadow: 0 0 0.5px 0.5px #105796;border: none;" onclick="showFeatLvlDiv()">Previous</button>
                        </div>
                    </div>
                    <div class='col-md-5'></div>
                    <div class='col-md-6'>
                        <div id='save_button_div'>
                                <button onclick="saveExperiment()">Save</button>
                        </div>
                    </div> -->
            </div>
           
            <div class="row-fluid" id="phones_main_button_div">
             
                    <div class="col-md-12 col-sm-12" id="phoneset_button_div">

                      <!-- <button onclick="FuncA()">A</button>
                      <button onclick="FuncB()">B</button> -->
                      <!-- <button onclick="NextStep($(this))">Next Step</button> -->
                    </div>
            </div>
        

            <div class='row-fluid'>
                    <div class='row'>
                            <div class='col-md-12'>
                                    
                                        <div id="phsetnum_div"></div>
                                        <div id="ordersetnum_div"></div>
                                        <div id="defualt_criteria_popup"></div>
                                        <div id="criteria_display_popup"></div>


                            </div>
                    </div>
            </div>
           
            <!-- Mobile Catalog Div -->
            <div class='row-fluid' id='mobile_catalog_div'>
                   
                     
                <div class='row'>
                        <div class='col-md-12'>
                                
                                <div class="latest-product-section" > 
                                        {%  for mob in mobilephones  %}
                    
                                        {% if forloop.counter0|divisibleby:3 %} 
                                        <div class="row text-center">
                                            {%  endif %}
                                            
                                                <div class="col-md-4 col-lg-4 col-xs-12 sm-margin-b-50 pull-left">
                                                        <div class="margin-b-20" >
                                                        <!-- <h4>Compare</h4> -->
                                                        <input type="checkbox" value={{mob.id}} id={{mob.id}} name={{mob.id}}-{{mob.Mobile_Name}}  onchange="toggleCheckbox(this)"> 
                                                        <img class="img-responsive" src="{% static mob.imagepath1 %}"  alt="Latest Products Image"  title=""/>
                                                        </div>
                                                        <a class="link btn btn-success" href="{% url 'mobileinfo' id=mob.id %}">
                                                            {% filter upper %}
                                                                Read More
                                                            {% endfilter %}
                                                        </a>
                                                    
                                                </div>
                                                        {%  if forloop.counter|divisibleby:3 or forloop.last %}
                                                            </div><!-- row closing --><hr>
                                                            {%  endif %}
                                                        {%  endfor %}
                                    
                                </div>                    
                        </div>
                </div>
                                <!-- Pagination row -->
                    
                <div class='row'>
                        <div class='col-md-12'>
                            
                                <!-- <div class="pagination" >
                                        <span class="step-links">
                                        
                                            {% if mobilephones.has_previous %}
                                                <a href="?page=1">&laquo; first</a>
                                                <a href="?page={{ mobilephones.previous_page_number }}">previous</a>
                                            {% endif %}
                                            
                                            <span class="current">
                                                Page {{ mobilephones.number }} of {{ mobilephones.paginator.num_pages }}.
                                            </span>
                                        
                                            {% if mobiles.has_next %}
                                                <a href="?page={{ mobilephones.next_page_number }}">next</a>
                                                <a href="?page={{ mobilephones.paginator.num_pages }}">last &raquo;</a>
                                            {% endif %}
                                        </span>
                                </div> -->
                        </div>
                </div>
            </div>
            
            <div  id="pager_div">
                <div class="turn-page" id="pager"></div>
            </div>
        </div>
        <!-- "background: rgb(148, 0, 14);" -->
        <div class="col-md-3" style='background-color:#c6c8ca'>
            <div class='container-fluid'>
                {% with template_sidebar=creat_exp_template_sidebar2 %}
                {% include template_sidebar %}
                {% endwith %}
              </div>
        </div>   
    </div>
    <!-- <footer>
		
        <div class="container-fluid" style='margin-left:15px'>
            <p><a href="#" target="blank">Contact</a> | <a href="#" target="blank">LinkedIn1</a> | <a href="#" target="blank">Twitter</a> | <a href="#" target="blank">Google+</a></p>
        </div>
   </footer>	 -->
</div>   
<div class="modal"><!-- Place at bottom of page --></div>

<script>
var active_button=''

var global_phones_exp_phones=[]
//Global Variable
var block_feat_dict = {};

var arr_feature_levels=[];
var globalfiledatalist=[];
var exp_id = '{{sess_expId}}';
var custom_exp_id='{{sess_custExpId}}';
var block_list = [];
// for csv file uploading. 
var global_rows=[];

// var header = document.getElementById("custom_nav_div");
var btns = document.getElementsByClassName("custom_nav_btn");

// variable to save outer and inner check box div info. for pre populating. 
var checkbox_id_dict={};
window.row_filedata=null;


//  runs when the page is loaded/called. 
$(document).ready(function () {       
    $('#pager').hide();
    initializePage();
    getDefaultFLevelsFromPlatformFeature();
});
/* ** Hides all divs except feat_lvl_div.**
   ** checks exp_id, if it exsists then asks for working on it, else discards**
   ** if it exsists and working on it is confirmed. **
      *** Loads all dictionaries that will be used to populate the ui such as feature levels dict, blocklist dict etc. *** 
*/
function initializePage(){
// This Will hide all the divs with class=innercheckboxdivs
$("#ol1").hide();
$("#ol2").hide();
$("#ol3").hide();
$("#ol4").hide();



$("#order_criteria_div").hide();
$('.innerchecksboxdivs').hide();
$('.map_select_label').hide();
$('.show_select_tag').hide();
$('#self-defined').hide();
$('#pre-defined').hide();
$('#selfbuttondiv').hide();
$('#blkoutputsDiv').hide();

$('#prebuttondiv').hide();
$('#upload').prop('disabled',true);
$('#importSubdiv').hide();
$('#dispFileFeatLvldiv').hide();
$('#subj_split_batch_rowdiv').hide();
$('#block_assign_row_div').hide();
$('#brand_check_div').hide();
$('#crit_option_sidebar_div').hide();
//$('#blkoutputsDiv').hide();
$('#batchmngprvbtn_div').hide();
$('#dataDiv').hide();
$('#price_slider').hide();
$('#phones_main_button_div').hide();
$("#exp_sel_phones_div").hide();
$("#searchfilter_head_div").hide();

$('#feat_lvl_div').show();




// Exp id is null//
if(exp_id===""){
    /*
        *test to see if session exp empty
        *if not, then alert that session exists
        *if ok, load the experiment details as were
        *else, set sess_expId to None
    */
    /*
        * By default hide mobile catalog div...
    */
    // $("#create_exp_mobile_catalog").css('background-color','black');
    // $("#create_exp_mobile_catalog").css('color','black');
    // $("#create_exp_mobile_catalog").css('cursor','not-allowed');
    // $("#create_exp_mobile_catalog").attr("disabled", true); 
    // disableMobileCatalogButton();
    disableCriteriaButton();


} else {

    let contin = confirm("Continue working on Experiment: "+custom_exp_id+"?");
     if(contin===false){

        //  alert("TO BE IMPLEMENTED AS AJAX CALL")
        alert ("Discarding everything. ")
        
         localStorage.removeItem("blockList");
         localStorage.removeItem("checkbox_id_dict");
         localStorage.removeItem("feat_dict");
        //  $('#feat_lvl_div').hide();
         exp_id="";
        //  ajax call to remove pickle data
         $.ajax({
                type: 'POST',
                dataType: "json",
                'data': {

                'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
        // the ajax call is sent to subdetails url name in the post function.  
                url: "{% url 'remove_session_obj' %}",
                success: function(data){
                        alert('Deleted')
                    }
                }); 
    /*
        * By default hide mobile catalog div...
    */
         
            // disableMobileCatalogButton();
            disableCriteriaButton();




     }
     else{
         
        showExpWIP();
        // TO BE IMPLEMENTED
        // Check through an ajax call if anything related to dict,blocklist etc
        // is stored in the database if data is not null then save the 
        // retrieved data into dict,checkbox_id_dict
        //else try to get data from local storage... 
        
        //* Fetching feature_level dictionary containing feature symbol as key and its sub levels as values.*
        block_feat_dict=JSON.parse(window.localStorage.getItem("feat_dict")); 
        //* Dictionary of checkboxes already checked by the user along with sub checklevels as values ( for history of checkboxes  checked )*
        checkbox_id_dict=JSON.parse(window.localStorage.getItem("checkbox_id_dict")); 
        //* block list contains the combinations of feature levels that will be used for display as a table*
        var blockList = JSON.parse(window.localStorage.getItem("blockList")); 

        console.log("Feature_levels_dict",block_feat_dict)
        console.log("checkbox_id_dict",checkbox_id_dict)
        //* Population of block list table with block list. 
        if ( blockList===null){
                alert('block list empty');
            }
        else{
            table_blocks=draw_block_table(blockList)
            display_blocktable(table_blocks);
        }
        //* Population of feature level table with feature levels . 

        if (block_feat_dict==null ){
            block_feat_dict={}
        }
        else {
            displayfeaturelevelTable();
        }
        /* Filling outer checkboxes when the page is loaded.  
        ** First Check if checbox_id_dict is empty if not then run following, else do nothing. 
        ** Runs a SEPERATE OUTERCHECKBOX function that generates checkboxes exactly like the original one, but doesnt store data in dict.
        ** Which will run a seperate showinnerbox function to populate the innerchecboxes. 
        */
      
        if (checkbox_id_dict==null){
            checkbox_id_dict={};
        }

        else{
            /* Strong implementation which will create Outer checkboxes and tick the ones already selected */
             showcheckboxes_stored();
        }

        // Showing saved subject data. 
        // send an ajax call and get the expCont.subjData of the current Exp Object. 
        getSavedSubjectDataExpCont();

    //     if (Object.keys(default_crit_show_dict).length === 0 && Object.keys(default_crit_hide_dict).length === 0){
    //     alert("CHECK")
       
    //     default_crit_show_dict=JSON.parse(window.localStorage.getItem("default_crit_show_dict")); 
    //     default_crit_hide_dict=JSON.parse(window.localStorage.getItem("default_crit_hide_dict")); 
    //     console.log("default_crit_show_dict----",default_crit_show_dict)
    //     console.log("default_crit_hide_dict----",default_crit_hide_dict)

    // }
        
        }
    }
}
/* Strong implementation which will create Outer checkboxes and tick the ones already selected */
/*  As checkbox_id_dict is global here we will simply use it. 
    ** It gets the keys one by one, which is basically the ids of checkboxes and set their check prop to true. 
    ** OuterCheckBox_Store is then called, passing the value (e.g P.1,P.2) and key (e.g 6) to it. 
*/
function showcheckboxes_stored(){
    p_flag=false;
    for (var key in checkbox_id_dict){
            console.log('cheCKebox value',checkbox_id_dict[key]);
            console.log('key',key);
            var outercheckbox = document.getElementById(key);
            if (key==="7"){
            /*
                // IN FUTURE
                // Create a show and edit button. 
                // show button fuctionality will be to only show the display the CO.
                // Edit button will reopen the CO page with the same number of sets that were set previously and the user can not edit it. 
            */
                var crit_order=JSON.parse(window.localStorage.getItem("crit_order_dict"));
                var crit_hide=JSON.parse(window.localStorage.getItem("crit_hide_dict")); 
                crit_order_dict=crit_order
                crit_hide_dict=crit_hide;
            }
            if (key==="6"){
                p_flag=true;
                var slider_dict=JSON.parse(window.localStorage.getItem("slider_set_dict")); 
                var brand_dict=JSON.parse(window.localStorage.getItem("brand_set_dict")); 
                var phone_dict=JSON.parse(window.localStorage.getItem("phoneset_dic")); 
                var pname_dic=JSON.parse(window.localStorage.getItem("phonename_dic")); 
                slider_set_dict=slider_dict;
                brand_set_dict=brand_dict;
                phoneset_dic=phone_dict;
                phonename_dic=pname_dic;
                setlist=[];
                for (var i in phoneset_dic){
                    setlist.push(i)
                }
                console.log('slider_dict',slider_dict);
                console.log('brand_dict',brand_dict);
                console.log('phone_dict',phone_dict);
                console.log('pname_dic',pname_dic);

            }
           
            outercheckbox.checked = true; 
            outerCheckBox_Stored( outercheckbox.getAttribute('value') ,key )
        }
        // disabling Mobile Catalog button if p is not ticked!.
        if (p_flag===false) {
        // $("#create_exp_mobile_catalog").css('background-color','black');
        // $("#create_exp_mobile_catalog").css('color','black');
        // $("#create_exp_mobile_catalog").css('cursor','not-allowed');

        // $("#create_exp_mobile_catalog").attr("disabled", true); 
        // disableMobileCatalogButton();
        }

}

function outerCheckBox_Stored(outercheckval,outercheckid) {

/* Ajax call is made to send the outercheckboxid to the controller/server. 
    // The controller will fetch the sub-details of that feature from model and return back in success function. 
    // Success funtion will first check if the outercheckbox is checked or unchecked. 
    // If unchecked it'll simply hide the innercheckboxdiv or do nothing as by default its hidden.
    // else will populate data in that div and show to user.
*/  
$.ajax({
type: 'POST',
dataType: "json",
'data': {
'd': JSON.stringify(outercheckval),
'csrfmiddlewaretoken': '{{ csrf_token }}',
},
// the ajax call is sent to subdetails url name in the post function.  
url: "{% url 'subdetails' %}",
success: function(data){
console.log("success");
var outerckbox = $('#'+outercheckid);
console.log('outercheckbox obj',outerckbox);
        // For this Function IF CONDITION SHOULD ALWAYS BE TRUE... 
        if (outerckbox.is(':checked')) {
            // alert('You Checked');
            console.log('outercheckval',outercheckval);
            console.log('data retrieved',data)
            
            //checkbox_id_dict[outercheckid]=[];
            showInnerCheckBoxDivs_Stored(outercheckid,data);
            // updateFeatureLvls();
        } 
        else {
            // alert('You Un-Checked it');
            // For now its purpose is simply to hide the innercheckdivs.  
            hideInnerCheckBoxDivs(outercheckid);
            // console.log(outercheckval);
            // block_feat_dict[outercheckval]=null;
            // if (block_feat_dict[outercheckval]==null  ){
            //     delete block_feat_dict[outercheckval];
            //     console.log('in else condition');  
            // }
            // console.log(block_feat_dict)
            // updateFeatureLvls();
        }
}
}); 
}


function showInnerCheckBoxDivs_Stored(outercheckid,data){
        console.log('#'+outercheckid+'-innercheckboxdiv')
        // Creating inner checks and populating them with data. 
        console.log(checkbox_id_dict)
        var k=checkbox_id_dict;
        var innercheckbox_id_list=[];
        var value_found=''
        /* Phone set and Criteria Ordering are the Anamolies
            ** For both of them different checks but same functionality. **
            ** Fetching the innerCheckBox Div it will first clear it.**
            ** FOR NOW, Getting the data from block_feat_dict while the others from subdetails/-> Data. **
            ** Load the Data Present in feature level block_feat_dict in it. **
            ** And simply display the div. **

         */
        
        if (outercheckid==="6"){

            console.log(block_feat_dict);
            $('#6-innercheckboxdiv').empty();
            var row_div=document.createElement("div");
            row_div.setAttribute("class",'row');
            var col_md_6_div=document.createElement("div");
            col_md_6_div.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div);
            col_md_6_div.append(block_feat_dict['P'])
            var col_md_6_div_2=document.createElement("div");
            col_md_6_div_2.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div_2);
            var edit_href=document.createElement("a");
            edit_href.setAttribute("onclick","mobileCatalog()");
            edit_href.setAttribute("class","edit_href")

            edit_href.innerHTML="Edit";
            col_md_6_div_2.append(edit_href)
        
            $('#'+outercheckid+'-innercheckboxdiv').append(row_div);
            $('#'+outercheckid+'-innercheckboxdiv').show();



        }
        else if (outercheckid==="7"){
            $('#'+outercheckid+'-innercheckboxdiv').empty();
            $('#'+outercheckid+'-innercheckboxdiv').show();

            var row_div=document.createElement("div");
            row_div.setAttribute("class",'row');
            var innercheckboxdiv=document.getElementById('7-innercheckboxdiv')
            innercheckboxdiv.append(row_div);
            var col_md_6_div=document.createElement("div");
            col_md_6_div.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div);
            col_md_6_div.append(block_feat_dict["CO"])
            var col_md_6_div_2=document.createElement("div");
            col_md_6_div_2.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div_2);
            var view_href=document.createElement("a");
            view_href.setAttribute("onclick","criteriaDispPopup()");
            view_href.setAttribute("class","view_href")

            view_href.innerHTML="View";
            col_md_6_div_2.append(view_href);
            
           
            $('#'+outercheckid+'-innercheckboxdiv').show();
           
        }
        /* For all others */
        else{
            for (var o in data){
                    console.log('A',o);    
                    var innercheck_element =  $(document.createElement("input")).attr({
                            id: o +'-innercheckbox-'+outercheckid,
                            name:  '',
                            value: data[o],
                            text :'',
                            type:  'checkbox',
                            checked:true,
                            onclick:"innerCheckBox($(this).attr('value'),$(this).attr('id'),\
                            $(this).parent().attr('title'), $(this).parent().attr('id')\
                            )"
                            })
                    var inner_id=innercheck_element.attr('id')
                    console.log('inner_id',inner_id)
                    console.log('outercheckid',outercheckid);
                    console.log('INNERCHECK FUNC CHECKBOX DICT',k);
                    console.log('array',k[outercheckid])

                    var stored_innercheckbox_id_list=k[outercheckid]
                    console.log('stored_innercheckbox_id_list',stored_innercheckbox_id_list);
                    delete stored_innercheckbox_id_list[value_found];
                    console.log(stored_innercheckbox_id_list)
                    if (jQuery.isEmptyObject(stored_innercheckbox_id_list)){
                    
                        innercheck_element.prop('checked',false)
                    }
                    else {
                            for (var value_id in stored_innercheckbox_id_list){
                                
                                console.log("stored_innercheckbox_id_list[value_id]",stored_innercheckbox_id_list[value_id]);
                                console.log ('inner_id',inner_id)
                                        if (stored_innercheckbox_id_list[value_id]===inner_id)
                                        {    console.log('in if cond')
                                            innercheckbox_id_list.push(inner_id)

                                            value_found=value_id
                                            console.log("stored_innercheckbox_id_list",stored_innercheckbox_id_list);
                                            
                                            break;
                                        }
                                        else{
                                            console.log('in else cond')
                                            innercheck_element.prop('checked',false)

                                        }
                            }
                    }
                    // adding input attributes to a div
                    $('#'+outercheckid+'-innercheckboxdiv').append(innercheck_element);
                    $('#'+outercheckid+'-innercheckboxdiv').append(data[o]);
                    $('#'+outercheckid+'-innercheckboxdiv').show();
                }
            
            }

            checkbox_id_dict[outercheckid]=innercheckbox_id_list;
            console.log('DICTionary',block_feat_dict);

            console.log('All innercheck boxid added to checkbox dict',checkbox_id_dict);
}


/* 
   *Function that hides the divs containing innercheckbox*
   *No Func for phoneset and CO, and might not need it.*

*/
function hideInnerCheckBoxDivs(outercheckid){
    delete checkbox_id_dict[outercheckid];
    var get_chkbx_id_dict=JSON.parse(window.localStorage.getItem("checkbox_id_dict")); 
    var get_chkbx_id_dict=checkbox_id_dict;
    var set_chkbx_id_dict=get_chkbx_id_dict;
    window.localStorage.setItem("checkbox_id_dict", JSON.stringify(set_chkbx_id_dict));

    console.log("checkbox_id_dict",checkbox_id_dict);
$('#'+outercheckid+'-innercheckboxdiv').hide();
$('#'+outercheckid+'-innercheckboxdiv').empty();

}


function getSavedSubjectDataExpCont(){
    $.ajax({
        type: 'POST',
        dataType: "json",
        'data': {

            'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        // the ajax call is sent to subdetails url name in the post function.  
        url: "{% url 'get_saved_subject_data_expcont' %}",
        success: function(data){
        console.log("data['subject_data']",data['subject_data'])
        
        // console.log('keys',Object.keys(data['subject_data'])[0])
        // console.log(Object.keys(data['subject_data'][Object.keys(data['subject_data'])[0]]).length);
        //  for (var i=0;i<Object.keys(data['subject_data'][Object.keys(data['subject_data'])[0]]).length;i++){

        //  }
         }
                     
    }); 
}


function defaultFeatLevel_Table(){
    var defaultdic={};
    defaultdic['I']=['I.1'];
    defaultdic['R']=['R.1'];
    defaultdic['W']=['W.direct'];
    defaultdic['A']=['A.all','A.user']
    defaultdic['C']=['C.full']
    var table=document.createElement('TABLE');
    table.setAttribute('class','table table-striped table-bordered')
    var thead=document.createElement('THEAD');
    table.appendChild(thead);
    var tbody=document.createElement('TBODY');
    table.appendChild(tbody);
    var trh=document.createElement('TR');
    var th=document.createElement('TH')
    thead.appendChild(trh)
    th.append('Feature Symbol')
    trh.appendChild(th)
    var th=document.createElement('TH')
    th.append('Feature Levels')
    trh.appendChild(th)
    if (defaultdic==='{}'){
        console.log('empty table');
    }
    else{
        for (var row in defaultdic){
      
        var tr=document.createElement('TR');
        tbody.appendChild(tr)
        var td=document.createElement('TD')
        td.append(row)
        tr.appendChild(td)
        var td=document.createElement('TD')
        td.append(defaultdic[row])
        tr.appendChild(td)
        }
    }
    
    console.log(table)
    $(table).appendTo('#defaultfeatLevel_tablediv');
    //block_feat_dict=default_dic;
}

 $(function () {
    $("#excelFileUpload").bind("click", function () {
    var fileUpload = $("#excelFile")[0];

   
 //Validate whether File is valid Excel file.
 console.log('k',fileUpload);
 var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;
 if (regex.test(fileUpload.value.toLowerCase())) {
     if (typeof (FileReader) != "undefined") {
         var reader = new FileReader();

         //For Browsers other than IE.
         if (reader.readAsBinaryString) {
             reader.onload = function (e) {
                 
                 ProcessExcel(e.target.result);
             };
             reader.readAsBinaryString(fileUpload.files[0]);
         } else {
             //For IE Browser.
             reader.onload = function (e) {
                 var data = "";
                 var bytes = new Uint8Array(e.target.result);
                 for (var i = 0; i < bytes.byteLength; i++) {
                     data += String.fromCharCode(bytes[i]);
                 }
                 ProcessExcel(data);
             };
             reader.readAsArrayBuffer(fileUpload.files[0]);
         }
     } else {
         alert("This browser does not support HTML5.");
     }
 } else {
     alert("Please upload a valid Excel file.");
 }
    });
});
function ProcessExcel(data) {
        //Read the Excel File data.
        var workbook = XLSX.read(data, {
            type: 'binary'
        });
 
        //Fetch the name of First Sheet.
        var firstSheet = workbook.SheetNames[0];
 
        //Read all rows from First Sheet into an JSON array.
        //  var excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);
        var excelRows = XLSX.utils.sheet_to_csv(workbook.Sheets[firstSheet]);
        excelRows=excelRows.split("\n");
        var filedatalist=[]

        for (var row in excelRows){
                        if (excelRows[row]==''){
                            console.log("excelRows[row]",excelRows[row])
                            excelRows.splice(row, 1)
                        }else{
                        filedatalist.push(excelRows[row]);
                        }
                    }
       global_rows=excelRows
       console.log('excel rows',excelRows)
       setFileDataList(filedatalist);
             
       showFileDataTable(excelRows)
       console.log('header',excelRows[0]);
       header=excelRows[0];
       header=header.split(',');
       console.log('header',header[0]);
       console.log('header',typeof(header));
       $('#excelFileUpload').prop('value', 'Uploaded');
                        
       $('#excelFileUpload').prop('disabled',true);
       var select_tag1 = $('<select id="s1"/>');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag1);
                        for(var col in header) {

                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag1);
                        }
                        //DEFAULT FOR TESTING
                        select_tag1.val('0');
                        var select_tag2 = $('<select id="s2" />');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag2);
                        for(var col in header) {
                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag2);
                        }
                        var select_tag3 = $('<select id="s3" onchange="onS3Select(this)"/>');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag3);
                        for(var col in header) {
                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag3);
                        }
                        //DEFAULT FOR TESTING
                        select_tag3.val('1');
                        $('#show_s1').append(select_tag1);
                        $('#show_s2').append(select_tag2);
                        $('#show_s3').append(select_tag3);
                        var proceedbtn= document.createElement("BUTTON");
                        proceedbtn.setAttribute("style","background: #1f8c6e;box-shadow: 0 0 0.5px 0.5px #1f8c6e;border: none;")
                        var proceedStr="Process Import"
                        var text = document.createTextNode(proceedStr);
                        proceedText = proceedbtn.appendChild(text)
                        proceedbtn.onclick = function() {postExpData()};
                       // proceedbtn.classList.add("");

                        $('#proceedbtndiv').append(proceedbtn)
                        $('.map_select_label').show();
                        $('.show_select_tag').show();
        //Add the data rows from Excel file.

        // $.ajax({
        // type: 'POST',
        // dataType: "json",
        // 'data': {
        //     'excel_data':JSON.stringify(excelRows),
        //     'csrfmiddlewaretoken': '{{ csrf_token }}',
        // },
        // // the ajax call is sent to subdetails url name in the post function.  
        // url: "{% url 'import_excel' %}",
        // success: function(data){
        //   console.log("DATA");
        //   console.log(data);
        // }
                     
    // }); 
 
       
};


// Don't know it is used or not
// Code for changing the background colour of the custom_nav_bt
for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("active");
    current[0].className = current[0].className.replace(" active", "");
    this.className += " active";
    console.log('classname',this.className);
  });
}


// Uploading file Function . 
function showImportSubdiv(){
    // setting current active btn.
    // var current=$('#ftlvl')
    var current=$(".active");
    current.prop('class',current.attr('class').replace('active',""));
    $('#btchmng').prop('class', 'custom_nav_btn active');
    $('#pager').hide();
    $('#feat_lvl_div').hide();
    $('#mobile_catalog_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();
    $("#phones_main_button_div").hide(); 
    $('#importSubdiv').show(1000);
    $('#batchmngprvbtn_div').show();
}
function showFeatLvlDiv(){
    $('#order_criteria_div').hide();
    $('#importSubdiv').hide();
    $('#block_assign_row_div').hide();
    $('#dataDiv').hide();
    $('#batchmngprvbtn_div').hide();
    $('#dataDiv').hide();
    $('#expphonelist_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();
    $('#pager').hide();


    $("#phones_main_button_div").hide(); 

    $('#mobile_catalog_div').hide();
    $("#exp_description_div").show();

    $('#feat_lvl_div').show( 1000);

    // var current=$('#btchmng')
    var current=$(".active");
    current.prop('class',current.attr('class').replace('active',""));
    $('#ftlvl').prop('class', 'custom_nav_btn active');
}

function displayfeaturelevelTable(){
    $('#dispFileFeatLvldiv').show();
    makeFeatureLvldicTable();

}
function makeFeatureLvldicTable(){
    var table=document.createElement('TABLE');
    table.setAttribute('class','table table-striped table-bordered')
    var thead=document.createElement('THEAD');
    table.appendChild(thead);
    var tbody=document.createElement('TBODY');
    table.appendChild(tbody);
    var trh=document.createElement('TR');
    var th=document.createElement('TH')
    thead.appendChild(trh)
    th.append('Feature Symbol')
    trh.appendChild(th)
    var th=document.createElement('TH')
    th.append('Feature Levels')
    trh.appendChild(th)
    if (block_feat_dict==='{}'){
        console.log('emoty table');
    }
    else{
        for (var row in block_feat_dict){
      
        var tr=document.createElement('TR');
        tbody.appendChild(tr)
        var td=document.createElement('TD')
        td.append(row)
      
        tr.appendChild(td)
        var td=document.createElement('TD')
        
        td.append(block_feat_dict[row])
        tr.appendChild(td)
         }
    }
    
    console.log(table)
    $(table).appendTo("#displayfeaturelevelTablediv");
    $(table).appendTo(".displayfeaturelevelTable");
    window.localStorage.setItem("dispfeatlevels", JSON.stringify(block_feat_dict));
}
function updateFeatureLvls(){
    window.localStorage.setItem("dispfeatlevels", JSON.stringify(block_feat_dict));
    $('.displayfeaturelevelTable').empty();
    displayfeaturelevelTable();
}
function showFeatureLvls(){
    $("#ol1").hide();
    $("#ol2").hide();
    $("#ol3").hide();
    $("#ol4").hide();

    $("#cdm_co_on_show_Option").hide();
    $("#cdm_co_on_cfull_cprune_btn_div").empty();
    $("#catalog_crit_sel").hide();
    $('#importSubdiv').hide();
    $('#block_assign_row_div').hide();
    $('#dataDiv').hide();
    $('#batchmngprvbtn_div').hide();
    $('#dataDiv').hide();
    $('#mobile_catalog_div').hide();
    $('#pager').hide();

    $('#phones_main_button_div').hide();
    $('#expphonelist_div').hide();
    $('#price_slider_div').hide();
    $('#brand_check_div').hide();
    $("#exp_sel_phones_div").hide();
    $("#searchfilter_head_div").hide();
    $('#blkoutputsDiv').hide();
    $('#order_criteria_div').hide();
    $('#default_criteria_div').hide();
    $('#cdm_co_on_div').hide();
    $("#cdm_criteria_div").hide();



    $('#feat_lvl_div').slideDown(500);
    $("#cr_exp_header").show();
    $("#exp_description_div").show();


    $('#dispFileFeatLvldiv').show();
    

}
function showBatchManagement(){
    $("#exp_sel_phones_div").hide();
    $("#searchfilter_head_div").hide();
    $('#feat_lvl_div').hide();
    $('#block_assign_row_div').hide();
    $('#mobile_catalog_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();
    $("#catalog_crit_sel").hide();

    $("#phones_main_button_div").hide(); 
    $('#importSubdiv').slideDown();
    $("#exp_description_div").show();

    $('#pager').hide();

  
    $('#blkoutputsDiv').hide();

    $("#default_criteria_main_div").hide();
    $("#order_criteria_div").hide();
    $("#cdm_criteria_div").hide();
    $("#cdm_co_on_cfull_cprune_btn_div").empty();

    $("#cdm_co_on_show_Option").hide();
    $("#cdm_co_on_div").hide();
    $("#ol1").hide();
    $("#ol2").hide();
    $("#ol3").hide();
    $("#ol4").hide();
    $('#batchmngprvbtn_div').hide();
    $('#dispFileFeatLvldiv').show();

}
function HideALL(){
    $("#cr_exp_header").hide();
    $('#default_tree_view_div').hide();
    $('#block_assign_row_div').hide();
    $('#feat_lvl_div').hide();
    $('#dispFileFeatLvldiv').hide();
    $('#subj_split_batch_rowdiv').hide();
    $('#importSubdiv').hide();
    $('#dataDiv').hide();
    $('#batchmngprvbtn_div').hide();
    $('#mobile_catalog_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();
    $('#pager').hide();

    $("#phones_main_button_div").hide(); 
    $('#blkoutputsDiv').hide();
    // $('.innerchecksboxdivs').hide();
    $('.map_select_label').hide();
    $('.show_select_tag').hide();
    $('#self-defined').hide();
    $('#pre-defined').hide();
    $('#selfbuttondiv').hide();
    $('#blkoutputsDiv').hide();
    $('#prebuttondiv').hide();
    $('#upload').prop('disabled',true);
    $('#importSubdiv').hide();
    $("#exp_sel_phones_div").hide();
    $("#searchfilter_head_div").hide();



    // var current=$(".active");
    // current.prop('class',current.attr('class').replace('active',""));
}
function showBlockManagement(){
    // hiding all unneccesary rows
    $("#catalog_crit_sel").hide();

    $('#importSubdiv').hide();
    $('#feat_lvl_div').hide();
    $('#dispFileFeatLvldiv').hide();
    $('#subj_split_batch_rowdiv').hide();
    $('#dataDiv').hide();
    $('#batchmngprvbtn_div').hide();
    $('#blkoutputsDiv').hide();
    $('#pager').hide();

    $('#mobile_catalog_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();

    $("#phones_main_button_div").hide(); 
    $("#exp_description_div").show();

    $('#block_assign_row_div').show();
    // $('#blkoutputsDiv').show();
    $("#default_criteria_main_div").hide();
    $("#order_criteria_div").hide();
    $("#cdm_criteria_div").hide();
    $("#cdm_co_on_show_Option").hide();
    $("#cdm_co_on_cfull_cprune_btn_div").empty();

    $("#cdm_co_on_div").hide();
    $("#ol1").hide();
    $("#ol2").hide();
    $("#ol3").hide();
    $("#ol4").hide();

}
function showCritrtia(){
    $('#importSubdiv').hide();
    $('#feat_lvl_div').hide();
    $('#dispFileFeatLvldiv').hide();
    $('#subj_split_batch_rowdiv').hide();
    $('#dataDiv').hide();
    $('#batchmngprvbtn_div').hide();
    $('#blkoutputsDiv').hide();

    $('#mobile_catalog_div').hide();
    $("#price_slider_div").hide(); 
    $('#brand_check_div').hide();

    $("#phones_main_button_div").hide();    
    $('#block_assign_row_div').hide();
    $("#catalog_crit_sel").show();
    $("#exp_description_div").show();


    HideALL();
    if (CO_CDM_COMB==="CDM_off_CO_off"){
        $("#ol1").show();
        $("#default_tree_view_div").show();
        $("#default_criteria_div").show();
        $("#default_criteria_main_div").show();

        // if ($('.breadcrumb li').length>0 && $('.breadcrumb li').length===1 ){
        //     defualtCriteriaOrderHtmlSetup();
        // }else{
        //     defualtCriteriaHtmlSetup();
        // }
    }
    else if (CO_CDM_COMB==="CDM_on_CO_off"){
        $('#ol2').show();
        $('#cdm_criteria_div').show();
        // if ($('.breadcrumb li').length>0 && $('.breadcrumb li').length===1 ){
        //     cdm_defaultCriteriaOrderHTMLSetup();
        // }else{
        //     CdmCriteriaHTMLSetup();
        // }

    }
    else if (CO_CDM_COMB==="CDM_off_CO_on"){
        $("#ol4").show();
        $("#order_criteria_div").show();
        // if ($('.breadcrumb li').length>0 && $('.breadcrumb li').length===1 ){
        //     def_cdm_co_on_HtmlSetup();
        // }else{
        //     orderCriteriaHtmlSetup("CO",block_feat_dict["CO"],default_active);
        // }


    }
    else if (CO_CDM_COMB==="CDM_on_CO_on"){
        $("#ol3").show();
        $('#cdm_co_on_div').show();
        // if ($('.breadcrumb li').length>0 && $('.breadcrumb li').length===1 ){
        //     cdm_crit_order_on_flag="true";
        //     $("#cdm_co_on_show_Option").show();


        //     cdm_on_co_on_DefaultCriteriaHtmlSetup();
        // }else if  ($('.breadcrumb li').length>1 && $('.breadcrumb li').length===2 ) {
        //     cdm_crit_order_on_flag="false";
        //     $("#cdm_co_on_show_Option").show();

        //     cdm_On_Full_Co_HtmlSetup();
        // }
        // else if  ($('.breadcrumb li').length>2 && $('.breadcrumb li').length===3 ) {
        //     cdm_crit_order_on_flag="false";
        //     request_from_full="false";
        //     $("#cdm_co_on_show_Option").show();

        //     cdm_On_Prune_Co_HtmlSetup();
        // }
        // else if  ($('.breadcrumb li').length>3 && $('.breadcrumb li').length===4 ) {
        //     cdm_crit_order_on_flag="true";
        //     $("#cdm_co_on_show_Option").show();

        //     cdm_Order_On_Co_HtmlSetup();
        // }


        
    }
    else{
        alert("NOthing Present in Session")
    }

}
function showExpWIP(){
    $('#cr_exp_header').html("<p1>CREATE EXPERIMENT</p1>");
    $('#cr_exp_header').append("<p>"+custom_exp_id+" is UNDER CONSTRUCITON</p>");
}


function disableCriteriaButton(){
    $("#def_crit_list_btn").css('background-color','black');
    $("#def_crit_list_btn").css('color','black');
    $("#def_crit_list_btn").css('cursor','not-allowed');
    $("#def_crit_list_btn").attr("disabled", true); 
}
function enableCriteriaButton(){
    $("#def_crit_list_btn").css('background-color','');
    $("#def_crit_list_btn").css('color','');
    $("#def_crit_list_btn").css('cursor','pointer');
    $("#def_crit_list_btn").attr("disabled", false); 
}
function disableMobileCatalogButton(){
    $("#create_exp_mobile_catalog").css('background-color','black');
    $("#create_exp_mobile_catalog").css('color','black');
    $("#create_exp_mobile_catalog").css('cursor','not-allowed');
    $("#create_exp_mobile_catalog").attr("disabled", true); 
}
function enableMobileCatalogButton(){
    $("#create_exp_mobile_catalog").css('background-color','');
    $("#create_exp_mobile_catalog").css('color','');
    $("#create_exp_mobile_catalog").css('cursor','pointer');
    $("#create_exp_mobile_catalog").attr("disabled", false); 

}
function saveExperiment(){
    // Getting all data from local storage and sending to server
    alert (' Getting all data from local storage and sending to server')
    var dict_temp=JSON.parse(window.localStorage.getItem("feat_dict")); 
    var checkbox_id_dict_temp=JSON.parse(window.localStorage.getItem("checkbox_id_dict")); 
    var blockList_temp = JSON.parse(window.localStorage.getItem("blockList")); 
    if (dict_temp===null){
        dict_temp={}
    }
    if (checkbox_id_dict_temp===null){
        checkbox_id_dict_temp={}
    }
    if (blockList_temp===null){
        blockList_temp={}
    }
    ftDict_chkbxDict_blkLst={}
    ftDict_chkbxDict_blkLst['feat_dict']=dict_temp;
    ftDict_chkbxDict_blkLst['checbox_id_dict']=checkbox_id_dict_temp;
    ftDict_chkbxDict_blkLst['blockList_temp']=blockList_temp;
    $.ajax({
                type: 'POST',
                dataType: "json",
                'data': {
                'ftDict_chkbxDict_blkLst':JSON.stringify(ftDict_chkbxDict_blkLst),
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
    // the ajax call is sent to subdetails url name in the post function.  
                url: "{% url 'saveexperiment' %}",
                success: function(data){
                       alert(data['status']);
                       alert("on success remove every thing from local storage.\
                             ask for redirection to create_exp page.\
                             if yes then\
                             redirect otherwise do nothing.")
                       // on success remove every thing from local storage. 
                       // ask for redirection to create_exp page. if yes then 
                       // redirect otherwise do nothing. 

                    }
                }); 

}
$(function () {
    $("#upload").bind("click", function () {
        var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv)$/;
        if (regex.test($("#fileUpload").val().toLowerCase())) {
            if (typeof (FileReader) != "undefined") {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                    console.log(e);
                   
                    var table = $("<table  id='showfiledataTable'/>");
                    var rows = e.target.result.split("\n");
                    global_rows=rows;
                    console.log(global_rows);
                    var filedatalist=[]
                    /// check filedata for empty rows 
                    for (var row in rows){
                        if (rows[row]==''){
                            console.log("rows[row]",rows[row])
                            rows.splice(row, 1)
                        }else{
                        filedatalist.push(rows[row]);
                        }
                    }
                    console.log('filedatalist',filedatalist);

                    setFileDataList(filedatalist);
                    console.log('rows>>',rows);
                    console.log('rows type',typeof(rows));
                    showFileDataTable(rows);

                
                    
                    console.log('header',rows[0]);
                    header=rows[0];
                    header=header.split(',');
                    console.log('header',header[0]);
                    console.log('header',typeof(header));
                    // var table=document.createElement('TABLE');
                    // table.setAttribute('id','showfiledataTable')
                    // table.setAttribute('class',"display table table-striped table-bordered ")    
                    // var thead=document.createElement('THEAD')
                    // table.appendChild(thead)
                    // var tbdoy=document.createElement('TBODY');
                    // table.appendChild(tbdoy);
                   
                    // for (var rowindex in rows){
                    //  if (rowindex==0){
                    //     var trh=document.createElement('TR');
                    //     thead.appendChild(trh);
                    //     console.log(rows[rowindex])
                    //     var rowcols=rows[rowindex].split(',')
                    //     for (var j=0;j<rowcols.length;j++){
                    //         var th=document.createElement('TH');
                    //         th.append(rowcols[j])
                    //         trh.appendChild(th)
                            
                    //         }
                    //  }
                    //  else{
                    //     var tr=document.createElement('TR');
                    //     tbdoy.appendChild(tr);
                     
                    //     console.log(rows[rowindex])
                    //     var rowcols=rows[rowindex].split(',')
                    //     for (var j=0;j<rowcols.length;j++){
                    //         var td=document.createElement('TD');
                    //         td.append(rowcols[j])
                    //         tr.appendChild(td)
                            
                    //         }
                    //  } 
                    // }
                    // console.log(table)
                    //  $(table).appendTo("#showfiledatadiv");
                    //  $('#showfiledataTable').DataTable({
                           
                    //         "bLengthChange": false,
                    //         "bFilter": false,
                    //         "pageLength": 5,
                    //         "pagingType": "full_numbers"
                    //         });
                    //         $('#dataDiv').show();
                        // Disable the upload button when pressed. 
                        $('#upload').prop('value', 'Uploaded');
                        
                        $('#upload').prop('disabled',true);
                        var select_tag1 = $('<select id="s1"/>');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag1);
                        for(var col in header) {

                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag1);
                        }
                        //DEFAULT FOR TESTING
                        select_tag1.val('0');
                        var select_tag2 = $('<select id="s2" />');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag2);
                        for(var col in header) {
                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag2);
                        }
                        var select_tag3 = $('<select id="s3" onchange="onS3Select(this)"/>');
                        $('<option />', {value: "", text:"None"}).appendTo(select_tag3);
                        for(var col in header) {
                            $('<option />', {value: col, text: header[col]}).appendTo(select_tag3);
                        }
                        //DEFAULT FOR TESTING
                        select_tag3.val('1');
                        $('#show_s1').append(select_tag1);
                        $('#show_s2').append(select_tag2);
                        $('#show_s3').append(select_tag3);
                        var proceedbtn= document.createElement("BUTTON");
                        proceedbtn.setAttribute("style","background: #1f8c6e;box-shadow: 0 0 0.5px 0.5px #1f8c6e;border: none;")
                        var proceedStr="Process Import"
                        var text = document.createTextNode(proceedStr);
                        proceedText = proceedbtn.appendChild(text)
                        proceedbtn.onclick = function() {postExpData()};
                       // proceedbtn.classList.add("");

                        $('#proceedbtndiv').append(proceedbtn)
                        $('.map_select_label').show();
                        $('.show_select_tag').show();
                       //$('.show_select_tag').html('');
                       //$('.show_select_tag').append(select_tag);

                }
                
                // reader.readAsBinaryString($("#fileUpload")[0].files[0]);
                reader.readAsText($("#fileUpload")[0].files[0]);

            }
             else {
                alert("This browser does not support HTML5.");
            }
        } 
        else {
            alert("Please upload a valid CSV file.");
        }
    });
});    
function  showFileDataTable(rows){
                    
                    var table=document.createElement('TABLE');
                    table.setAttribute('id','showfiledataTable')
                    table.setAttribute('class',"display table table-striped table-bordered ")    
                    var thead=document.createElement('THEAD')
                    table.appendChild(thead)
                    var tbdoy=document.createElement('TBODY');
                    table.appendChild(tbdoy);
                   
                    for (var rowindex in rows){
                        if (rowindex==0){
                            var trh=document.createElement('TR');
                            thead.appendChild(trh);
                            console.log(rows[rowindex])
                            var rowcols=rows[rowindex].split(',')
                                for (var j=0;j<rowcols.length;j++){

                                    var th=document.createElement('TH');
                                    // th.setAttribute('class','success')
                                    th.append(rowcols[j])
                                    trh.appendChild(th)
                                    
                                }
                        }
                        else{
                            var tr=document.createElement('TR');
                            tbdoy.appendChild(tr);
                        
                            console.log(rows[rowindex])
                            var rowcols=rows[rowindex].split(',')
                                    for (var j=0;j<rowcols.length;j++){
                                        var td=document.createElement('TD');
                                        td.append(rowcols[j])
                                        tr.appendChild(td)
                                        
                                    }
                        } 
                    }
                    console.log(table)
                    $("#showfiledatadiv").html('');
                    $(table).appendTo("#showfiledatadiv");
                    $('#showfiledataTable').DataTable({
                            "bLengthChange": false,
                            "bFilter": false,
                            "pageLength": 5,
                            "pagingType": "full_numbers"
                            });
                    $('#dataDiv').show();

        }

function showBatchSummaryDiv(){
    $('.batchsize_div').show();
}
function hideBatchSummaryDiv(){
    $('.batchsize_div').hide();
}
function emptySelfBatchTable(){
    $('#self_batch_size_summary').empty();
}
function emptyPreBatchTable(){
    $('#pre_batch_size_summary').empty();

}
function emptyOneBatchTable(){
    $('#one_batch_summery_table').empty();

}

function onS3Select(select) {
     //alert(select.options[select.selectedIndex].text);
     if (select.options[select.selectedIndex].text==='None'){
        $('#selfbtnid').prop('disabled',false);
        emptySelfBatchTable();
        emptyPreBatchTable();
        emptyOneBatchTable();

     }
     else{
        $('#selfbtnid').prop('disabled',true);

        $('#selfbuttondiv').empty();
        $('#self-defined').hide( 1000 );
        $('#batchtitle_name').empty();
        $('#batchtitle_input').empty();
        $('#batchnum_name').empty();
        $('#batchnum_input').empty();
        $('#batchlabel_name').empty();
        $('#batchlabel_input').empty();
        $('#self-assignbuttondiv').empty();
        $('#self_permission_text_div').empty();
        $('#self_button_yes_div').empty();
        $('#self_button_no_div').empty();
        // hideBatchSummaryDiv();
        emptySelfBatchTable();
        emptyPreBatchTable();
        emptyOneBatchTable();
        $('#subj_split_batch_tabel').empty();
        
        $('#subj_split_batch_rowdiv').hide();
        refreshFileDataList();
     }
}
function assignToBlocks(){
    $('#blocksBreakUpDiv').html(
        "<font color=red><b><i>Please wait while the assignment is being processed</i></b></font>")
    $.ajax({
        type: 'POST',
        dataType: "json",
        'data': {

            'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        // the ajax call is sent to subdetails url name in the post function.  
        url: "{% url 'assign_blocks' %}",
        success: function(data){
            
            console.log("<<---RECEIVED ASSIGN TO BLOCK POST RETURN--->>");
            console.log(data)
            // for(var i in data){
            //     console.log("data:",i,data[i]);
            // }
            var blocks=JSON.parse(data['blocks']);
            var block_table_extended=document.getElementById('blocks_table');

            var block_table_extended_thead=block_table_extended.tHead;
            var block_table_extended_thead_row=block_table_extended_thead.rows[0];
            console.log('head row',block_table_extended_thead_row);
            // block_table_extended_thead.appendChild(th);
            // th.append('A');
            console.log(block_table_extended.tHead.innerHTML);
            console.log(block_table_extended.tBodies[0].rows.length)
            var block_table_extended_tbody=block_table_extended.tBodies[0];
            var   block_table_extended_tbody_row_length=  block_table_extended.tBodies[0].rows.length;
            
            const keys = Object.keys(blocks)
            console.log(keys);
            console.log("block_table_extended_tbody_row_length",block_table_extended_tbody_row_length);
            if (block_table_extended.tBodies[0].rows[block_table_extended.tBodies[0].rows.length-1].cells[1].innerHTML!="Batch Totals"){
             var col_list=[]; 
             for (var i=0;i<block_table_extended_tbody_row_length;i++)
             {
                 console.log('i',block_table_extended.tBodies[0].rows[i].innerHTML);
                 var tr=block_table_extended.tBodies[0].rows[i];
                 console.log(i);
                 console.log(keys[i])
                 key=keys[i];
                 for (var  j in blocks[key]){
                                if (col_list.includes(j)) {
                                console.log('Do  nothing')
                                }
                                else{
                                col_list.push(j);
                                var th_cell=block_table_extended_thead_row.insertCell(-1);
                                th_cell.innerHTML=j;

                                }
                    var td_cell= tr.insertCell(-1);
                    td_cell.innerHTML=blocks[key][j]
                    console.log(blocks[key][j]);
                 }

            }

            console.log('block_table_extended',block_table_extended.tBodies[0].rows[block_table_extended.tBodies[0].rows.length-1].cells[1].innerHTML);
           
                    var newRow   = block_table_extended_tbody.insertRow(block_table_extended_tbody_row_length);
                    var newCell  = newRow.insertCell(0);
                    newCell.innerHTML='';
                    var newCell  = newRow.insertCell(1);
                    newCell.innerHTML='Batch Totals';
                    for (var cells in blocks['Total']){
                        var newCell  = newRow.insertCell(-1);
                        newCell.innerHTML= blocks['Total'][cells];
                    }
                    // $('#blocks_table').DataTable({"pageLength": 5 });
                    // $('#blocks_table').appendTo('#blocksBreakUpDiv')
                    $('#blocksBreakUpDiv').append('#blocks_table');
                    // $("#block_assign_row_div").hide();
                    if(data['blocks']!=="Empty"){
                        alert('Blocks Created in Feature LEVELS')
                        
                    } else {
                        alert('PLEASE IMPORT SUBJECTS FIRST')
                    }
            }
            showFeatureLvls();
            var bllmng=document.getElementById('blkmng');
            var ftlvl=document.getElementById('ftlvl');

            bllmng.setAttribute("class","custom_nav_btn")
            ftlvl.setAttribute("class","custom_nav_btn active")
            console.log("block_table_extended_tbody_row_length", block_table_extended.tBodies[0].rows.length);

            
        }
                     
    }); 
}
var proceedbtncount=0
function showSelfBarButton(){
        var selfbutton= document.createElement("BUTTON");
        var text = document.createTextNode("Self Defined ");
        selfbutton.appendChild(text);
        selfbutton.onclick = function() {switchVisible($('#self-defined'),header)};
        selfbutton.classList.add("barbutton");
        selfbutton.id='selfbtnid';
        $('#selfbuttondiv').append(selfbutton).slideDown(1000).fadeIn(1000);
}
function hideSelfBarButton(){
        $('#selfbtnid').prop('disabled',true);
        $('#selfbuttondiv').empty();
        $('#self-defined').hide( 1000 );
        $('#batchtitle_name').empty();
        $('#batchtitle_input').empty();
        $('#batchnum_name').empty();
        $('#batchnum_input').empty();
        $('#batchlabel_name').empty();
        $('#batchlabel_input').empty();
        $('#self-assignbuttondiv').empty();
        $('#subj_split_batch_rowdiv').hide();
        $('#subj_split_batch_tabel').empty();
        $('.batchsize_div').empty();
        $('#showfiledataTable').empty();
        showFileDataTable(global_rows);
        emptyOneBatchTable();
        emptyPreBatchTable();
        emptySelfBatchTable();
        var filedt=getFileDataList();
        console.log('filedata');
        console.log(filedt);
        $.ajax({
                    type: 'POST',
                    dataType: "json",
                    'data': {
                    'csvfiledata': JSON.stringify(filedt),
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    },
                    // the ajax call is sent to subdetails url name in the post function.  
                    url: "{% url 'selfdefault' %}",
                    success: function(data){
                        console.log('success')
                        console.log(data);
                        var one_batch_summery_table=document.createElement('TABLE');
                        one_batch_summery_table.setAttribute('class','table table-bordered');
                        one_batch_summery_table.setAttribute('id','one_batch_summery_table');
                        var t_head=document.createElement('THEAD');
                        var t_body=document.createElement('TBODY');

                        one_batch_summery_table.appendChild(t_head);
                        one_batch_summery_table.appendChild(t_body);
                        var trh=document.createElement('TR')
                        t_head.appendChild(trh);
                        var th=document.createElement('TH');
                        trh.appendChild(th);
                        th.append('BATCH');
                        var th=document.createElement('TH');
                        trh.appendChild(th);
                        th.append('Size');
                        var total=0;
                        for ( var row in data){
                            console.log(row);
                            console.log(data[row]);
                            var tr=document.createElement('TR');
                            t_body.appendChild(tr);
                            var td=document.createElement('TD');
                            tr.appendChild(td);
                            td.append(row);
                            var td=document.createElement('TD');
                            tr.appendChild(td);
                            td.append(data[row]);
                            var num=parseInt(data[row])
                           total=total+num;
                        }
                        var tr=document.createElement('TR');
                        t_body.appendChild(tr);
                        var td=document.createElement('TD');
                        td.append('Total');
                        tr.appendChild(td);
                        var td=document.createElement('TD');
                        td.append(total);
                        tr.appendChild(td);
                        $(one_batch_summery_table).appendTo('.batchsize_div')    
                       
                       }
                     
                    }); 

}
function postExpData(){
    
    var custom_id=$('#s1').children('option:selected').text();
    var email=$('#s2').children('option:selected').text() ;
    var batch_field=$('#s3').children('option:selected').text();
   
    if (batch_field=='None'){
        emptyOneBatchTable();
        emptyPreBatchTable();
        emptySelfBatchTable();
        $('.batchsize_div').empty();
        $('#self_permission_text_div').empty();
        $('#self_button_yes_div').empty();
        $('#self_button_no_div').empty();
        $('#showfiledatadiv').empty();

        showFileDataTable(global_rows);
        // '<b>Would you like to create new batches now?</b><br><i>(if not, then by default the subjects will be considered as \"Batch 1\")</i>
        var self_permission_text_div=document.createElement('Label');
        self_permission_text_div.append('Would you like to create new batches now?(if not, then by default the subjects will be considered as Batch 1)')
        $('#self_permission_text_div').append(self_permission_text_div);
        var self_button_yes=document.createElement('BUTTON');
        self_button_yes.setAttribute('id','self_button_yes');
        self_button_yes.setAttribute('onclick','showSelfBarButton()');
        var yestext = document.createTextNode("YES ");
        self_button_yes.appendChild(yestext);
        $('#self_button_yes_div').append(self_button_yes);

        var self_button_no=document.createElement('BUTTON');
        self_button_no.setAttribute('id','self_button_no');
        self_button_no.setAttribute('onclick','hideSelfBarButton()');
        var notext = document.createTextNode("NO");
        self_button_no.appendChild(notext);
        $('#self_button_no_div').append(self_button_no);
        $('#self_button_no_div').append("<br/>");

   }
    else{
        // Divs to be removed when button pressed. 
        emptyOneBatchTable();
        emptyPreBatchTable();
        emptySelfBatchTable();
        $('.batchsize_div').empty();
        $('#showfiledatadiv').empty();
        

        // refreshFileDataList();

        
        var filedat=getFileDataList();
        
        console.log('before setting filedata',filedat);
        // if (proceedbtncount!==0){
        //     filedat.pop();
        //     filedat.pop();
        //     filedat.pop();
        // }
        filedat.push(custom_id);
        filedat.push(email);
        filedat.push(batch_field); 
        showFileDataTable(global_rows);
        console.log('afer setting filedata',filedat);
        // proceedbtncount++;
        refreshFileDataList();
        $.ajax({
                        type: 'POST',
                        dataType: "json",
                        'data': {
                        'csvfiledata': JSON.stringify(filedat),
                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                        },
                        // the ajax call is sent to subdetails url name in the post function.  
                        // HAVE TO REMOVE IT LATER   
                        // >>url: "{% url 'postexp' %}",
                        url: "{% url 'import_subjects' %}",
                        success: function(data){
                            console.log("<<---SUBJECT IMPORT POST WAS GREAT!--->>");
                            console.log("<<---SUBJECT IMPORT DATA",data)
                            for(var i in data){
                                console.log("data:",i,data[i]);
                            }
                            if(exp_id===""){
                                exp_id=data['exp_id'];
                                custom_exp_id=data['custom_exp_id'];
                                showExpWIP();
                            }
                        if(data['batches']!==""){ 
                                groups=data['batches']; 
                        
                                var batch_size_table=document.createElement('TABLE'); 
                                batch_size_table.setAttribute('id','pre_batch_size_summary')
                                batch_size_table.setAttribute('class','table table-striped table-bordered ') 
                                var b_thead=document.createElement('THEAD');
                                batch_size_table.appendChild(b_thead);
                                var b_tbdoy=document.createElement('TBODY');
                                batch_size_table.appendChild(b_tbdoy);
                                var trh=document.createElement('TR');
                                b_thead.appendChild(trh);
                                var th=document.createElement('TH');
                                trh.appendChild(th);
                                th.append('Batch');
                                var th=document.createElement('TH');
                                th.append('Batch Size');
                                trh.appendChild(th);
                                var total=0;

                                for (var rowindex in groups){
                                    var tr=document.createElement('TR');
                                    b_tbdoy.appendChild(tr);
                                    var td=document.createElement('TD');
                                    console.log('rowindex',rowindex);
                                    td.append(rowindex);
                                    tr.appendChild(td);
                                    var td=document.createElement('TD')
                                    console.log('groups[rowindex]',groups[rowindex])
                                    td.append(groups[rowindex]);
                                    tr.appendChild(td);
                                    var num=parseInt(groups[rowindex])
                                    total=total+num;
                                }
                                    var tr=document.createElement('TR');
                                    b_tbdoy.appendChild(tr);
                                    var td=document.createElement('TD');
                                    td.append('Total');

                                    tr.appendChild(td);
                                    var td=document.createElement('TD');
                                    td.append(total);
                                    tr.appendChild(td);
                                console.log(batch_size_table);
                                $(batch_size_table).appendTo('.batchsize_div') 
                                showBatchSummaryDiv();
                                // hiding uploaded data from user.
                                if(exp_id===""){
                                exp_id=data['exp_id'];
                                custom_exp_id=data['custom_exp_id'];
                                showExpWIP();
                            }
                            // console.log(JSON.parse(data[1]))
                            // dataframe_table=JSON.parse(data[1])
                            // var mydata = dataframe_table;
                            // var table = makeTable(mydata,"mytable");
                            // transposeTable(table)
                            
                            // $(table).appendTo("#subj_split_batch");
                            // $('#mytable').DataTable({
                            
                            //     "bLengthChange": false,
                            //     "bFilter": false,
                            //     "pageLength": 5
                            //     });
                            // // hiding the csv file data.
                            // $('#dataDiv').hide();
                            // $('#subj_split_batch_rowdiv').show(); 
                            

                        } 
                        
                            
                        }
                        
                        }); 
        }
}
function batchNumFunc(obj){
        console.log(obj.val())
        var bat_num=parseInt(obj.val());
        console.log(bat_num)
        console.log(typeof(bat_num))
        var labels=[]
        console.log(bat_num.len+1)
        console.log(bat_num.length+1)
        for (var i=1;i<bat_num+1;i++){
             i=i.toString()
             console.log(i)
             labels.push(i)
           
        }
        $('#selfbatchlabelid').val(labels);
}
// Switch Function to show and hide self and pre defined divs. 
function switchVisible(obj,header) {
    if (obj) {
        console.log("swvob",obj);
        console.log('header',header)
        console.log('id',obj.is("#self-defined") )
        if (obj.attr("id") === "self-defined" &&  obj.is(":hidden")) {
            console.log("in if");
            
            var batchtitlename=$('<label>Batch Name:</label>');
            var batchtitleinput = $('<input class="crtinput" type="text" name="batchtitle" value="Batch"  id="selfbatchtitleid">');
            var batchnumname=$('<label>Num of Batches:</label>');
            var batchnuminput = $('<input type="text" class="crtinput" name="batchnum" value="2"   id="selfbatchnumid" onkeyup="batchNumFunc($(this))" >');
            var batchlabelname=$('<label>Label Batches:</label>');
            var batchlabelinput = $('<input type="text" class="crtinput" name="batchlabel"  id="selfbatchlabelid" >');
            var selfassignbutton= $('<button id="selfassignbutton"onclick=selfAssignBatch()>Make Batch</button>') ;
            
            $('#batchtitle_name').append(batchtitlename);
            $('#batchtitle_input').append(batchtitleinput);
            $('#batchnum_name').append(batchnumname);
            $('#batchnum_input').append(batchnuminput);
            $('#batchlabel_name').append(batchlabelname);
            $('#batchlabel_input').append(batchlabelinput);
            $('[name=batchlabel]').val('1,2');
            $('#self-assignbuttondiv').append(selfassignbutton);

            

        
            $('#self-defined').toggle(1000);

           // document.getElementById('self-defined').style.display = 'block';
            $('#pre-defined').hide( 1000 );
            $('#pre-batchtitletext').empty();
            $('#pre-RadioDiv').empty();
            $('#pre-assignbuttondiv').empty();

            
            //document.getElementById('pre-defined').style.display = 'none';
        }
        else if (obj.attr("id") === "self-defined" &&  obj.is(":visible")){
            $('#self-defined').hide( 1000 );
            $('#batchtitle_name').empty();
            $('#batchtitle_input').empty();
            $('#batchnum_name').empty();
            $('#batchnum_input').empty();
            $('#batchlabel_name').empty();
            $('#batchlabel_input').empty();
            $('#self-assignbuttondiv').empty();
        }
        else if (obj.attr("id") === "pre-defined" &&  obj.is(":hidden")) {
            
        //    // $('[name=batchlabel]').remove();
        //    $('#self-defined').hide( 1000 );
        //     $('#batchtitle_name').empty();
        //     $('#batchtitle_input').empty();
        //     $('#batchnum_name').empty();
        //     $('#batchnum_input').empty();
        //     $('#batchlabel_name').empty();
        //     $('#batchlabel_input').empty();
        //     $('#self-assignbuttondiv').empty();


        //    // In future delete this block of code. @TODO
        // //    var batchtitle=$('<p>Select one of the Fields for Batch Assigning</p>');
        // //    $('pre-batchtitletext').append(batchtitle);
        // //    for (var i = 0; i < header.length; i++) {
        // //             var radioBtn = $('<input type="radio" name="'+header[i]+'" value="'+header[i]+'"\
        // //             onclick="radioBtnFunc($(this))"\
        // //             >'+header[i]+'</input>');
        // //             //radioBtn.appendTo('#RadioDiv');

        // //             $("#pre-RadioDiv").append(radioBtn);

        // //         }
        //     var sel1T=$('#s1').children('option:selected').text();
        //     var sel2T=$('#s2').children('option:selected').text();
        //     var sel3T=$('#s3').children('option:selected').text();
        //     $('#custom_label_id1').append('Customid');
        //     $('#custom_label_id1').append('-->');
        //     $('#custom_tag_id1').append(sel1T);
        //     $('#email_label_id1').append('Email');
        //     $('#email_label_id1').append('-->');
        //     $('#email_tag_id1').append(sel2T);
        //     $('#batchT_label_id1').append('Batch Title');
        //     $('#batchT_label_id1').append('-->');
        //     $('#batchT_tag_id1').append(sel3T);
            
        //     var assignbutton= $('<button onclick=preAssignBatch('+JSON.stringify(sel1T)+','+JSON.stringify(sel2T)+','+JSON.stringify(sel3T)+')>Make Batch</button>') ;
        //     assignbutton.fadeIn(300);
        //     $('#pre-assignbuttondiv' ).append(assignbutton) ;
        //     $('#pre-defined').show(1000);
        //    // document.getElementById('pre-defined').style.display = 'block';
             }   
    }
}
//  
function selfAssignBatch(){
    // $('.batchsize_div').empty();
    // if (globalbatchtable!=null){
    //     $('#subj_split_batch').empty();
    //     (globalbatchtable).destroy();
        
    // }
    emptyOneBatchTable();
    emptyPreBatchTable();
    emptySelfBatchTable();
    $('.batchsize_div').empty();
    $("#subj_split_batch_tabel").empty();
    if ($('#mytable').text().length == 0){
        console.log('inif;')
    }else{ $('#mytable').destroy();}
   

    var filedata=getFileDataList();
    // filedata.pop();
    // filedata.pop();
    // filedata.pop();
    var custom_id=$('#s1').children('option:selected').text();
    var email=$('#s2').children('option:selected').text() ;
    var batch_field=$('#s3').children('option:selected').text();
    console.log('filedata',filedata);
    var fieldname=$('#selfbatchtitleid').val();
    console.log('fieldname',fieldname);
    var fieldnum=$('#selfbatchnumid').val();
    console.log('fieldnum',fieldnum);
    var fieldlabel=$('#selfbatchlabelid').val();
    console.log('fieldlabel',fieldlabel);
    console.log(typeof(fieldlabel));
    var assigntype='self';
    filedata.push(custom_id);
    filedata.push(email);
    filedata.push(batch_field);

    
    
    filedata.push(fieldname);
    filedata.push(fieldnum);
    filedata.push(fieldlabel);


    filedata.push(assigntype);
    console.log('fileDATA',filedata);
    refreshFileDataList();
    $.ajax({
                    type: 'POST',
                    dataType: "json",
                    'data': {
                    'csvfiledata': JSON.stringify(filedata),
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    },
                    // the ajax call is sent to subdetails url name in the post function.  
                    url: "{% url 'uploadsamplefile' %}",
                    success: function(data){
                        if(exp_id===""){
                            exp_id=data['exp_id'];
                            custom_exp_id=data['custom_exp_id'];
                            showExpWIP();
                        }
                        console.log(JSON.parse(data[1]))
                        dataframe_table=JSON.parse(data[1])
                        var mydata = dataframe_table;
                        var table = makeTable(mydata,"mytable");
                        transposeTable(table)
                        
                        $(table).appendTo("#subj_split_batch_tabel");
                        $('#mytable').DataTable({
                           
                            "bLengthChange": false,
                            // "bFilter": false,
                            "pageLength": 5
                            });
                        // hiding the csv file data.
                        $('#dataDiv').hide();
                        $('#subj_split_batch_rowdiv').show();

                        groups=JSON.parse(data['batches']); 
                       
                        var batch_size_table=document.createElement('TABLE'); 
                        batch_size_table.setAttribute('id','self_batch_size_summary')
                        batch_size_table.setAttribute('class','table table-striped table-bordered ') 
                        var b_thead=document.createElement('THEAD');
                        batch_size_table.appendChild(b_thead);
                        var b_tbdoy=document.createElement('TBODY');
                        batch_size_table.appendChild(b_tbdoy);
                        var trh=document.createElement('TR');
                        b_thead.appendChild(trh);
                        var th=document.createElement('TH');
                        trh.appendChild(th);
                        th.append('Index');
                        var th=document.createElement('TH');
                        th.append('Batch Size');
                        trh.appendChild(th);
                        var total=0;
                        for (var rowindex in groups){
                            var tr=document.createElement('TR');
                            b_tbdoy.appendChild(tr);
                            var td=document.createElement('TD');
                            console.log('rowindex',rowindex);
                            td.append(rowindex);
                            tr.appendChild(td);
                            var td=document.createElement('TD')
                            console.log('groups[rowindex]',groups[rowindex])
                            td.append(groups[rowindex]);
                            tr.appendChild(td);
                            var num=parseInt(groups[rowindex])
                            total=total+num;
                        }
                            var tr=document.createElement('TR');
                            b_tbdoy.appendChild(tr);
                            var td=document.createElement('TD');
                            td.append('Total');

                            tr.appendChild(td);
                            var td=document.createElement('TD');
                            td.append(total);
                            tr.appendChild(td);
                        console.log(batch_size_table);
                       $(batch_size_table).appendTo('.batchsize_div')    
                       }
                    }); 
    


}
//  
function radioBtnFunc(radiovalue){
        console.log('radiovalue',radiovalue.attr('value')) ;
        var radioinput_value=radiovalue.attr('value'); 
        var assignbutton= $('<button onclick=preAssignBatch('+JSON.stringify(radioinput_value)+')>Make Batch And assign to blocks</button>') ;
                         assignbutton.fadeIn(300);
                         $('#pre-assignbuttondiv' ).append(assignbutton) ;
    
}

function preAssignBatch(sel1T,sel2T,sel3T){
    var filedata=getFileDataList();
    console.log(filedata);
    // var fieldname=radioinput_value;
    // console.log("fieldname",fieldname);
    
    console.log(filedata);
    filedata.push(sel1T);
    filedata.push(sel2T);
    filedata.push(sel3T);
    filedata.push('pre');
    console.log(filedata);
    refreshFileDataList();
    $.ajax({
                    type: 'POST',
                    dataType: "json",
                    'data': {
                    'csvfiledata': JSON.stringify(filedata),
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    },
                    // the ajax call is sent to subdetails url name in the post function.  
                    url: "{% url 'uploadsamplefile' %}",
                    success: function(data){
                      
                       //create table
                        
                        //  for (var i in data){// 
                        //     // row 
                             
                        //      console.log(i); // key RollNO  Individual cells. 
                        //      // add all to the row.    
                        //      console.log(Object.values(data[i]).length);  // Value {0: 1239123}
                        //      for (var j in data[i] ){  
                        //          console.log(data[i][j]);
                        //      }
                        //  }
                        
                        var mydata = eval(data);
                        var table = makeTable(mydata);
                        transposeTable(table)
                        $(table).appendTo("#subj_split_batch_tabel");
                      
                
                       }
                     
                    }); 
    
}

function makeTable (mydata,tableid) {
    
    var table = $('<table  id='+tableid+' class="table table-bordred table-striped">');
    var colgroup= $('<colgroup>')
    var colg1=$('<col>')
    var colg2=$('<col>')
    var colg3=$('<col>')

    var colg4=$('<col style="background-color:yellow">')
    $(colg1).appendTo(colgroup);
    $(colg2).appendTo(colgroup);
    $(colg3).appendTo(colgroup);
    $(colg4).appendTo(colgroup);
    $(colgroup).appendTo(table);
    var thead = $('<thead>');

    var tblHeader = "<tr>";
        
    for (var k in mydata) tblHeader += "<th>" + k + "</th>";

    tblHeader += "</tr>";
    $(tblHeader).appendTo(thead);
    $(thead).appendTo(table)
    
    var tbody = $('<tbody>');
   

    $.each(mydata, function (index, value) {
        var TableRow = "<tr>";
                
        $.each(value, function (key, val) {
            TableRow += "<td>" + val + "</td>";
    
        });
        TableRow += "</tr>";
        $(TableRow).appendTo(tbody);
        // $(table).append(TableRow);
        

    });

    $(tbody).appendTo(table);
    return ($(table));
};

function transposeTable(table) {
        var $this = table.children('tbody');
        var newrows = [];
        $this.find("tr").each(function(){
            var i = 0;
            $(this).find("td").each(function(){
                i++;
                if(newrows[i] === undefined) { newrows[i] = $("<tr></tr>"); }
                newrows[i].append($(this));
            });
        });
        $this.find("tr").remove();
        $.each(newrows, function(){
            $this.append(this);
        });
  
}

function setFileDataList(filedatalist){
    globalfiledatalist=filedatalist
}
function emptyFileDataList(){
  globalfiledatalist=[];
}
function getFileDataList(){
    return globalfiledatalist;
   
}

function refreshFileDataList (){
var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/;
var regex_xl = /^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;
var fileUpload = $("#excelFile")[0];
console.log("csv regex",regex.test($("#fileUpload").val().toLowerCase()))
console.log("xl regex",regex_xl.test(fileUpload.value.toLowerCase()))

// if (regex.test(fileUpload.value.toLowerCase())) {
if (regex.test($("#fileUpload").val().toLowerCase())) {
    
    if (typeof (FileReader) != "undefined") {
            var reader = new FileReader();
            reader.onload = function (e) {
          
            var rows = e.target.result.split("\n");
            var filedatalist=[];

                for (var i = 0; i < rows.length; i++) {
                    console.log(rows[i]);
                    filedatalist.push(rows[i]);
                }  
            setFileDataList(filedatalist); 
            window.row_filedata=rows;
            console.log('rows[0]',row_filedata[0])
        }

        reader.readAsText($("#fileUpload")[0].files[0]);
       
    }
     else {
        alert("This browser does not support HTML5.");
    }
} 
else if (regex_xl.test(fileUpload.value.toLowerCase())){
    if (typeof (FileReader) != "undefined") {
         var reader = new FileReader();
        reader.onload = function (e) {
                  //Read the Excel File data.
        var workbook = XLSX.read(e, {
            type: 'binary'
        });
 
        //Fetch the name of First Sheet.
        var firstSheet = workbook.SheetNames[0];
 
        //Read all rows from First Sheet into an JSON array.
        //  var excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);
        var excelRows = XLSX.utils.sheet_to_csv(workbook.Sheets[firstSheet]);
        excelRows=excelRows.split("\n");
        var filedatalist=[]

        for (var row in excelRows){
                        if (excelRows[row]==''){
                            console.log("excelRows[row]",excelRows[row])
                            excelRows.splice(row, 1)
                        }else{
                        filedatalist.push(excelRows[row]);
                        }
                    }
      
        window.row_filedata=excelRows;            
       setFileDataList(filedatalist);
                 
            };
             reader.readAsBinaryString(fileUpload.files[0]);
         
     } else {
         alert("This browser does not support HTML5.");
     }
}
else {
    alert("Please upload a valid file.");
}

}
function hide_emptyAllDivs_ImportSubjects(){
    $('.map_select_label').hide();
    $('.show_select_tag').empty();
    $('#proceedbtndiv').empty();
    $('#self_permission_text_div').empty();
    $('#self_button_yes_div').empty();
    $('#self_button_no_div').empty();
    $('#selfbuttondiv').empty();
    $('#self-defined ').hide();
    $('#self-assignbuttondiv').empty();
    $('.self-defined-inputs').empty();
    hideBatchSummaryDiv();
    emptySelfBatchTable();
    emptyPreBatchTable();
    emptyOneBatchTable();
    // $('.batchsize_div').empty();
    $('#dataDiv').hide();
    // $('#dataDiv-label').hide();
    $('#subj_split_batch_rowdiv_batch_label').hide();
    $('#subj_split_batch_tabel').empty();
    $('#showfiledatadiv').empty();
}
function chooseFileFunc(){
  
  
  if ($('#fileUpload').val()===''){
      alert('val empty')
     $('#upload').prop('disabled',false);
  }
  else{
    $('#upload').prop('disabled',false);
    alert('val not empty')
    // Empty all possible divs that are displayed. 
    hide_emptyAllDivs_ImportSubjects();
    // send an ajax call that will delete the exsisting subjects from the database of that experiment. 
    // check
    $.ajax({
            type: 'POST',
            dataType: "json",
            'data': {
            'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            // the ajax call is sent to deleteallsubjects url name in the post function.  
            url: "{% url 'deleteallsubjects' %}",
            success: function(data){
            console.log("success");
            }
        }); 
    }
}
// Outercheckbox function 
// This function gets 2 arguments when called val and id attribute of input type=checkbox
// having id based on the feature.id.
// It is called through onclick function. 
var  setlist=[];
function outerCheckBox(outercheckval,outercheckid) {
console.log("checkbox");
console.log(outercheckval);
    // Ajax call is made to send the outercheckboxid to the controller. 
    // The controller will fetch the sub-details of that feature from model and return back in
    // in success function. 
    // Success funtion will first check if the outercheckbox is checked or unchecked. 
    // If unchecked it'll simply hide the innercheckboxdiv or do nothing as by default its hidden.
    // else will populate data in that div and show to user.  
    $.ajax({
    type: 'POST',
    dataType: "json",
    'data': {
    'd': JSON.stringify(outercheckval),
    'csrfmiddlewaretoken': '{{ csrf_token }}',
    },
    // the ajax call is sent to subdetails url name in the post function.  
    url: "{% url 'subdetails' %}",
    success: function(data){
    console.log("success");
    var outerckbox = $('#'+outercheckid);
    console.log('outercheckbox obj',outerckbox);
    console.log('block_feat_dict',block_feat_dict);
   

    // checking if the user has checked or not. 

if (outerckbox.is(':checked')) {
        // alert('You Checked');
        console.log('outercheckval',outercheckval);
        console.log('data retrieved',data);
    if (outercheckval==="P"){ 
                delete block_feat_dict["P"];
                $('#phsetnum_div').empty();
                $('#phsetnum_div').dialog({ 
                title: "Phone Set",
                autoOpen: false,
                minHeight: 200,
                maxHeight: 300,
                
                draggable: true,
                resizable: true,
                closeOnEscape: true,
                close       : function () {
                    $("#6").prop('checked', false);
                },

                hide: { effect: "highlight", duration: 0},
                buttons: [
                            {
                                text:"cancel",
                                click: function() {
                                    $( this ).dialog( "close" );
                                    $("#6").prop('checked', false);
                                 
                                }

                            },
                            
                            {
                            text: "Save",
                            click: function() {
                                $("#set_buttons").empty();
                                $('#expphonelist_div').empty();
                                active_button=""
                                // $("#phones_main_button_div").empty();
                                $('#mobile_catalog_div').empty();
                                phoneset_dic={}
                                phonename={}
                                $( this ).dialog( "close" );
                            // Enabling mobile Catalog button if p is not ticked!.
                                enableMobileCatalogButton();
                                // $("#create_exp_mobile_catalog").css('background-color','');
                                // $("#create_exp_mobile_catalog").css('color','');
                                // $("#create_exp_mobile_catalog").css('cursor','pointer');
                                // $("#create_exp_mobile_catalog").attr("disabled", false); 

                                $("#6").prop('checked', true);
                                console.log("vale",$('#inputset_num').val())
                                numofsets=$('#inputset_num').val();
                                setlist=[]
                               
                               
                                for (var i=0;i<numofsets;i++){
                                    var j=i+1
                                    var str="P."+j;
                                    setlist.push(str);
                                }
                                console.log("SetList",setlist);
                                if (block_feat_dict[outercheckval]===undefined){
                                    block_feat_dict[outercheckval]=setlist;
                                }
                                $('#'+outercheckid+'-innercheckboxdiv').empty();
                                var row_div=document.createElement("div");
                                row_div.setAttribute("class",'row');
                                var col_md_6_div=document.createElement("div");
                                col_md_6_div.setAttribute("class","col-md-12 col-sm-12");
                                row_div.append(col_md_6_div);
                                col_md_6_div.append(block_feat_dict[outercheckval])
                                var col_md_6_div_2=document.createElement("div");
                                col_md_6_div_2.setAttribute("class","col-md-12 col-sm-12");
                                row_div.append(col_md_6_div_2);
                                var edit_href=document.createElement("a");
                                edit_href.setAttribute("onclick","mobileCatalog()");
                                edit_href.setAttribute("class","edit_href")
                                edit_href.innerHTML="Edit";
                                col_md_6_div_2.append(edit_href);
                               
                                $('#'+outercheckid+'-innercheckboxdiv').append(row_div);
                                $('#'+outercheckid+'-innercheckboxdiv').show();
                                
                                


                                window.localStorage.setItem("feat_dict", JSON.stringify(block_feat_dict));
                                checkbox_id_dict[outercheckid]=[];
                                window.localStorage.setItem("checkbox_id_dict", JSON.stringify(checkbox_id_dict));
   

                                updateFeatureLvls();


                                mobileCatalog();

                                var current=$(".active");
                                current.prop('class',current.attr('class').replace('active',""));
                                $('#create_exp_mobile_catalog').prop('class', 'custom_nav_btn active');

                            }

                            }
                          
                ]
                }); // Initialize dialog plugin
                $('#phsetnum_div').dialog("open");
                var row_div = document.createElement('div');
                row_div.setAttribute('class','row');
                $('#phsetnum_div').append(row_div);

                var row_d1=document.createElement('div');
                row_d1.setAttribute('class','row');
                row_div.append(row_d1);
                var col_md_12_div=document.createElement('DIV');
                col_md_12_div.setAttribute('class','col-md-12 col-sm-12');
                row_d1.append(col_md_12_div)
                var p_text=document.createElement('p');
                p_text.innerHTML="Number of sets"
                col_md_12_div.append(p_text)
                var row_d2=document.createElement('div');
                row_d2.setAttribute('class','row');
                row_div.append(row_d2);
                var col_md_12_div2=document.createElement('DIV');
                col_md_12_div2.setAttribute('class','col-md-12 col-sm-12');
                row_d2.append(col_md_12_div2)
                var input = document.createElement("INPUT");
                input.setAttribute("type", "number");
                input.id='inputset_num';
                input.min="2";
                input.value="2";
                col_md_12_div2.append(input);
    }

            
    else if(outercheckval==="CO"){
        block_feat_dict[outercheckval]=[];

        var numofsets=0;
        $('order_criteria_div').empty();
        $('#ordersetnum_div').empty();
        $('#ordersetnum_div').dialog({ 
        title: "Order Criteria",
        autoOpen: false,
        minHeight: 300,
        maxHeight: 400,
        minWidth:400,
        closeOnEscape: true,
        
        hide: { effect: "highlight", duration: 1000 },
        buttons: [
        {
            text:"cancel",
            click: function() {
                $( this ).dialog( "close" );
                $("#7").prop('checked', false);
                delete block_feat_dict['CO'];
            }

        },
        {
        text: "Save",
        click: function() {
            $( this ).dialog( "close" );
            console.log("vale",$('#inputset_num_co').val())
            numofsets=$('#inputset_num_co').val();
            // HideALL();
            var setlst=[];
            for (var i=0;i<numofsets;i++){
                var j=i+1
                var str="CO."+j;
                setlst.push(str);
            }
            console.log("SetList",setlst);
            block_feat_dict[outercheckval]=setlst;
            // orderCriteriaHtmlSetup(outercheckval,setlst);
            

            if (block_feat_dict[outercheckval]===undefined){
                block_feat_dict[outercheckval]=[];
            }
            $('#'+outercheckid+'-innercheckboxdiv').empty();
           
            var row_div=document.createElement("div");
            row_div.setAttribute("class",'row');
            var innercheckboxdiv=document.getElementById('7-innercheckboxdiv')
            innercheckboxdiv.append(row_div);
            

            var col_md_6_div=document.createElement("div");
            col_md_6_div.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div);
            col_md_6_div.append(block_feat_dict[outercheckval])

            var col_md_6_div_2=document.createElement("div");
            col_md_6_div_2.setAttribute("class","col-md-12");
            row_div.append(col_md_6_div_2);

            var view_href=document.createElement("a");
            view_href.setAttribute("onclick","criteriaDispPopup()");
            view_href.setAttribute("class","view_href")

            view_href.innerHTML="View";
            col_md_6_div_2.append(view_href);
            
            $('#'+outercheckid+'-innercheckboxdiv').show();

            $("#7").prop('checked', true);

            window.localStorage.setItem("feat_dict", JSON.stringify(block_feat_dict));
            checkbox_id_dict[7]=[];
            window.localStorage.setItem("checkbox_id_dict", JSON.stringify(checkbox_id_dict));
            
            updateFeatureLvls();
         
            
        }
    
        // Uncommenting the following line would hide the text,
        // resulting in the label being used as a tooltip
        //showText: false
        }
    ]
        }); // Initialize dialog plugin
        $('#ordersetnum_div').dialog("open");
        var row_div = document.createElement('div');
        row_div.setAttribute('class','row-content');
        $('#ordersetnum_div').append(row_div);
        var row_d2=document.createElement('div');
        row_d2.setAttribute('class','row');
        row_div.append(row_d2);
        var col_md=document.createElement('DIV');
        col_md.setAttribute('class','col-md-12');
        row_d2.append(col_md)

        var p_text=document.createElement('p');
        p_text.innerHTML="Default CDM will be activated if you save!!"
        col_md.append(p_text)


        
        var row_d1=document.createElement('div');
        row_d1.setAttribute('class','row');
        row_div.append(row_d1);
        var col_md_12_div=document.createElement('DIV');
        col_md_12_div.setAttribute('class','col-md-12');
        row_d1.append(col_md_12_div)
        var p_text=document.createElement('p');
        p_text.innerHTML="Number of sets"
        col_md_12_div.append(p_text)
        var row_d2=document.createElement('div');
        row_d2.setAttribute('class','row');
        row_div.append(row_d2);
        var col_md_12_div2=document.createElement('DIV');
        col_md_12_div2.setAttribute('class','col-md-12');
        row_d2.append(col_md_12_div2)
        var input = document.createElement("INPUT");
        input.setAttribute("type", "number");
        input.id='inputset_num_co';
        input.min="2";
        input.value="2";
        col_md_12_div2.append(input);
        // send an ajax call to admin_setup sending set num, exp id. 
    

      
    }
    else {
        delete block_feat_dict[outercheckval]
        block_feat_dict[outercheckval]=data
           
            if (data==null){
                block_feat_dict[outercheckval]=[0,1]
            }
            console.log('dictionary',block_feat_dict)
            // calling innercheckboxdivs. 
            // these divs basically come after outercheckbox that contain innerchecks.
            // outercheck id and the data is sent to this function.
            // This function shows the innerChecksdivs after including and populating data in 
            // innerchecks.
            // todo: change the name of innercheckboxdivs name as it seems like it is refering to
            // div inside inner checks...
            
            // checkbox_id_dict[outercheckid]=[];
            showInnerCheckBoxDivs(outercheckid,data);
            updateFeatureLvls();
        } 
    
}
    
    else {
        // alert('You Un-Checked it');
        //  three checks will be made here for p, co and c. 
        // the check will see if the user had created a new exp object and one of the three is being ticked and now unticked. 
        // if unticked then to hall data stored in dict, phoneset_dic, phonename_dic, featureLevel blocks will be deleted as well by calling sendFeatureLevl()
        // For now its purpose is simply ide the innercheckdivs.  
        if (outercheckval==="P"){
            // if(exp_id!==""){
            //         // removing every thing related to phoneset
            //         phoneset_dic={};
            //         phonename_dic={};
            //         brand_set_dict={};
            //         slider_set_dict={};
            //         $("#set_buttons").empty();
            //         $('#expphonelist_div').empty();
            //         active_button=""
            //         // $("#phones_main_button_div").empty();
            //         $('#mobile_catalog_div').empty();
            //         // disabling mobile Catalog button if p is not ticked!.
            //         // disableMobileCatalogButton();
            //         // $("#create_exp_mobile_catalog").css('background-color','black');
            //         // $("#create_exp_mobile_catalog").css('color','black');
            //         // $("#create_exp_mobile_catalog").css('cursor','not-allowed');

            //         // $("#create_exp_mobile_catalog").attr("disabled", true); 
            //     }
                phoneset_dic={};
                phonename_dic={};
                brand_set_dict={};
                slider_set_dict={};
                $("#set_buttons").empty();
                $('#expphonelist_div').empty();
                active_button=""
                
                // $("#phones_main_button_div").empty();
                $('#mobile_catalog_div').empty();
        }
        hideInnerCheckBoxDivs(outercheckid);
        console.log("outercheckval",outercheckval);
        console.log("block_feat_dict",block_feat_dict)
        block_feat_dict[outercheckval]=null;
        if (block_feat_dict[outercheckval]===null || block_feat_dict[outercheckval].length===0){
            delete block_feat_dict[outercheckval];
            
        }
        if (outercheckval==="CO"){
            cdm_crit_order_on_flag="false";

        }
        else if (outercheckval==="C"){
            console.log("default_crit_show_dict['cdm']",default_crit_show_dict['cdm'])
            console.log("default_crit_hide_dict['cdm']",default_crit_hide_dict['cdm'])

            delete default_crit_show_dict['cdm'];
            delete default_crit_hide_dict['cdm'];
            console.log("default_crit_show_dict['cdm']",default_crit_show_dict['cdm'])
            console.log("default_crit_hide_dict['cdm']",default_crit_hide_dict['cdm'])

        }
        console.log("phoneset_dic--",phoneset_dic)
        // empty phoneset_dic 
        phoneset_dic={}
        console.log("phoneset_dic",phoneset_dic)

        console.log("dict",block_feat_dict)


        var get_dict=JSON.parse(window.localStorage.getItem("feat_dict")); 
        get_dict=block_feat_dict;
        var set_dict=get_dict;
        window.localStorage.setItem("feat_dict", JSON.stringify(set_dict));
        removeFeatureLevel();
        updateFeatureLvls();
    }
  }});  
 }
function criteriaDispPopup(){
        $('#criteria_display_popup').empty();
        $('#criteria_display_popup').dialog({ 
        title: "Criteria Display",
        autoOpen: false,
        minHeight: 200,
        maxHeight: 300,
        closeOnEscape: true,
        hide: { effect: "highlight", duration: 1000 },
    });
    $('#criteria_display_popup').dialog("open");
    var row_content_div = document.createElement('div');
    row_content_div.setAttribute('class','row-content');
    $('#criteria_display_popup').append(row_content_div);
    console.log("crit_order_dict_test",crit_order_dict);
    if (!Object.keys(crit_order_dict).length){
        alert("Data for criteria order not loaded")
    }
    for (var i in crit_order_dict){
        var row_d1=document.createElement('div');
        row_d1.setAttribute('class','row');
        row_content_div.append(row_d1);
        var col_md_12_div=document.createElement('DIV');
        col_md_12_div.setAttribute('class','col-md-12');
        row_d1.append(col_md_12_div)
        col_md_12_div.append(i);
        var row_d2=document.createElement('DIV');
        row_d2.setAttribute('class','row');
        row_content_div.append(row_d2);
        var col_md_12_div_2=document.createElement('DIV');
        col_md_12_div_2.setAttribute('class','col-md-12');
        row_d2.append(col_md_12_div_2)
        col_md_12_div_2.append(crit_order_dict[i])


    }
       

       
}

// once the onclick function=>(innercheckbox) of inner checks are called it 
// shows three things. innercheck value , id and outer check value/title.
function innerCheckBox(innercheckval,innercheckid,outercheckdivtitle,outercheckdivid){
//console.log(innercheckval,innercheckid,outercheckdivtitle);

console.log('outercheckbox title',outercheckdivtitle)
var innercheckboxid = $('#'+innercheckid);
console.log('outercheckbox title',$('#1-innercheckbox-1').parent().attr("value"))

//var parentdiv=innercheckboxid.parent();
//var parentdivid=parentdiv.attr('id');
var temparr=outercheckdivid.split('-');
console.log('outercheck id ',temparr[0])
var innercheckboxid_elem = document.getElementById(innercheckboxid);

//console.log("outerchekboxid-",outercheckid );
console.log("innercheckbox-",innercheckboxid );
// checking if the user has checked or not. 

// if ($(innercheckboxid).is(':checked')) {
    console.log('#'+temparr[0])
    // $('#'+temparr[0]).prop('checked',true);
    
if ($(innercheckboxid).prop('checked') == true){
    //Process for adding the innercheck value in block_feat_dict. 
            if (block_feat_dict[outercheckdivtitle] == null) {
                block_feat_dict[outercheckdivtitle]=[]
                }   
            arr_feature_levels=block_feat_dict[outercheckdivtitle];
            console.log('Specific dict in Checked',block_feat_dict[outercheckdivtitle]);
            console.log('insert',arr_feature_levels);
            arr_feature_levels.push(innercheckval);
            block_feat_dict[outercheckdivtitle]=arr_feature_levels;
            console.log('arr',arr_feature_levels);
            console.log('All dict in checked condition.',block_feat_dict);
            // updating feat_dict in session. 
            var get_dict=JSON.parse(window.localStorage.getItem("feat_dict")); 
            get_dict=block_feat_dict;
            var set_dict=get_dict;
            window.localStorage.setItem("feat_dict", JSON.stringify(set_dict));

            
            updateFeatureLvls();
    //Process for adding innercheck id in checkbox_id_dict
            // 1.GET THE OUTER CHECK BOX ID BY GETTING LAST INDEX OF INNER CHECK ID. 
            var outercheckid=innercheckid.slice(-1);
            // get all innercheck present in check_id_dict
            var innercheck_all_id=checkbox_id_dict[outercheckid];
            // push newly selected one into innercheck_All_id
            innercheck_all_id.push(innercheckid);
            //
            checkbox_id_dict[outercheckid]=innercheck_all_id;
            console.log('newly added id in check dic',checkbox_id_dict)
            // Update check_id_dict in session. 
            var get_chkbx_id_dict=JSON.parse(window.localStorage.getItem("checkbox_id_dict")); 
            var get_chkbx_id_dict=checkbox_id_dict;
            var set_chkbx_id_dict=get_chkbx_id_dict;
            console.log("set_chkbx_id_dict",set_chkbx_id_dict);
            window.localStorage.setItem("checkbox_id_dict", JSON.stringify(set_chkbx_id_dict));


        

        
    
} 
else if ($(innercheckboxid).prop('checked') == false) {
   // PROCESS TO DELETE THE UNCHECKED  FEATURE LEVEL FROM DICT 
                    // Getting all the feature levels of the feature in a list. 
                    arr_feature_levels=block_feat_dict[outercheckdivtitle];
                    console.log('Specific dict in UnChecked',block_feat_dict[outercheckdivtitle]);
                    console.log('arr',arr_feature_levels);
                    console.log(innercheckval);
                    var index = $.inArray(innercheckval, arr_feature_levels);
                        if (index != -1) {
                            var removedvalue=arr_feature_levels.splice(index, 1);
                            console.log('removedvalue',removedvalue);
                        }
                    console.log('del arr',arr_feature_levels);  
                    console.log('del arr',arr_feature_levels.length);
                    // A Check to see if all inner checks are unchecked then remove the key aswell
                    if (arr_feature_levels.length===0){
                        delete  block_feat_dict[outercheckdivtitle];
                        console.log('condition check');
                        console.log('deleted dic',block_feat_dict);
                    }
                    else{ 
                        block_feat_dict[outercheckdivtitle]=arr_feature_levels;
                        console.log('block_feat_dict',block_feat_dict);
                    }
                    // UPdate Feat_dict in session. 
                    var get_dict=JSON.parse(window.localStorage.getItem("feat_dict")); 
                    get_dict=block_feat_dict;
                    var set_dict=get_dict;
                    window.localStorage.setItem("feat_dict", JSON.stringify(set_dict));

 // PROCESS TO DELETE THE UNCHECKED FEATURE LEVEL ID FROM CHECKBOX_ID_DICT 
                // 1.GET THE OUTER CHECK BOX ID BY GETTING LAST INDEX OF INNER CHECK ID. 
                var outercheckid=innercheckid.slice(-1);
                // get all the innercheck id from checkbox_id_dict of key outercheckid..
                var innercheck_all_id=checkbox_id_dict[outercheckid]
                // get the index of the innercheckid in innercheck_All_id list
                // Then remove it. 
                var innercheck_id_index = $.inArray(innercheckid, innercheck_all_id);
                                    if (innercheck_id_index != -1) {
                                        var removedid=innercheck_all_id.splice(index, 1);
                                        console.log('removedid',removedid);
                                    }
                                    console.log('innercheck_all_id list',innercheck_all_id);  
                                // A Check to see if all inner checks are unchecked then remove the key aswell
                                if (innercheck_all_id.length===0){
                                        delete  checkbox_id_dict[outercheckid];
                                        console.log('condition check');
                                        console.log('checkbox_id_dic after deletion',checkbox_id_dict);
                                        var x = document.getElementById(outercheckid);
                                        x.checked = false;
                                        $('#'+outercheckid+'-innercheckboxdiv').hide();
                                        $('#'+outercheckid+'-innercheckboxdiv').empty();
                                    }
                                else{ 
                                    checkbox_id_dict[outercheckid]=innercheck_all_id;
                                    console.log('checkbox_id_dict',checkbox_id_dict);
                                }
                                // Update check_id_dict in session. 
                                var get_chkbx_id_dict=JSON.parse(window.localStorage.getItem("checkbox_id_dict")); 
                                var get_chkbx_id_dict=checkbox_id_dict;
                                var set_chkbx_id_dict=get_chkbx_id_dict;
                                window.localStorage.setItem("checkbox_id_dict", JSON.stringify(set_chkbx_id_dict));




    }
    updateFeatureLvls();
}

function showInnerCheckBoxDivs(outercheckid,data){
console.log('#'+outercheckid+'-innercheckboxdiv')
// Creating inner checks and populating them with data. 

 var innercheckbox_id_list=[];
for (var o in data){
        console.log('A',o);    
        var innercheck_element =  $(document.createElement("input")).attr({
                id: o +'-innercheckbox-'+outercheckid,
                name:  '',
                value: data[o],
                text :'',
                type:  'checkbox',
                checked:true,
                onclick:"innerCheckBox($(this).attr('value'),$(this).attr('id'),\
                $(this).parent().attr('value'), $(this).parent().attr('id')\
                )"
            
        })
        var inner_id=innercheck_element.attr('id')
        var stored_innercheckbox_id_list=checkbox_id_dict[outercheckid]
        if ((stored_innercheckbox_id_list===undefined )|| (stored_innercheckbox_id_list==[])){
           innercheckbox_id_list.push(inner_id);
        }
        else{
            // IT WILL BE ALWAYS FALSE if check_id_dict[key] is empty> IT SHOULD BE FALSE>
            for (var value_id in stored_innercheckbox_id_list){
                    console.log(stored_innercheckbox_id_list[value_id]);
                    console.log (inner_id)

                            if (stored_innercheckbox_id_list[value_id]===inner_id)
                            {    console.log('in if cond')
                                innercheckbox_id_list.push(inner_id)
                            }
                            else{
                                console.log('in else cond')
                                innercheck_element.prop('checked',false)
                            }
                }
        }
        // adding input attributes to a div
        $('#'+outercheckid+'-innercheckboxdiv').append(innercheck_element);
        $('#'+outercheckid+'-innercheckboxdiv').append(data[o]);
        $('#'+outercheckid+'-innercheckboxdiv').show();
    }
     checkbox_id_dict[outercheckid]=innercheckbox_id_list;
    // alert(checkbox_id_dict[outercheckid]);
     console.log('DICTionary',block_feat_dict);
     window.localStorage.setItem("feat_dict", JSON.stringify(block_feat_dict));
     window.localStorage.setItem("checkbox_id_dict", JSON.stringify(checkbox_id_dict));
   
     console.log('All innercheck boxid added to checkbox dict',checkbox_id_dict);
}
var cdm_full_btn_on="false"; var default_active="false";
var CO_CDM_COMB="";
var status_report_dictionary={}
var block_feat_dict_def={}
var final_def_blocks_to_send={}
function dummysendFeatureLevels(){
    var temp_block_feat_dict_def={};
    // all outerchecks are unchecked?
    all_unchecked=false;
    var feat_key="";
    var total_feat_len=$("#feat_lvl_div :input").not(':button').length;
    var count=0;
    $("#feat_lvl_div :input").not(':button').each(function() {
        console.log($(this).prop("checked"));
        if($(this).prop("checked")==false){
            if ($(this).val()==="I"){
                    feat_key=$(this).val();
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                        temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];
                        // block_feat_dict_def[feat_key]=["I.0","I.1"];
                        // block_feat_dict[feat_key]=["I.0","I.1"];
                    }
                    console.log("I",block_feat_dict_def);
                }
            else if ($(this).val()==="R"){
                    feat_key=$(this).val()
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                        temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];

                    // block_feat_dict_def[feat_key]=["R.0","R.1"];
                    // block_feat_dict[feat_key]=["R.0","R.1"];
                    }
                    console.log("R",block_feat_dict_def)
                }
            else if ($(this).val()==="W"){
                    feat_key=$(this).val()
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                        temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];

                    // block_feat_dict_def[feat_key]=["W.direct"]
                    // block_feat_dict[feat_key]=["W.direct"]
                    }
                    console.log("W",block_feat_dict_def)

                }
            else if ($(this).val()==="A"){
                    feat_key=$(this).val()
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                        temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];

                        // block_feat_dict_def[feat_key]=["A.1by1","A.2by2"];
                        // block_feat_dict[feat_key]=["A.1by1","A.2by2"]

                    }
                    console.log("A",block_feat_dict_def)

                }
            else if ($(this).val()==="C"){
                    feat_key=$(this).val();
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                         temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];

                        // block_feat_dict_def[feat_key]=["C.def"];
                        // block_feat_dict[feat_key]=["C.def"]

                    }
                    console.log("C",block_feat_dict_def)
                    
                }
            else if ($(this).val()==="P"){
                    feat_key=$(this).val();
                    if (temp_block_feat_dict_def[feat_key]===undefined){
                        temp_block_feat_dict_def[feat_key]=block_feat_dict_def[feat_key];

                        // block_feat_dict_def[feat_key]=["P.All"];
                        // block_feat_dict[feat_key]=["P.All"]

                    }
                    console.log("P",block_feat_dict_def)
                    SavePhoneSet_P0();

                }
            all_unchecked=true
            count+=1
        }
        else{
            delete temp_block_feat_dict_def[$(this).val()];
            all_unchecked=false
        }
    });
    if(count!==total_feat_len){all_unchecked=true}

    // if (all_unchecked===true){
    //     block_feat_dict_def["I"]=["I.0","I.1"]
    //     block_feat_dict_def["R"]=["R.0","R.1"];
    //     block_feat_dict_def["W"]=["W.direct","W.AHP"];
    //     block_feat_dict_def["A"]=["A.1by1"];
    //     block_feat_dict_def["C"]=["C.Def"];
    //     block_feat_dict_def["P"]=["P.All"];
    //     block_feat_dict=block_feat_dict_def
    //     console.log("In Here");
    // }
       
    $("#defaultfeatLevel_tablediv").empty()
    var featlevels="default"
    $("#defaultfeatLevel_tablediv").append("<hr>");
    $("#defaultfeatLevel_tablediv").append("<h4>Status Report Default</h4>")
    for ( var indx in temp_block_feat_dict_def){
        featlevels=temp_block_feat_dict_def[indx]
        row_div=$("<div class='row'></div>");
        $(row_div).append(featlevels);
        $("#defaultfeatLevel_tablediv").append(row_div);
    }
        // default cdm full and co. and Select P.O 
        cdm_crit_show_dict['c.full']; 
        console.log("all_unchecked",all_unchecked)
        console.log("temp_block_feat_dict_def",temp_block_feat_dict_def)
        final_def_blocks_to_send=temp_block_feat_dict_def;
        console.log("block_feat_dict_def",block_feat_dict_def);
        console.log("block_feat_dict",block_feat_dict);

        // if all unchecked then populate the Status Report Default with all defualts features. 

        // get default cdm, CO 
        // Get 
        // saveDefaultCriteriaSet
        // 'default_crit_show_dict': JSON.stringify(default_crit_show_dict,undefined,''),
        //  'default_crit_hide_dict': JSON.stringify(default_crit_hide_dict,undefined,''),
        // saveCdmCriteriaHTMLSetup
        // 'cdm_crit_show_dict': JSON.stringify(cdm_crit_show_dict,undefined,''),
        // 'cdm_crit_hide_dict': JSON.stringify(cdm_crit_hide_dict,undefined,''),
        // saveOrderSet
        // 'crit_order_dict':JSON.stringify(crit_order_dict),
        // 'crit_hide_dict':JSON.stringify(crit_hide_dict),
        // SavePhoneSet
        // 'phoneset_dic':JSON.stringify(phoneset_dic),

    sendFeatureLevels();
}



function sendFeatureLevels(){ 
    dict_not_empty_flag="false";
    $("#default_tree_view_div").empty();
    $("#default_tree_view_div").hide();

    $("#cdm_on_co_off_tree_view_div").empty();
    $("#cdm_on_co_off_tree_view_div").hide();

    
    $("#cdm_off_co_on_tree_view_div").empty();
    $("#cdm_off_co_on_tree_view_div").hide();


    $("#cdm_on_co_on_tree_view_div").empty();
    $("#cdm_on_co_on_tree_view_div").hide();

    $("#ol1").empty();
    $("#ol2").empty();
    $("#ol3").empty();
    $("#ol4").empty();
  
if (block_feat_dict['C']===undefined && block_feat_dict['CO']===undefined){
    CO_CDM_COMB="CDM_off_CO_off";
    if (current_save_state===CO_CDM_COMB){
        console.log("Doing Nothing")
    }
    else{
    if (default_crit_show_dict["C.Full"]!==undefined){
        delete default_crit_show_dict["C.Full"];
    }
    if (default_crit_show_dict['C.Prune']!==undefined){
        delete default_crit_show_dict['C.Prune'];
    }
    if (default_crit_show_dict['default']!==undefined){
        delete default_crit_show_dict['default'];
    }
    if (default_crit_show_dict['Cdm.Def']!==undefined){
        delete default_crit_show_dict['Cdm.Def'];

    }
    if (default_crit_show_dict['cdm']!==undefined){
        delete default_crit_show_dict['cdm'];
        if (cdm_crit_show_dict['c.full']){
        delete cdm_crit_show_dict['c.full'];
        }

    }


    if (default_crit_hide_dict["C.Full"]!==undefined){
        delete default_crit_hide_dict["C.Full"];

    }
    if (default_crit_hide_dict['C.Prune']!==undefined){
        delete default_crit_hide_dict['C.Prune'];

    }
    if (default_crit_hide_dict['default']!==undefined){
        delete default_crit_hide_dict['default'];

    }
    if (default_crit_hide_dict['Cdm.Def']!==undefined){
        delete default_crit_hide_dict['Cdm.Def'];

    }
    if (default_crit_hide_dict['cdm']!==undefined){
        delete default_crit_hide_dict['cdm'];
        if (cdm_crit_hide_dict['c.full']!==undefined){
        delete cdm_crit_hide_dict['c.full'];
        }


    }
    console.log("default_crit_show_dict!!!",default_crit_show_dict);
    if (default_crit_show_dict['default']===undefined || default_crit_hide_dict['default']===undefined ){
        $('#defualt_criteria_popup').empty();
        $('#defualt_criteria_popup').dialog({ 
                    title: "Default Criteria Confirmation",
                    autoOpen: false,
                    minHeight: 200,
                    maxHeight: 300,
                    closeOnEscape: true,
                    close: function () {   $( this ).dialog( "close" );},
                    hide: { effect: "highlight", duration: 500 },
                    buttons: [
                            {
                                text: "Proceed",
                                click: function() {
                                $( this ).dialog( "close" );
                                HideALL();
                                enableCriteriaButton();
                                var current=$(".active");
                                current.prop('class',current.attr('class').replace('active',""));
                                $('#def_crit_list_btn').prop('class', 'custom_nav_btn active');
                               
                                $("#default_tree_view_div").empty();
                                 $("#default_tree_view_div").show();
                                 $("#default_criteria_main_div").show();
                                 $("#catalog_crit_sel").show();
                                 dict_not_empty_flag="false";
                                defualtCriteriaOrderHtmlSetup();
                                // defualtCriteriaHtmlSetup();
                            }
                            
                               
                    },
                   
                    
        ]
              
                }); // Initialize dialog plugin
                $('#defualt_criteria_popup').dialog("open");
                var row_div = document.createElement('div');
                row_div.setAttribute('class','row');
                $('#defualt_criteria_popup').append(row_div);

                var row_d1=document.createElement('div');
                row_d1.setAttribute('class','row');
                row_div.append(row_d1);
                var col_md_12_div=document.createElement('DIV');
                col_md_12_div.setAttribute('class','col-md-12');
                row_d1.append(col_md_12_div)
                var p_text=document.createElement('p');
                p_text.innerHTML="You haven't selected criteria display"
                col_md_12_div.append(p_text)
                var row_d2=document.createElement('div');
                row_d2.setAttribute('class','row');
                row_div.append(row_d2);
                var col_md_12_div2=document.createElement('DIV');
                col_md_12_div2.setAttribute('class','col-md-12');
                row_d2.append(col_md_12_div2);
                var p_text=document.createElement('p');
                p_text.innerHTML="Do wish to proceed with defualt(Full) Criterias and Ordering?";
                col_md_12_div.append(p_text);
                // var input = document.createElement("INPUT");
                // input.setAttribute("type", "number");
                // input.id='inputset_num_co';
                // col_md_12_div2.append(input);
                $("#criteria_option_name").empty();
                $("#criteria_option_name").append("<h4> Default CDM and Default CO</h4>");
                
                return;
    }
    else{
        
        let defualt_update_alert = confirm("Do You want to update the exsisting Experiment Settings?")
        if(defualt_update_alert===true){
            alert("Updating...")
            
        }
        else{
         $.ajax({
                    type: 'POST',
                    dataType: "json",
                    'data': {
                    'block_feat_dict': JSON.stringify(block_feat_dict,undefined,''),
                    "final_def_blocks_to_send":JSON.stringify(final_def_blocks_to_send),

                    'exp_id': exp_id,
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    },
                    // the ajax call is sent to createexp url name in the post function.  
                    url: "{% url 'createexp' %}",
                    success: function(data){
                        console.log("<<---FEATURES POSTED SUCCESSFULLY--->>");
                        console.log(data);
                        //console.log('Blocks---> ',data);
                        if(exp_id===""){
                            exp_id = data['exp_id'];
                            custom_exp_id = data['custom_exp_id'];
                            showExpWIP()
                        }
                            if (data['block_list']!=null){
                                blockList = data['block_list']
                                table_blocks=draw_block_table(blockList)
                                display_blocktable(table_blocks);
                                window.localStorage.setItem("blockList", JSON.stringify(blockList));
                    
                            }
                        }
                    }); 
            return;
        }
    }
    
    }
    
    /* show popup telling admin that by default full criteria is selected. if ok pressed then
    // show all critria list and option for hiding, once user finishes. 
    // c.full will be added to dict. 
    // automatically back to feat_lvl_div. 
    // now criteria display method will be ticked and only c.full will be ticked all else not ticked. 
    // if box unchecked it'll remove everything set for exp. it will check if exp_id is empty or not if not then it will run sendfeature level func. 
    // 
    */ 
    
}
else if (block_feat_dict['C']!==undefined && block_feat_dict['CO']===undefined){

    CO_CDM_COMB="CDM_on_CO_off";
    if (current_save_state===CO_CDM_COMB){
        console.log("Doing Nothing")
    }
    else{
        $("#def_main_row_co_def").empty();
        $("#default_criteria_div").empty();
        console.log("default_crit_show_dict['C.Full']",default_crit_show_dict)
        if (default_crit_show_dict["C.Full"]!==undefined){
            delete default_crit_show_dict["C.Full"];

        }
        if (default_crit_show_dict['C.Prune']!==undefined){
            delete default_crit_show_dict['C.Prune'];

        }
        if (default_crit_show_dict['default']!==undefined){
            delete default_crit_show_dict['default'];

        }
        if (default_crit_show_dict['Cdm.Def']!==undefined){
            delete default_crit_show_dict['Cdm.Def'];

        }
        if (default_crit_show_dict['cdm']!==undefined){
            delete default_crit_show_dict['cdm'];
        }
        if (default_crit_hide_dict["C.Full"]!==undefined){
            delete default_crit_hide_dict["C.Full"];

        }
        if (default_crit_hide_dict['C.Prune']!==undefined){
            delete default_crit_hide_dict['C.Prune'];

        }
        if (default_crit_hide_dict['default']!==undefined){
            delete default_crit_hide_dict['default'];

        }
        if (default_crit_hide_dict['Cdm.Def']!==undefined){
            delete default_crit_hide_dict['Cdm.Def'];

        }
        if (default_crit_hide_dict['cdm']!==undefined){
            delete default_crit_hide_dict['cdm'];
            

        }
        cdm_crit_hide_dict={};
        cdm_crit_show_dict={};
    



        HideALL();
        enableCriteriaButton();
        
        $("#cdm_on_co_off_tree_view_div").empty();
        $("#cdm_on_co_off_tree_view_div").show();
        prune_empty_flag="true"
        
        cdm_defaultCriteriaOrderHTMLSetup();
        // CdmCriteriaHTMLSetup();
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#def_crit_list_btn').prop('class', 'custom_nav_btn active');
        $("#criteria_option_name").empty();
        $("#criteria_option_name").append("<h4> Active CDM and Default CO</h4>");
                    
        return;
    }
    /*
        // This means C.Full and C.Prune level active. 
        // show admin the criteria list for full and allow to make changes.
        // Once its done Enable the C.Prune button where the user can now see full criteria list defined by admin. 
        // Here the user can prune the criteria from full criteria list and save changes. 
        // Admin will be redirected to the Feature level div/page. 
        // If admin presses c.full button after c.prune being enabled then what?? 
        // Idealy if the admin makes changes to the list then c.pruned list should automatically be updated. 
        // CFID: Default
    */
}
else if (block_feat_dict['C']===undefined && block_feat_dict['CO']!==undefined){

    default_active="true"
    crit_order_dict={};
    crit_hide_dict={};
    CO_CDM_COMB="CDM_off_CO_on"
    if (current_save_state===CO_CDM_COMB){
        console.log("Doing Nothing")
    }
    else{
    
        if (default_crit_show_dict["C.Full"]!==undefined){
            delete default_crit_show_dict["C.Full"];

        }
        if (default_crit_show_dict['C.Prune']!==undefined){
            delete default_crit_show_dict['C.Prune'];

        }
        if (default_crit_show_dict['default']!==undefined){
            delete default_crit_show_dict['default'];

        }
        if (default_crit_show_dict['Cdm.Def']!==undefined){
            delete default_crit_show_dict['Cdm.Def'];

        }
        if (default_crit_hide_dict["C.Full"]!==undefined){
            delete default_crit_hide_dict["C.Full"];

        }
        if (default_crit_hide_dict['C.Prune']!==undefined){
            delete default_crit_hide_dict['C.Prune'];

        }
        if (default_crit_hide_dict['default']!==undefined){
            delete default_crit_hide_dict['default'];

        }
        if (default_crit_hide_dict['Cdm.Def']!==undefined){
            delete default_crit_hide_dict['Cdm.Def'];

        }

        
    
        HideALL();
        $("#ol4").empty();

        $("#cdm_off_co_on_tree_view_div").empty();

        $("#cdm_off_co_on_tree_view_div").show();
        $("#catalog_crit_sel").show();

        dict_not_empty_flag="false";
        def_cdm_co_on_HtmlSetup();
        enableCriteriaButton();

        // orderCriteriaHtmlSetup("CO",dict["CO"],default_active);
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#def_crit_list_btn').prop('class', 'custom_nav_btn active');
        $("#criteria_option_name").empty();
        $("#criteria_option_name").append("<h4>Active CO</h4>");
        return;
    }
    /*
        // Now first we get number of sets admin wants. 
        // Then admin will be shown default criteria list along with number of sets. 
        // Admin will select criterias from list for each set and then save changes. 
        // CFID: CO.1.C.Full,CO.2.C.Full
    
    */
}
else if (block_feat_dict['C']!==undefined && block_feat_dict['CO']!==undefined){
    // orderCriteriaHtmlSetup("CO",block_feat_dict["CO"],default_active);
    alert("4")

    crit_order_dict={};
    crit_hide_dict={};
    // delete default_crit_show_dict["cdm"];
    // delete default_crit_show_dict['default'];
    // delete default_crit_show_dict['Cdm.Def'];
    
    // delete default_crit_hide_dict["cdm"];
    // delete default_crit_hide_dict['default'];
    // delete default_crit_hide_dict['Cdm.Def'];
    
    CO_CDM_COMB="CDM_on_CO_on";
    if (current_save_state===CO_CDM_COMB){
        console.log("Doing Nothing")
    }
    else{
        cdm_crit_order_on_flag="false";

        
        HideALL();

        // cdm_On_Full_Co_HtmlSetup();
        $("#cdm_on_co_on_tree_view_div").empty();
        $("#cdm_on_co_on_tree_view_div").show();
        $("#cdm_co_on_show_Option").show();
        cdm_on_co_on_DefaultCriteriaHtmlSetup();
        enableCriteriaButton();
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#def_crit_list_btn').prop('class', 'custom_nav_btn active');
        $("#criteria_option_name").empty();
        $("#criteria_option_name").append("<h4> Default CDM and Active CO</h4>");
                    
        return;
    } 
    /*
        // Now as both are checked, 
        // First the Admin will select order criteria sets. 
        // C.Full and C. Prune will be on. 
        // Admin will select full criteria for each set and then C.prune will be enabled. 
        // Criteria list will be pruned for each set and changes will be saved. 
        // CFID: CO.1.C.Full, CO.2.C.Full, CO.1.C.Prune, CO.2.C.Prune 
        // 
    */
}

// if (jQuery.isEmptyObject(block_feat_dict))
// {
//     alert("Please enable at least one Feature. Thank you!!")
//     console.log("DIIICCCT",block_feat_dict['C']);
//     console.log("DIIICCCT",block_feat_dict['CO']);
//     console.log("DIIICCCT",block_feat_dict);
//     return;
// }
  
// $.ajax({
// type: 'POST',
// dataType: "json",
// 'data': {
// 'block_feat_dict': JSON.stringify(block_feat_dict,undefined,''),
// "final_def_blocks_to_send":JSON.stringify(final_def_blocks_to_send),

// 'exp_id': exp_id,
// 'csrfmiddlewaretoken': '{{ csrf_token }}',
// },
// // the ajax call is sent to createexp url name in the post function.  
// url: "{% url 'createexp' %}",
// success: function(data){
//     console.log("<<---FEATURES POSTED SUCCESSFULLY--->>");
//     console.log(data);
//     //console.log('Blocks---> ',data);
//     if(exp_id===""){
//         exp_id = data['exp_id'];
//         custom_exp_id = data['custom_exp_id'];
//         showExpWIP()
//     }
//         if (data['block_list']!=null){
//             blockList = data['block_list']
//             table_blocks=draw_block_table(blockList)
//             display_blocktable(table_blocks);
//             window.localStorage.setItem("blockList", JSON.stringify(blockList));
 
//         }
//     }
//   }); 

}
function removeFeatureLevel(){
    $.ajax({
type: 'POST',
dataType: "json",
'data': {
'block_feat_dict': JSON.stringify(block_feat_dict,undefined,''),
'exp_id': exp_id,
'csrfmiddlewaretoken': '{{ csrf_token }}',
},
// the ajax call is sent to createexp url name in the post function.  
url: "{% url 'createexp' %}",
success: function(data){
    console.log("<<---FEATURES POSTED SUCCESSFULLY--->>");
    console.log(data)
    //console.log('Blocks---> ',data);
    for(var i in data){
        console.log("Hi:",i,data[i])
      
    }
    // alert(exp_id);
    if(exp_id===""){
        exp_id = data['exp_id'];
        custom_exp_id = data['custom_exp_id'];
        showExpWIP()
    }
        if (data['block_list']!=null){
            blockList = data['block_list']
            table_blocks=draw_block_table(blockList)
            display_blocktable(table_blocks);
            window.localStorage.setItem("blockList", JSON.stringify(blockList));
 
        }
    }
  })
}
function draw_block_table(blocklist){
        // var tab_blocks = $("<table id='blocks_table'/>");
       
        var table_blocks=document.createElement('TABLE');
        table_blocks.setAttribute('id','blocks_table');
        table_blocks.setAttribute('class','table table-striped table-bordered table-condensed');

        var thead=document.createElement('THEAD');
        table_blocks.appendChild(thead);
        var tbody=document.createElement('TBODY');
        table_blocks.appendChild(tbody);
        var trh=document.createElement('TR');
        thead.appendChild(trh);
        var  th=document.createElement('TH');
        trh.appendChild(th);
        th.append('Block No');
        var  th=document.createElement('TH');
        trh.appendChild(th);
        th.append('Feature Level Combination');

    for(var i = 0; i < blocklist.length; i++){
            var tr=document.createElement('TR')
            tbody.appendChild(tr);
            var td=document.createElement('TD')
            tr.appendChild(td);
            td.append(blocklist[i]['serial_no'])
            var td=document.createElement('TD')
            tr.appendChild(td);
            td.append(blocklist[i]['levels_set'])
         }
    return table_blocks;
}
function display_blocktable(table_blocks){
    // Is not useed anymore
    // $('#blocksBreakUp').html('');
    // $('#blocksBreakUp').append(table_blocks);
    $('#generated_blocks').html('');
    $('#generated_blocks').append(table_blocks);
    
}

function sendFilePath(id){
        console.log(id);
        console.log($('#'+id).val().replace(/C:\\fakepath\\/i, ''));
        var filepath=$('#'+id).val().replace(/C:\\fakepath\\/i, '');
        console.log(filepath);
        $.ajax({
        type: 'POST',
        dataType: "json",
        'data': {
        'block_feat_dict': JSON.stringify(filepath),
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        // the ajax call is sent to subdetails url name in the post function.  
        url: "{% url 'createexp' %}",
        success: function(data){}
        
        }); 

      }
</script>
<!-- <script src="https://code.jquery.com/jquery-3.3.1.js"></script> -->
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>


<script src="{% static 'webapp/createexp/DataTables/DataTables-1.10.18/js/jquery.dataTables.min.js' %}"></script>
<link rel="stylesheet" type="text/css" src="{% static 'webapp/createexp/DataTables/DataTables-1.10.18/cs/jquery.dataTables.min.css' %}"/>
<script>
    // Warning before leaving the page (back button, or outgoinglink)
    window.onbeforeunload = function() {
        window.localStorage.setItem("slider_set_dict", JSON.stringify(slider_set_dict));
        window.localStorage.setItem("brand_set_dict", JSON.stringify(brand_set_dict));
        window.localStorage.setItem("phoneset_dic", JSON.stringify(phoneset_dic));
        window.localStorage.setItem("phonename_dic", JSON.stringify(phonename_dic));
        window.localStorage.setItem("crit_order_dict", JSON.stringify(crit_order_dict));
        window.localStorage.setItem("crit_hide_dict", JSON.stringify(crit_hide_dict));
        
        // if (Object.keys(default_crit_show_dict).length !== 0){
        //     window.localStorage.setItem("default_crit_show_dict", JSON.stringify(default_crit_show_dict));
        //     }
            
        // if (Object.keys(default_crit_hide_dict).length !== 0){

        //     window.localStorage.setItem("default_crit_hide_dict", JSON.stringify(default_crit_hide_dict));
        // }


       return "Do you really want to leave our brilliant application?";
       //if we return nothing here (just calling return;) then there will be no pop-up question at all
       //return;
    };
   
</script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script> -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
<script>
    // var btns = document.getElementsByClassName("custom_nav_btn");
var slider_set_dict={};
var brand_set_dict={};
$(document).ready(function () {
            // console.log('btns',btns)
            $('#mobile_catalog_div').hide();
            $('#pager').hide();

       

        });
function mobileCatalog(){

        $("#exp_description_div").hide();
        $('#importSubdiv').hide();
        $('#dispFileFeatLvldiv').hide();
        $('#subj_split_batch_rowdiv').hide();
        $('#pager').hide();
        $('#block_assign_row_div').hide();
        $('#feat_lvl_div').hide();
        $('#batchmngprvbtn_div').hide();
        $('#dataDiv').hide();
        $('#blkoutputsDiv').hide();
        $("#default_criteria_main_div").hide();
        $("#order_criteria_div").hide();
        $("#cdm_criteria_div").hide();
        $("#cdm_co_on_show_Option").hide();
        $("#cdm_co_on_div").hide();
        $("#ol1").hide();
        $("#ol2").hide();
        $("#ol3").hide();
        $("#ol4").hide();

        $('#expphonelist_div').show();
        $("#price_slider_div").show(); 
        $('#brand_check_div').show();
        $("#exp_sel_phones_div").show();
        $("#searchfilter_head_div").show();
        if($("#set_buttons").children().length <=0){
            $('#mobile_catalog_div').show();

            // creation of html slide div!
            $('#price_slider_div').empty();
            var row_fluid=$('#price_slider_div');
            var row=document.createElement('div');
            row.setAttribute('class','row');
            row_fluid.append(row);
            var col_md_4_1=document.createElement("div");
            col_md_4_1.setAttribute('class','col-md-2');
            row.append(col_md_4_1);
            var col_md_4_2=document.createElement("div");
            col_md_4_2.setAttribute('class','col-md-8');
            row.append(col_md_4_2);
            var col_md_4_3=document.createElement("div");
            col_md_4_3.setAttribute('class','col-md-2');
            row.append(col_md_4_3);
            var input=document.createElement('input');
            input.setAttribute('class','slider')
            input.setAttribute('id','price_slider')
            col_md_4_2.append(input)
            $('#price_slider').show();

        var slider2 = new rSlider({
                    target: '#price_slider',
                    values: {min:5000,max:200000},
                    range: true,
                    tooltip: true,
                    scale: false,
                    labels: false,
                    set: [5000, 200000],
                    step:500,
                    onChange:function (values) { 
                        var values=values.split(',');
                        console.log("values-->",values);
                        if (brand_set_dict[active_button]===undefined){
                            brand_set_dict[active_button]=[]

                        }
                        $.ajax({
                             // Ajax call to getrange of phones ...  
                                url: "{% url 'createexp' %}",
                                type:'GET',
                                'data': {
                                'brandnames':brand_set_dict[active_button],
                                'price_range_values':JSON.stringify(values),
                                // 'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                success: function(data){
                                console.log("data",data);// location.reload();
                                $('#mobile_catalog_div').empty();
                                $("#pager").show()
                              
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                    // if (i%3===0 && i!==0){
                                    //     console.log("asd",i)
                                    //     var hr=document.createElement('hr');
                                    //     lps.append(hr); 
                                    //     var rtc=document.createElement('DIV');
                                    //     rtc.setAttribute("class","row text-center");
                                    //     lps.append(rtc);
                                      
                                    // }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=data['price_range_values'];
                                    if (slider_set_dict[active_button]===undefined){
                                        slider_set_dict[active_button]=[]
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }else{
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }
                                    if (Object.keys(phoneset_dic).length === 0){
                                        for (i in setlist){
                                            phoneset_dic[setlist[i]]=[]
                                        }
                                        console.log("prhones doct---OPP",phoneset_dic)
                                    }
                                    if (phoneset_dic[active_button]===undefined    ){
                                        phoneset_dic[active_button]=[];

                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager)

                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize:9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();
                                                                
                            }
                                
                                
                         }); 
                       
                    }
        });
       

        // on clicking the mobile catalog generate set buttons and put set P.1 as active. 
        var phoneset_button_div=$('#phoneset_button_div');
        $('#phoneset_button_div').empty();
        $('#phones_main_button_div').show();
        var row=document.createElement('div');
        row.setAttribute('class','row');
        phoneset_button_div.append(row);
        var col_md_8=document.createElement('div');
        col_md_8.setAttribute('class','col-md-9 btn-group');
        col_md_8.id="set_buttons"
        row.append(col_md_8);
        var col_md_2=document.createElement('div');
        col_md_2.setAttribute('class','col-md-2');
        col_md_2.setAttribute('style','width:inherit');

        col_md_2.id="process_buttons"
        row.append(col_md_2);
        var nextstep=document.createElement('button');
        nextstep.id="nextStep_Prc_bttns"
        nextstep.innerHTML="Next Step";
        nextstep.setAttribute("onclick","NextStep($(this))");
        col_md_2.append(nextstep);
        var col_md_2=document.createElement('div');
        col_md_2.setAttribute('class','col-md-1');
        col_md_2.id="save_button"
        row.append(col_md_2);
        console.log("DICTIONARY!!!!!",block_feat_dict['P']);
        default_list=["P.Default","P.All"]
        if (block_feat_dict['P']===undefined ||  block_feat_dict['P'][0]==="P.All"){
                for (var i=0;i<default_list.length;i++){
                    var button=document.createElement('button')
                    button.id=default_list[i]
                    button.innerHTML=default_list[i];
                    button.setAttribute("onclick","defSetFunc($(this).attr('id'))")
                    if (i===0){
                        var this_b=button
                    }
                    $('#set_buttons').append(button)
                    defSetFunc($(this_b).attr('id'))
            }
        }
        else{
                for (var i=0;i<setlist.length;i++){
                    var button=document.createElement('button')
                    button.id=setlist[i]
                    button.innerHTML=setlist[i];
                    button.setAttribute("onclick","SetFunc($(this).attr('id'))")
                    if (i===0){
                        var this_b=button
                    }
                    $('#set_buttons').append(button)
                    $("#searchfilter_head_div").show();    
                    $("#price_slider_div").show();    
                    $("#brand_check_div").show(); 
                }
                

                SetFunc($(this_b).attr('id'));
        }
        // $('.innerchecksboxdivs').hide();
        // $('.map_select_label').hide();
        // $('.show_select_tag').hide();
        // $('#self-defined').hide();
        // $('#pre-defined').hide();
        // $('#selfbuttondiv').hide();
        // $('#prebuttondiv').hide();
        // $('#upload').prop('disabled',true);
        }
        else {
            $("#phones_main_button_div").show();
            $('#mobile_catalog_div').show();

        }
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#create_exp_mobile_catalog').prop('class', 'custom_nav_btn active');
    }
    var specmobphones={}
    
function NextStep(element){
        // send all mobile id to server and request for there details. 
        console.log(Object.keys(phoneset_dic).length);
        dict_len=Object.keys(phoneset_dic).length;
        if (dict_len===setlist.length){
            var count=0
            for (i in phoneset_dic){
                console.log("IIII",i)
                console.log("phoneset_dic[i]",phoneset_dic[i])
                if (phoneset_dic[i]===undefined || phoneset_dic[i].length<=1){
                count=count+1;
                }
            }
            if (count===setlist.length){
                alert("Please select at least two phones for the set");
                return;

            }
            else if (count<setlist.length && count>0){
                alert("Please select  phones for the sets");
                return;
            }
        }

        
        // CHECK FOR ALL PHONESET_DICT keys if there list value is less than 1 or undefined
        
        $.ajax({
                // Ajax call to get specific phones...  
                url: "{% url 'get_specificmobile_data' %}",
                type:'POST',
                'data': {
                'specsmobdata':JSON.stringify(phoneset_dic),
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                dataType: "json",
                success: function(data){
                    console.log("active_button",active_button)
                    console.log(data['mobilephones'][active_button])
                    $('#mobile_catalog_div').empty();
                    $('#pager_div').empty();
                               
                                // var json_data_mobiles=data['samsung_phones']
                                
                                var json_data_mobiles=data['mobilephones'][active_button];
                                specmobphones=data['mobilephones'];
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                rtc.id="grid";
                                lps.append(rtc);

                            

                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                //     if (i%3===0 && i!==0){
                                //         var hr=document.createElement('hr');
                                //         lps.append(hr); 
                                //         var rtc=document.createElement('DIV');
                                //         rtc.setAttribute("class","row text-center");
                                //         lps.append(rtc);
                                      
                                //     }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    col_md_4_post.id=json_data_mobiles[i]['id'];
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    console.log("phoneset_dic[active_button]",phoneset_dic[active_button])
                                    if (phoneset_dic[active_button]===undefined){
                                        phoneset_dic[active_button]=[]
                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        // console.log("list",phoneset_dic[active_button])
                                        // console.log("list type",typeof(phoneset_dic[active_button]))

                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                 }

                                console.log("specmobphones",specmobphones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                var ds="grid_"+active_button;
                                console.log("ds",ds)

                                $("#grid").sortable({
                                    stop: function( event, ui ) {
                                        var arr=[]
                                        console.log("event-->",$(this));
                                        var id = ui.item.attr("id");
                                        
                                        // var data = $(this).sortable('toArray', { attribute: 'id' });
                                        $(this).find('input').each(function(){
                                                arr.push($(this).val());  
                                        });         
                                            console.log("array->",arr)
                                        var result = arr.map(function (x) { 
                                        return parseInt(x, 10); 
                                        });
                                        console.log("data-->",result)
                                        phoneset_dic[active_button]=result
                                        console.log("phoneset_dic-->",phoneset_dic);
                                        },
                                  
                                });
                                $( "#grid" ).disableSelection();
                              
                              
                            }
            });
        var backbutton=document.createElement('button');
        backbutton.innerHTML="Back"
        backbutton.setAttribute('onclick','backFunc($(this))')
        backbutton.setAttribute('id','backbutton_id')
       
        
        var savebutton=document.createElement('button');
        savebutton.innerHTML="Save";
        savebutton.setAttribute('onclick','SavePhoneSet($(this))');
        savebutton.setAttribute('id','savebutton_id');
        $(element).remove;
        $('#process_buttons').empty();
        $('#save_button').empty();
        $('#price_slider_div').empty();
        $('#brand_check_div').hide();


        $('#process_buttons').append(backbutton);
        $('#save_button').append(savebutton);

        
    }
function SavePhoneSet_P0(){
        phoneset_dic={};
        phonename_dic={};
        $.ajax({
            url: "{% url 'savephonesets_p0' %}",
                type:'POST',
                'data': {
                    
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                dataType: "json",
                success: function(data){
                    if(exp_id===""){
                    exp_id = data['exp_id'];
                    custom_exp_id = data['custom_exp_id'];
                    showExpWIP()
                    }
                    // if (data['block_list']!=null){
                    //     blockList = data['block_list']
                    //     table_blocks=draw_block_table(blockList)
                    //     display_blocktable(table_blocks);
                    //     window.localStorage.setItem("blockList", JSON.stringify(blockList));
                    // }
                    
                    $("#expphonelist_div").empty();
                    showFeatureLvls();
                    var current=$(".active");
                    current.prop('class',current.attr('class').replace('active',""));
                    $('#ftlvl').prop('class', 'custom_nav_btn active');
                }
        });
}
function SavePhoneSet(element){
        $.ajax({
                // Ajax call to savephoneset  
                url: "{% url 'savephonesets' %}",
                type:'POST',
                'data': {
                'phoneset_dic':JSON.stringify(phoneset_dic),
                'featlevels_dic': JSON.stringify(block_feat_dict,undefined,''),
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                dataType: "json",
                success: function(data){
                    if(exp_id===""){
                    exp_id = data['exp_id'];
                    custom_exp_id = data['custom_exp_id'];
                    showExpWIP()
                    }
                    if (data['block_list']!=null){
                        blockList = data['block_list']
                        table_blocks=draw_block_table(blockList)
                        display_blocktable(table_blocks);
                        window.localStorage.setItem("blockList", JSON.stringify(blockList));
                    }
                    var current=$(".active");
                    current.prop('class',current.attr('class').replace('active',""));
                    $('#ftlvl').prop('class', 'custom_nav_btn active');
                    
                    console.log("block_feat_dict<<<<<!!!!")
                    console.log(block_feat_dict)
                              


                   showFeatureLvls();
                   if (active_button==="P.Default"){
                        $("#6").prop('checked', false);

                    }
                    else{
                   
                     ele= document.getElementById('6')
                     ele.checked=true; 
                    }
                   

                }
                
        });
    }
function backFunc (element){
        
    $('#brand_check_div').show();

        
        var nextstep=document.createElement('button');
        nextstep.innerHTML="Next Step";
        nextstep.setAttribute("onclick","NextStep($(this))");
        $('#save_button').empty();
        $('#process_buttons').empty();
       

        $('#process_buttons').append(nextstep);
        
        $(element).remove();
        SetFunc(active_button);
        
    }
function defSetFunc(active_id){
    if(active_button!==""){
            document.getElementById(active_button).style.backgroundColor = ""
        }
        
    active_button=active_id;

    if(active_button==="P.Default"){

        $('#save_button').empty();
        $('#expphonelist_div').empty();
        $("#process_buttons").empty();
        $("#searchfilter_head_div").show();    
       $("#price_slider_div").show();    
       $("#brand_check_div").show(); 
        
        var nextstep=document.createElement('button');
        nextstep.id="nextStep_Prc_bttns"
        nextstep.innerHTML="Next Step";
        nextstep.setAttribute("onclick","NextStep($(this))");
        $("#process_buttons").append(nextstep);
        if (phonename_dic[active_button]===undefined){
            phonename_dic[active_button]=[]
        }

        phone_sidebarHtmlPop();
        document.getElementById(active_button).style.backgroundColor = "#94000e"
        console.log("phoneset_dic",phoneset_dic)
        console.log("specmobphones",specmobphones)
        if ($('#backbutton_id').text()==="Back"){
            
            $('#mobile_catalog_div').empty();
            var json_data_mobiles=specmobphones[active_button]
            console.log("phoneset_dic---",phoneset_dic[active_button]);
            console.log("specmobphones",specmobphones);
            if (phoneset_dic[active_button]!==undefined){
                        if (phoneset_dic[active_button].length===specmobphones[active_button].length){
                            var len=phoneset_dic[active_button].length;
                            for (var i=0;i<len;i++){
                                for (var j=0;j<len;j++){
                                    if(specmobphones[active_button][j].id===phoneset_dic[active_button][i]){
                                            temp_list.push(specmobphones[active_button][j])
                                    }
                                }
                            }
                        }
            }
            
            var json_data_mobiles=temp_list
            console.log("json_data_mobiles",json_data_mobiles)
            row_fluid=$('#mobile_catalog_div');
            var row=document.createElement('div');
            row.setAttribute('class','row');
            row_fluid.append(row);
            var col_md_12=document.createElement("div");
            col_md_12.setAttribute('class','col-md-12');
            row.append(col_md_12);
            var lps=document.createElement("div");
            lps.setAttribute("class",'latest-product-section');
            col_md_12.append(lps);
            var rtc=document.createElement('DIV');
            rtc.setAttribute("class","row text-center");
            rtc.id="grid";
            lps.append(rtc);
            for (var i=0;i<json_data_mobiles.length;i++){
                // if (i%3===0 && i!==0){
                //     var hr=document.createElement('hr');
                //     lps.append(hr); 
                //     var rtc=document.createElement('DIV');
                //     rtc.setAttribute("class","row text-center");
                //     lps.append(rtc);
                // }
                var col_md_4_post=document.createElement('DIV');
                col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                col_md_4_post.id=i+1;
                rtc.append(col_md_4_post);
                var margin_b_20=document.createElement('DIV');
                margin_b_20.setAttribute("class","margin-b-20");
                col_md_4_post.append(margin_b_20);
                var input_checkb=document.createElement('input');
                input_checkb.type="checkbox";
                
                if (phoneset_dic[active_button]===undefined ){
                    phoneset_dic[active_button]=[];
                }
                else{
                    //  a check to check if the retrieved mob id matches the id in the list 
                    
                    if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                        input_checkb.checked=true;
                    }

                }
                
                input_checkb.value=json_data_mobiles[i]['id'];
                input_checkb.id=json_data_mobiles[i]['id']+"cat";
                input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                var img=document.createElement('img');
                img.setAttribute('class','img-responsive')
                // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                margin_b_20.append(input_checkb);
                margin_b_20.append(img);
                var mobile_name_p=document.createElement('p')
                mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                col_md_4_post.append(mobile_name_p)
                var mobile_price_p=document.createElement('p')
                mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                col_md_4_post.append(mobile_price_p)
                var link=document.createElement('a');
                link.setAttribute('class','link btn btn-success');
                // took alot of time finding this solution...
                var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                link.href= url;
                link.target='_blank';
                link.text="READ MORE";
                col_md_4_post.append(link); 
                }
                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                for (phones in global_phones_exp_phones){
                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                }
                var ds="grid_"+active_button;
                console.log("ds",ds)
                $("#grid").sortable({
                stop: function( event, ui ) {
                    var arr=[]
                    var id = ui.item.attr("id");
                    console.log("id",id);
                    console.log("children",$(this).find('input'));
                    $(this).find('input').each(function(){
                    arr.push($(this).val());  
                    });         
                        console.log("array",arr)
                    // var data = $(this).sortable('toArray', { attribute: 'id' });
                    var result = arr.map(function (x) { 
                    return parseInt(x, 10); 
                    });
                    phoneset_dic[active_button]=result;
                    },
                
                    });
                        $( "#grid" ).disableSelection();

                    }   
        else{
           
            // creation of html slide div!
            $('#price_slider_div').empty();
            var row_fluid=$('#price_slider_div');
            var row=document.createElement('div');
            row.setAttribute('class','row');
            row_fluid.append(row);
            var col_md_4_1=document.createElement("div");
            col_md_4_1.setAttribute('class','col-md-2');
            row.append(col_md_4_1);
            var col_md_4_2=document.createElement("div");
            col_md_4_2.setAttribute('class','col-md-8');
            row.append(col_md_4_2);
            var col_md_4_3=document.createElement("div");
            col_md_4_3.setAttribute('class','col-md-2');
            row.append(col_md_4_3);
            var input=document.createElement('input');
            input.setAttribute('class','slider')
            input.setAttribute('id','price_slider')
            col_md_4_2.append(input)
            $('#price_slider').show();
            var set_value=[];
            if (slider_set_dict[active_button]===undefined){
                set_value=[5000,200000];
            }
            else{
                set_value=slider_set_dict[active_button]
            }

        var slider2 = new rSlider({
                    target: '#price_slider',
                    values: {min:5000,max:200000},
                    range: true,
                    tooltip: true,
                    scale: false,
                    labels: false,
                    set: set_value,
                    step:500,
                    onChange:function (values) { 
                        var values=values.split(',');
                        console.log("values-->",values);

                        $.ajax({
                             // Ajax call to getrange of phones ...  
                                url: "{% url 'createexp' %}",
                                type:'GET',
                                'data': {
                                'price_range_values':JSON.stringify(values),
                                'brandnames':JSON.stringify(brand_set_dict[active_button])
                                // 'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                success: function(data){
                                console.log("data",data);// location.reload();
                                $('#mobile_catalog_div').empty();                            
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                    // if (i%3===0 && i!==0){
                                    //     console.log("asd",i)
                                    //     var hr=document.createElement('hr');
                                    //     lps.append(hr); 
                                    //     var rtc=document.createElement('DIV');
                                    //     rtc.setAttribute("class","row text-center");
                                    //     lps.append(rtc);
                                      
                                    // }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=data['price_range_values'];

                                    if (slider_set_dict[active_button]===undefined){
                                        slider_set_dict[active_button]=[]
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }else{
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }
                                    // console.log('slider_set_dict',slider_set_dict)
                                    if (phoneset_dic[active_button]===undefined    ){
                                        phoneset_dic[active_button]=[];

                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager);
                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize:9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();
                            }
                                
                          
                         }); 
                       
                    }
        });

    }
   
    }
    else{
       $("#searchfilter_head_div").hide();    
       $("#price_slider_div").hide();    
       $("#brand_check_div").hide();    

        var savebutton=document.createElement('button');
        savebutton.innerHTML="Save"
        savebutton.setAttribute('onclick','SavePhoneSet_P0()')
        savebutton.setAttribute('id','savebutton_id')
        $("#process_buttons").empty();
        $('#save_button').empty()

        $('#save_button').append(savebutton)
        $.ajax({
                             // Ajax call to getrange of phones ...  
                                url: "{% url 'get_mobile_data' %}",
                                type:'GET',
                                'data': {
                                // 'price_range_values':JSON.stringify(values),
                                
                                //'brandnames':JSON.stringify(brand_set_dict[active_button])
                                // 'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                success: function(data){
                                console.log("data",data);// location.reload();
                                $('#mobile_catalog_div').empty();                            
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=data['price_range_values'];

                                    // if (slider_set_dict[active_button]===undefined){
                                    //     slider_set_dict[active_button]=[]
                                    //     slider_set_dict[active_button]=temp_set_val_list
                                    // }else{
                                    //     slider_set_dict[active_button]=temp_set_val_list
                                    // }
                                    // // console.log('slider_set_dict',slider_set_dict)
                                    // if (phoneset_dic[active_button]===undefined    ){
                                    //     phoneset_dic[active_button]=[];

                                    // }
                                    // else{
                                    //     //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                    //     if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                    //         input_checkb.checked=true;
                                    //     }

                                    // }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    // margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                // for (phones in global_phones_exp_phones){
                                //     $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                //     // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                // }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager);
                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize:9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();
                            }
                                
                          
        }); 
                       
       
        document.getElementById(active_button).style.backgroundColor = "#94000e"
        

    }
}
function SetFunc(active_id){
        if(active_button!==""){
            document.getElementById(active_button).style.backgroundColor = ""
        }
        
        active_button=active_id;
        // red color
        document.getElementById(active_button).style.backgroundColor = "#94000e"

        brandCheck_Html_Crt();

        // For  displaying phone list on sidebar
        $('#expphonelist_div').empty();
        if (phonename_dic[active_button]===undefined){
            phonename_dic[active_button]=[]
        }
        phone_sidebarHtmlPop();
        

        // check if back button exists 
        //*It is a check for next step
        var temp_list=[]
        if ($('#backbutton_id').text()==="Back"){
            
            $('#mobile_catalog_div').empty();
            var json_data_mobiles=specmobphones[active_button]
            console.log("phoneset_dic---",phoneset_dic[active_button]);
            console.log("specmobphones",specmobphones);
            if (phoneset_dic[active_button]!==undefined){
                        if (phoneset_dic[active_button].length===specmobphones[active_button].length){
                            var len=phoneset_dic[active_button].length;
                            for (var i=0;i<len;i++){
                                for (var j=0;j<len;j++){
                                    if(specmobphones[active_button][j].id===phoneset_dic[active_button][i]){
                                            temp_list.push(specmobphones[active_button][j])
                                    }
                                }
                            }
                        }
            }
            
            var json_data_mobiles=temp_list
            console.log("json_data_mobiles",json_data_mobiles)
            row_fluid=$('#mobile_catalog_div');
            var row=document.createElement('div');
            row.setAttribute('class','row');
            row_fluid.append(row);
            var col_md_12=document.createElement("div");
            col_md_12.setAttribute('class','col-md-12');
            row.append(col_md_12);
            var lps=document.createElement("div");
            lps.setAttribute("class",'latest-product-section');
            col_md_12.append(lps);
            var rtc=document.createElement('DIV');
            rtc.setAttribute("class","row text-center");
            rtc.id="grid";
            lps.append(rtc);
            for (var i=0;i<json_data_mobiles.length;i++){
                // if (i%3===0 && i!==0){
                //     var hr=document.createElement('hr');
                //     lps.append(hr); 
                //     var rtc=document.createElement('DIV');
                //     rtc.setAttribute("class","row text-center");
                //     lps.append(rtc);
                // }
                var col_md_4_post=document.createElement('DIV');
                col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                col_md_4_post.id=i+1;
                rtc.append(col_md_4_post);
                var margin_b_20=document.createElement('DIV');
                margin_b_20.setAttribute("class","margin-b-20");
                col_md_4_post.append(margin_b_20);
                var input_checkb=document.createElement('input');
                input_checkb.type="checkbox";
                
                if (phoneset_dic[active_button]===undefined ){
                    phoneset_dic[active_button]=[];
                }
                else{
                    //  a check to check if the retrieved mob id matches the id in the list 
                    
                    if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                        input_checkb.checked=true;
                    }

                }
                
                input_checkb.value=json_data_mobiles[i]['id'];
                input_checkb.id=json_data_mobiles[i]['id']+"cat";
                input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                var img=document.createElement('img');
                img.setAttribute('class','img-responsive')
                // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                margin_b_20.append(input_checkb);
                margin_b_20.append(img);
                var mobile_name_p=document.createElement('p')
                mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                col_md_4_post.append(mobile_name_p)
                var mobile_price_p=document.createElement('p')
                mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                col_md_4_post.append(mobile_price_p)
                var link=document.createElement('a');
                link.setAttribute('class','link btn btn-success');
                // took alot of time finding this solution...
                var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                link.href= url;
                link.target='_blank';
                link.text="READ MORE";
                col_md_4_post.append(link); 
                }
                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                for (phones in global_phones_exp_phones){
                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                }
                var ds="grid_"+active_button;
                console.log("ds",ds)
                $("#grid").sortable({
                stop: function( event, ui ) {
                    var arr=[]
                    var id = ui.item.attr("id");
                    console.log("id",id);
                    console.log("children",$(this).find('input'));
                    $(this).find('input').each(function(){
                    arr.push($(this).val());  
                    });         
                        console.log("array",arr)
                    // var data = $(this).sortable('toArray', { attribute: 'id' });
                    var result = arr.map(function (x) { 
                    return parseInt(x, 10); 
                    });
                    phoneset_dic[active_button]=result;
                    },
                
                    });
                        $( "#grid" ).disableSelection();

                    }   
        else{
           
            // creation of html slide div!
            $('#price_slider_div').empty();
            var row_fluid=$('#price_slider_div');
            var row=document.createElement('div');
            row.setAttribute('class','row');
            row_fluid.append(row);
            var col_md_4_1=document.createElement("div");
            col_md_4_1.setAttribute('class','col-md-2');
            row.append(col_md_4_1);
            var col_md_4_2=document.createElement("div");
            col_md_4_2.setAttribute('class','col-md-8');
            row.append(col_md_4_2);
            var col_md_4_3=document.createElement("div");
            col_md_4_3.setAttribute('class','col-md-2');
            row.append(col_md_4_3);
            var input=document.createElement('input');
            input.setAttribute('class','slider')
            input.setAttribute('id','price_slider')
            col_md_4_2.append(input)
            $('#price_slider').show();
            var set_value=[];
            if (slider_set_dict[active_button]===undefined){
                set_value=[5000,200000];
            }
            else{
                set_value=slider_set_dict[active_button]
                
            }

        var slider2 = new rSlider({
                    target: '#price_slider',
                    values: {min:5000,max:200000},
                    range: true,
                    tooltip: true,
                    scale: false,
                    labels: false,
                    set: set_value,
                    step:500,
                    onChange:function (values) { 
                        var values=values.split(',');
                        console.log("values-->",values);

                        $.ajax({
                             // Ajax call to getrange of phones ...  
                                url: "{% url 'createexp' %}",
                                type:'GET',
                                'data': {
                                'price_range_values':JSON.stringify(values),
                                'brandnames':JSON.stringify(brand_set_dict[active_button])
                                // 'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                success: function(data){
                                console.log("data",data);// location.reload();
                                $('#mobile_catalog_div').empty();                            
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                    // if (i%3===0 && i!==0){
                                    //     console.log("asd",i)
                                    //     var hr=document.createElement('hr');
                                    //     lps.append(hr); 
                                    //     var rtc=document.createElement('DIV');
                                    //     rtc.setAttribute("class","row text-center");
                                    //     lps.append(rtc);
                                      
                                    // }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=data['price_range_values'];

                                    if (slider_set_dict[active_button]===undefined){
                                        slider_set_dict[active_button]=[]
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }else{
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }
                                    // console.log('slider_set_dict',slider_set_dict)
                                    if (phoneset_dic[active_button]===undefined    ){
                                        phoneset_dic[active_button]=[];

                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager);
                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize:9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();
                            }
                 });         
             }
        });

    }
   
      
}
function phone_sidebarHtmlPop(){
        var expphonelist_div=document.getElementById('expphonelist_div');
        var main_row_div=document.createElement("div");
        main_row_div.setAttribute("class","row");
        expphonelist_div.append(main_row_div);

        var main_col_div=document.createElement('div');
        main_col_div.setAttribute('class','col-md-12');
        main_col_div.id=active_button+"unq";

        main_row_div.append(main_col_div);
        var h_div=document.createElement("div");
        var span=document.createElement("span");
        span.setAttribute('class',"exp_phonelist_span_h");

        span.innerHTML=active_button;
        // h_div.id=key;
        // h_div.innerHTML=key;
        h_div.append(span);
        // h_div.innerHTML=active_button;

        main_col_div.append(h_div);

        for (var i in phonename_dic[active_button]){
            var row_div=document.createElement("div");
            row_div.setAttribute("class","row");
            var col_div=document.createElement('div');
            col_div.setAttribute('class','col-md-12');
            main_col_div.append(row_div);
            row_div.append(col_div);
            
            if(phonename_dic[active_button].length===0){
                var span_phname=document.createElement('span');
                        span_phname.setAttribute("class","span_phname");
                        span_phname.innerHTML=phonename_dic[active_button][i]

                        col_div.append(span_phname);
                // col_div.append(phonename_dic[active_button]);
            }
            else{
                var span_phname=document.createElement('span');
                        span_phname.setAttribute("class","span_phname");
                        span_phname.innerHTML=phonename_dic[active_button][i]

                        col_div.append(span_phname);
                // col_div.append(phonename_dic[active_button][i]);
            }
        }
                        
        for (var key in phonename_dic){

            if (key!==active_button){
                if (phonename_dic[key]===undefined){
                    phonename_dic[key]=[]

                }
                var main_col_div=document.createElement('div');
                main_col_div.setAttribute('class','col-md-12');
                main_col_div.id=active_button+"unq";
                main_row_div.append(main_col_div);
                var h_div=document.createElement("div");
                // h_div.id=key;
                // h_div.innerHTML=key;
                var span=document.createElement("span");
                span.setAttribute('class',"exp_phonelist_span_h");

                span.innerHTML=key;
                h_div.append(span);
                main_col_div.append(h_div);

                    for (var i in phonename_dic[key]){
                        var row_div=document.createElement("div");
                        row_div.setAttribute("class","row");
                        var col_div=document.createElement('div');
                        col_div.setAttribute('class','col-md-12');
                        main_col_div.append(row_div);
                        row_div.append(col_div);
                                if(phonename_dic[key].length===0){
                                    col_div.append(phonename_dic[key]);
                                }
                                else{
                                    col_div.append(phonename_dic[key][i]);
                                }
                        }

                    }
                else{
                    console.log("Match")
                }
        }
}
// fetch data from server against the experiment underconstruction and see if there is any mobiles present. 
//  NO NEED FOR THIS NOW, REMOVE IN Future,
function populateExpPhones(){
    $.ajax({
        type: 'GET',
        dataType: "json",
        'data': {
            'custom_exp_id':custom_exp_id,
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        url: "{% url 'get_selectedadmin_phones' %}",
            success: function(data){
                var phns=data['cellphones'];
                // global_phones_exp_phones=phns
                // console.log("gbphones",phns)
                // console.log("phns",phns);
                var lpd=document.getElementById('expphonelist_div');
                for (p in phns){
                    console.log("Mobile name",phns[p].Mobile_Name)
                    var div_row=document.createElement('div');
                    div_row.setAttribute('class','row')
                    div_row.id=phns[p].id+"-catrow"
                    global_phones_exp_phones.push(phns[p].id);
                    $('input:checkbox[id^='+phns[p].id+"cat"+']:not(:checked)').prop('checked',true);
                    lpd.append(div_row);
                    var div_col_md_6_1=document.createElement('DIV');
                    div_col_md_6_1.setAttribute('class','col-md-6');
                    div_col_md_6_1.innerHTML=phns[p].Mobile_Name
                    div_row.append(div_col_md_6_1);
                    var div_col_md_6_2=document.createElement('div');
                    div_col_md_6_2.setAttribute('class','col-md-6');
                    var del_button=document.createElement('button');
                    del_button.textContent="Delete";
                    del_button.setAttribute('onclick','delExpPhone($(this).parent().parent())')
                    div_col_md_6_2.append(del_button);
                    div_row.append(div_col_md_6_2);
                }

                    alert(data['data']);
                
            }
        
        }); 
}
function delExpPhone(element){
    var mob_id=$(element).attr('id');
    split_id=mob_id.split('-')
    console.log("mob_id",split_id[0]);
    mob_id=split_id[0]
    $.ajax({
        type: 'POST',
        dataType: "json",
        'data': {
        'mobiledata': JSON.stringify(mob_id),
        'custom_exp_id':custom_exp_id,
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        // the ajax call is sent to subdetails url name in the post function.  
        url: "{% url 'remove_selected_admin_phones' %}",
            success: function(data){
                $('input:checkbox[id^='+mob_id+"cat"+']:checked').prop("checked", false);
                alert(data['data']);

                var index = global_phones_exp_phones.indexOf(parseInt(mob_id));
                    if (index > -1) {
                    global_phones_exp_phones.splice(index, 1);
                        }
                console.log("global_phones_exp_phones_delPhones_remove",global_phones_exp_phones)

            }
        
        }); 
    $(element).remove()
}
function expPhone_UpdataList(element){
        var lpd=document.getElementById('expphonelist_div');
        var div_row=document.createElement('div');
        div_row.setAttribute('class','row')
    //  div_row.id=element.value
        global_phones_exp_phones.push(parseInt(element.value))
        console.log("global_phones_exp_phones_updatelist",global_phones_exp_phones)

        div_row.id=element.value+"-catrow"
        lpd.append(div_row);
        var div_col_md_6_1=document.createElement('DIV');
        div_col_md_6_1.setAttribute('class','col-md-6');
        //// IN FUTURE KEEP THIS PART IN CHECK>>
        var name=element.name.split('-')
        console.log("ele name",name[1]);
        div_col_md_6_1.innerHTML=name[1];
        div_row.append(div_col_md_6_1);
        var div_col_md_6_2=document.createElement('div');
        div_col_md_6_2.setAttribute('class','col-md-6');
        var del_button=document.createElement('button');
        del_button.textContent="Delete";
        del_button.setAttribute('onclick','delExpPhone($(this).parent().parent())')
        div_col_md_6_2.append(del_button);
        div_row.append(div_col_md_6_2);

}

var phoneset_dic={}
var lista=[]
var listb=[]
var phonename_dic={}
function toggleCheckbox(element){
    // check the active set 
    // create a key with active set name. having an empty list. 
    // if the dict already contains the key get the list and append it with the new mob element
    // else add the mob in a list and put against that specific key. 

    var setphonelist=[];
    console.log("Element",element.name);
    var mob_id=parseInt(element.value);
    // On toggle check pass the element to an exp_phone list for updation. 
    
    if (element.checked == true){
        // on checking the mobile simply save the data in a dictionary. 
        // setphonelist.push(mob_id)
        
        console.log("dictxd",phoneset_dic)
        if (active_button in  phoneset_dic){
            phoneset_dic[active_button].push(mob_id)
        }else{

            phoneset_dic[active_button]=[]
            phoneset_dic[active_button].push(mob_id)
        }
        console.log("phoneset_dic",phoneset_dic)
        
        $.ajax({
        type: 'POST',
        dataType: "json",
        'data': {
        'mobile_id': mob_id,
        'csrfmiddlewaretoken': '{{ csrf_token }}',
        },
        // the ajax call is sent to subdetails url name in the post function.  
        url: "{% url 'retspecmobilephone' %}",
            success: function(data){
                if (active_button in  phonename_dic){
                    phonename_dic[active_button].push(data['phone'])
                    $('#expphonelist_div').empty();
                    var expphonelist_div=document.getElementById('expphonelist_div');
                    var main_row_div=document.createElement("div");
                    main_row_div.setAttribute("class","row");
                    expphonelist_div.append(main_row_div);

                    var main_col_div=document.createElement('div');
                    main_col_div.setAttribute('class','col-md-12');
                    main_col_div.id=active_button+"unq";

                    main_row_div.append(main_col_div);
                    var h_div=document.createElement("div");
                    var span=document.createElement("span");
                    span.setAttribute('class',"exp_phonelist_span_h");

                    span.innerHTML=active_button;
                    h_div.append(span);
                    // h_div.innerHTML=active_button;
                    main_col_div.append(h_div);

                    for (var i in phonename_dic[active_button]){
                        var row_div=document.createElement("div");
                        row_div.setAttribute("class","row");
                        var col_div=document.createElement('div');
                        col_div.setAttribute('class','col-md-12');
                        main_col_div.append(row_div);
                        row_div.append(col_div);
                        var span_phname=document.createElement('span');
                        span_phname.setAttribute("class","span_phname");
                        span_phname.innerHTML=phonename_dic[active_button][i]

                        col_div.append(span_phname);
                    }
                    
                    for (var key in phonename_dic){
                        

                        if (key!==active_button){
                            if (phonename_dic[key]===undefined){
                                phonename_dic[key]=[]

                            }
                            var main_col_div=document.createElement('div');
                            main_col_div.setAttribute('class','col-md-12');
                            main_col_div.id=key;
                            main_row_div.append(main_col_div);
                            var h_div=document.createElement("div");
                            // h_div.id=key;
                            // h_div.innerHTML=key;
                            var span=document.createElement("span");
                            span.setAttribute('class',"exp_phonelist_span_h");

                            span.innerHTML=key;
                            h_div.append(span);
                            
                            main_col_div.append(h_div);

                            for (var i in phonename_dic[key]){
                                var row_div=document.createElement("div");
                                row_div.setAttribute("class","row");
                                var col_div=document.createElement('div');
                                col_div.setAttribute('class','col-md-12');
                                main_col_div.append(row_div);
                                row_div.append(col_div);
                                if(phonename_dic[key].length===0){
                                    col_div.append(phonename_dic[key]);
                                }
                                else{
                                    col_div.append(phonename_dic[key][i]);
                                }
                            }
                        }else{
                            console.log("Match")
                        }
                    }
                    // var expphonelist_div=document.getElementById('expphonelist_div');
                    // var row_div=document.createElement("div");
                    // row_div.setAttribute("class","row");
                    // var col_div=document.createElement('div');
                    // col_div.setAttribute('class','col-md-12');
                    // row_div.append(col_div);
                    // expphonelist_div.append(row_div);
                    // col_div.append(data['phone']);
                    // $('#expphonelist_div').append(data['phone'])

                    }else{

                    phonename_dic[active_button]=[]
                    phonename_dic[active_button].push(data['phone'])
                    $('#expphonelist_div').empty();
                    var expphonelist_div=document.getElementById('expphonelist_div');
                    var main_row_div=document.createElement("div");
                    main_row_div.setAttribute("class","row");
                    expphonelist_div.append(main_row_div);

                    var main_col_div=document.createElement('div');
                    main_col_div.setAttribute('class','col-md-12');
                    main_col_div.id=active_button+"unq"

                    main_row_div.append(main_col_div);
                    var h_div=document.createElement("div");
                    // h_div.id=active_button;
                    // h_div.innerHTML=active_button;
                    var span=document.createElement("span");
                    span.setAttribute('class',"exp_phonelist_span_h");

                    span.innerHTML=active_button;
                    h_div.append(span);

                    main_col_div.append(h_div);

                    for (var i in phonename_dic[active_button]){
                        var row_div=document.createElement("div");
                        row_div.setAttribute("class","row");
                        var col_div=document.createElement('div');
                        col_div.setAttribute('class','col-md-12');
                        main_col_div.append(row_div);
                        row_div.append(col_div);
                        
                        var span_phname=document.createElement('span');
                        span_phname.setAttribute("class","span_phname");
                        span_phname.innerHTML=phonename_dic[active_button][i]

                        col_div.append(span_phname);
                    }
                    
                    for (var key in phonename_dic){

                        if (key!==active_button){
                            if (phonename_dic[key]===undefined){
                                phonename_dic[key]=[]

                            }
                            var main_col_div=document.createElement('div');
                            main_col_div.setAttribute('class','col-md-12');
                            main_col_div.id=key+"unq";
                            main_row_div.append(main_col_div);
                            var h_div=document.createElement("div");
                            
                            // h_div.innerHTML=key;
                            var span=document.createElement("span");
                            span.setAttribute('class',"exp_phonelist_span_h");

                            span.innerHTML=key;
                            h_div.append(span);
                            main_col_div.append(h_div);

                            for (var i in phonename_dic[key]){
                                var row_div=document.createElement("div");
                                row_div.setAttribute("class","row");
                                var col_div=document.createElement('div');
                                col_div.setAttribute('class','col-md-12');
                                main_col_div.append(row_div);
                                row_div.append(col_div);
                                if(phonename_dic[key].length===0){
                                    col_div.append(phonename_dic[key]);
                                }
                                else{
                                    col_div.append(phonename_dic[key][i]);
                                }
                            }
                        }else{
                            console.log("Match")
                        }
                    }
                    

                    // $('#expphonelist_div').append(data['phone'])

                }
                console.log("phonename_dic--#=>>",phonename_dic)

                console.log("PHONE DATA--#=>>",data['phone'])
            }
        
        }); 

        
    } 
    else { 
        //on unchecking remove the mobile from the list of phoneset_dic
        console.log("dictxd",phoneset_dic)
        if (active_button in  phoneset_dic){
            var list= phoneset_dic[active_button];
            var namelist=phonename_dic[active_button];
            ind=list.indexOf(mob_id),1;
            namelist.splice(ind,1);

            list.splice(list.indexOf(mob_id),1);
            console.log("namelist",namelist)
            console.log("list",list)
            if (list.length===0){
                // delete phoneset_dic[active_button];
                // delete phonename_dic[active_button];
                // var col_div=document.getElementById(active_button+"unq");
                // col_div.parentNode.removeChild(col_div);

                if ($('#backbutton_id').text()==="Back"){
                    $(element).parent().parent().remove();
                }
                $('#expphonelist_div').empty();

                console.log("after removing phoneset_dic",phoneset_dic)
            }else{
            phoneset_dic[active_button]=list;
            phonename_dic[active_button]=namelist;
            $('#expphonelist_div').empty();
            var expphonelist_div=document.getElementById('expphonelist_div');
            var main_row_div=document.createElement("div");
            main_row_div.setAttribute("class","row");
            expphonelist_div.append(main_row_div);

            var main_col_div=document.createElement('div');
            main_col_div.setAttribute('class','col-md-12');
            main_col_div.id=active_button+"unq"

            main_row_div.append(main_col_div);
            var h_div=document.createElement("div");
            // h_div.innerHTML=active_button;
            var span=document.createElement("span");
            span.setAttribute('class',"exp_phonelist_span_h");

            span.innerHTML=active_button;
            h_div.append(span);
            main_col_div.append(h_div);
            for (var i in phonename_dic[active_button]){
                var row_div=document.createElement("div");
                row_div.setAttribute("class","row");
                var col_div=document.createElement('div');
                col_div.setAttribute('class','col-md-12');
                main_col_div.append(row_div);
                row_div.append(col_div);
                var span_phname=document.createElement('span');
                        span_phname.setAttribute("class","span_phname");
                        span_phname.innerHTML=phonename_dic[active_button][i]

                        col_div.append(span_phname);
                // col_div.append(phonename_dic[active_button][i]);
            }
                    
                    for (var key in phonename_dic){

                        if (key!==active_button){
                            if (phonename_dic[key]===undefined){
                                phonename_dic[key]=[]

                            }
                            var main_col_div=document.createElement('div');
                            main_col_div.setAttribute('class','col-md-12');
                            main_col_div.id=key+"unq"
                            main_row_div.append(main_col_div);
                            var h_div=document.createElement("div");
                            var span=document.createElement("span");
                            span.setAttribute('class',"exp_phonelist_span_h");
                            span.innerHTML=key;
                            // h_div.id=key;
                            // h_div.innerHTML=key;
                            h_div.append(span);
                            main_col_div.append(h_div);

                            for (var i in phonename_dic[key]){
                                var row_div=document.createElement("div");
                                row_div.setAttribute("class","row");
                                var col_div=document.createElement('div');
                                col_div.setAttribute('class','col-md-12');
                                main_col_div.append(row_div);
                                row_div.append(col_div);
                                if(phonename_dic[key].length===0){
                                    col_div.append(phonename_dic[key]);
                                }
                                else{
                                    col_div.append(phonename_dic[key][i]);
                                }
                            }
                        }else{
                            console.log("Match")
                        }
                    }
                    
            // $('#expphonelist_div').append(phonename_dic[active_button])
            console.log("<<phonename_dic",phonename_dic)
            if ($('#backbutton_id').text()==="Back"){
                    $(element).parent().parent().remove();

                }

            console.log("after removing one element from list",phoneset_dic);
            }
        }    

    }
    
    
}

    </script>
<script>
  /* Global Variables */

    var crit_order_dict={};
    var crit_hide_dict={};
    var active_co="CO.1";
    var feat_to_disp=[];
    var feat_to_hide=[];
    var default_crit_show_disp=[];
    var default_crit_hide_disp=[];
    var mandatory_list=[];
    var crit_flag="false";
    var default_crit_show_dict={};
    var default_crit_hide_dict={};
    var co_pruned_empty_flag="true";
    var co_feature_active="C.Full";
    var co_feature_active_button="C.Full"
    var cdm_crit_show_dict={};
    var cdm_crit_hide_dict={};
    prune_empty_flag="true";
    cdm_full_btn_on="true";
    var static_default_crit_show_dict={};
    var static_default_crit_hide_dict={};
    var def_cdm_passed="false";
    var current_save_state=""
    ///////////////////////////////////////////////////////////
    var cataloglist=[];
function saveCatalogCrit_cdm_on_co_off(){
    var num=$('#input_num_field_catalog_crit').val();
   
   var ul=document.createElement("ul")
   cataloglist=[];
   for (i=0;i<num;i++){
       cataloglist.push(default_crit_show_dict['cdm'][i]);
       var li=document.createElement("li");
       li.innerHTML=default_crit_show_dict['cdm'][i]
       ul.append(li)
   }
   console.log("Catalog List",cataloglist)
   $("#catalog_crit_disp_col").empty();

   $("#catalog_crit_disp_col").append(ul);
}
function saveCatalogCrit_cdm_off_co_on(){
   var num=$('#input_num_field_catalog_crit').val();
   var ul=document.createElement("ul")
   cataloglist=[];
   for (i=0;i<num;i++){
       cataloglist.push(crit_order_dict["CO.1_Cdm.Def"][i]);
       var li=document.createElement("li");
       li.innerHTML=crit_order_dict["CO.1_Cdm.Def"][i]
       ul.append(li)
   }
   console.log("Catalog List",cataloglist)
   $("#catalog_crit_disp_col").empty();

   $("#catalog_crit_disp_col").append(ul);
}
function saveCatalogCrit_cdm_on_co_on(){
    var num=$('#input_num_field_catalog_crit').val();
   
   var ul=document.createElement("ul")
   cataloglist=[];
   for (i=0;i<num;i++){
       cataloglist.push(default_crit_show_dict['C.Full'][i]);
       var li=document.createElement("li");
       li.innerHTML=default_crit_show_dict['C.Full'][i]
       ul.append(li)
   }
   console.log("Catalog List",cataloglist)
   $("#catalog_crit_disp_col").empty();

   $("#catalog_crit_disp_col").append(ul);
}
function saveCatalogCrit(){
    var num=$('#input_num_field_catalog_crit').val();
    var ul=document.createElement("ul")
    cataloglist=[];
    for (i=0;i<num;i++){
        cataloglist.push(default_crit_show_dict['default'][i]);
        var li=document.createElement("li");
        li.innerHTML=default_crit_show_dict['default'][i]
        ul.append(li)
    }
    console.log("Catalog List",cataloglist)
    $("#catalog_crit_disp_col").empty();

    $("#catalog_crit_disp_col").append(ul);

}
function def_cdm_co_on_HtmlSetup(){

        $("#ol4").show();
        if (dict_not_empty_flag==="false"){
           
            if ( $('.breadcrumb li').length!==1 ){

        
                    var breadcrumb_ol=document.getElementById("ol4");
                    // $('.breadcrumb').append('<li class="breadcrumb-item active"><a href="#" onclick="defaultBreadCrumbActivateFunc($(this).parent())">Set Def Crit Order</a></li>"')
                    var  lit=document.createElement("li");
                    lit.setAttribute("class","breadcrumb-item bdcrumb_active");
                    breadcrumb_ol.append(lit);
                    var a=document.createElement("a");
                    a.setAttribute("href","#");
                    a.setAttribute("onclick","def_cdm_co_on_BreadCrumbActivateFunc($(this).parent())");
                    a.setAttribute("style","color:white")
                    a.innerHTML="Set Default CDM";
                    lit.append(a);  
            }
        }
        HideALL();

        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#order_criteria_div").show();

        $("#catalog_crit_sel").empty();
        
        var catalog_crit_sel=document.getElementById("catalog_crit_sel")
        var catalog_crit_sel_row_div=document.createElement("div")
        catalog_crit_sel.append(catalog_crit_sel_row_div)
        catalog_crit_sel_row_div.setAttribute("class","row")
        var col=document.createElement("div");
        col.setAttribute("class","col");
        catalog_crit_sel_row_div.append(col);
        var p_ele=document.createElement("p");
        p_ele.innerHTML="Catalog Criteria"
        col.append(p_ele);
        var col=document.createElement("div");
        col.setAttribute("class","col")

        catalog_crit_sel_row_div.append(col);
        var  input_num_field_catalog_crit=document.createElement("input")
        input_num_field_catalog_crit.setAttribute("id","input_num_field_catalog_crit")
        input_num_field_catalog_crit.setAttribute("type","number")
        col.append(input_num_field_catalog_crit);
        var  save_btn_catalog_crit=document.createElement("button")
        save_btn_catalog_crit.setAttribute("id","save_btn_catalog_crit")
        save_btn_catalog_crit.setAttribute("onclick","saveCatalogCrit_cdm_off_co_on()")
        save_btn_catalog_crit.innerHTML="Save"
        col.append(save_btn_catalog_crit);
        var col=document.createElement("div");
        col.setAttribute("class","col")
        col.setAttribute("id","catalog_crit_disp_col")

        catalog_crit_sel_row_div.append(col);

        var default_criteria_div=document.getElementById("order_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        default_criteria_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row")
        container.append(heading_row_div);
        var heading_content=document.createElement("H4");
        heading_content.innerHTML="Default CDM";
          
        
        heading_row_div.append(heading_content);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="def_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_def_btn";

        back_to_main_setup_btn.setAttribute('onclick','showFeatureLvls_defautCriteria()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var save_to_main_setup_btn=document.createElement('button');
        save_to_main_setup_btn.innerHTML="NEXT";
        save_to_main_setup_btn.id="next_def_btn";

        save_to_main_setup_btn.setAttribute('onclick',"orderCriteriaHtmlSetup_Next()");
        col_md_1.append(save_to_main_setup_btn);
        if (dict_not_empty_flag==="true"){
            var shw_disp=[];
            var hide_disp=[];
           
            var feat_dsp=crit_order_dict["CO.1_Cdm.Def"]

            feat_to_disp=feat_dsp;
            var flg="true"
          
            var feat_hide=crit_hide_dict["CO.1_Cdm.Def"]
            feat_to_hide=feat_hide;
            cdm_crit_order_on_flag="false";
            var colist=block_feat_dict['CO'];
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            // for (var co in colist){
            //     crit_order_dict[colist[co]+"_Cdm.Def"]=data['shw_disp'];
            //     crit_hide_dict[colist[co]+"_Cdm.Def"]=data['hide_disp'];
            //     }
            
        }
        else{
        $.ajax({
                                url: "{% url 'defaultcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=data['feature_to_display'];
                                var flg=data['flag'];
                                mandatory_list=mand;
                                var feat_hide=data['feature_to_hide'];
                                feat_to_hide=feat_hide;
                                cdm_crit_order_on_flag="false";
                                var colist=block_feat_dict['CO'];
                                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                              
                                for (var co in colist){
                                crit_order_dict[colist[co]+"_Cdm.Def"]=data['shw_disp'];
                                crit_hide_dict[colist[co]+"_Cdm.Def"]=data['hide_disp'];
                                }
                                  

                              
                                

                            }

                        });
        }

    
        // data_obj_show=JSON.parse(JSON.stringify(default_crit_show_dict['default']));
        // data_obj_show2=JSON.parse(JSON.stringify(default_crit_show_dict['default']));

        // crit_order_dict["CO.1_Cdm.Def"]=data_obj_show;
        // crit_order_dict["CO.2_Cdm.Def"]=data_obj_show2;
        // data_obj_hide=JSON.parse(JSON.stringify(default_crit_hide_dict['default']));
        // data_obj_hide2=JSON.parse(JSON.stringify(default_crit_hide_dict['default']));
        // crit_hide_dict["CO.1_Cdm.Def"]=data_obj_hide;
        // crit_hide_dict["CO.2_Cdm.Def"]=data_obj_hide2;

        // orderCriteriaHtmlSetup("CO",dict["CO"],"true");


}
function orderCriteriaHtmlSetup_Next(){
    def_cdm_passed="true";

    orderCriteriaHtmlSetup("CO",block_feat_dict["CO"],"true");
    cdm_off_co_on_TreeView();
}
function orderCriteriaHtmlSetup(CO,CO_list,default_active){
        $("#ol4").show();

        if ( $('.breadcrumb li').length===1 ){
            var current= $('.breadcrumb').find('li.bdcrumb_active')
            var breadcrumb_ol=document.getElementById("ol4");
            var  li=document.createElement("li");
            li.setAttribute("class","breadcrumb-item");
            breadcrumb_ol.append(li);
            var a=document.createElement("a");
            a.setAttribute("href","#");
            a.setAttribute("onclick","orderCriteriaHtmlSetup()");
            a.setAttribute("style","color:white")

            a.innerHTML="Criteria Order";
            li.append(a);
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(li).prop('class', 'breadcrumb-item bdcrumb_active');
        }else{
            var current= $('.breadcrumb').find('li.bdcrumb_active');
            var current_index=$( ".breadcrumb li" ).index( current );
            var prev_element_index=current_index-1;
            var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');

        }
        
        cdm_crit_order_on_flag="true"
        // setting no of co sets. 
        var colist=CO_list;
        /* emptying and showing order criteria div */
        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        // CREATING HTML LAYOUT <-->
        var order_criteria_div=document.getElementById("order_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        container.id="co_main_container";
        order_criteria_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row")
        container.append(heading_row_div);
        var heading_content=document.createElement("H4");
        heading_content.innerHTML="Active CO";
        heading_row_div.append(heading_content);
        var co_sel_list_row_div=document.createElement("div");
        co_sel_list_row_div.setAttribute("class","row");
        co_sel_list_row_div.setAttribute("id","co_sel_list_row_div");
        container.append(co_sel_list_row_div);

        var col_1=document.createElement("div");
        col_1.setAttribute("class","col");
        co_sel_list_row_div.append(col_1);
        
        var col_2=document.createElement("div");
        col_2.setAttribute("class","col");
        co_sel_list_row_div.append(col_2);

        var col_3=document.createElement("div");
        col_3.setAttribute("class","col");
        co_sel_list_row_div.append(col_3);

        var select_div=document.createElement('div');
        select_div.setAttribute('id','select_div');
        select_div.setAttribute('style', 'display: inline-block;');

        col_2.append(select_div);
        var div_cdm=document.createElement("div")
        if (default_active==="true"){
            console.log("DEFAULT")
        }
        
        product_Section(); 
// -------------------------------------------------------------------------------------------------------------------------------------------->>>
    /*
            LAYOUT CODE FINISHED!!!
    */
// --------------------------------------------------------------------------------------------------------------------------------------------->>>
      
        get_data_Ajax_Co(colist);
        
        $("#order_criteria_div").show();

    }
function product_Section(){
        var container=document.getElementById("co_main_container")
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="main_row_co";
        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);

        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.setAttribute('id','back_co_btn')

        back_to_main_setup_btn.setAttribute('onclick','showSetDef_CO_ON()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);

        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        // h2.innerHTML="Recent  Hidden Features";

        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        // if default true
        if(default_active==="true"){
            var save_to_main_setup_btn=document.createElement('button');
            save_to_main_setup_btn.innerHTML="Save";
            save_to_main_setup_btn.id="SAVE_CO_BTN";

            save_to_main_setup_btn.setAttribute('onclick',"saveOrderSet()");
            col_md_1.append(save_to_main_setup_btn);

        }
    
    


    }
function get_data_Ajax_Co(colist){
        // ajax call to get feature_to_display, feature_to_hide
        colist=block_feat_dict["CO"]
        // if (default_crit_show_dict["Cdm.Def"]!==undefined && default_crit_hide_dict["Cdm.Def"]!==undefined){
          if (def_cdm_passed==="true")  {
            $('#select_div').empty();
            var select_div=document.getElementById('select_div');
            var toggle_btn_row_div=document.createElement('div');
            toggle_btn_row_div.setAttribute("class","row");
            select_div.append(toggle_btn_row_div);
            var col_md_12=document.createElement('div');
            col_md_12.setAttribute('class','col-md-9 btn-group');
            col_md_12.id="set_button_cdm_off_co_on"
            toggle_btn_row_div.append(col_md_12);
            colist=block_feat_dict["CO"];
            for (var i=0;i<colist.length;i++){
                var button=document.createElement('button')
                button.id=colist[i]+"btn"
                button.innerHTML=colist[i];
                button.value=colist[i];
                button.setAttribute("onclick","selChangeFunc($(this))")
                if (i===0){
                    var active_b=button
                }
                $('#set_button_cdm_off_co_on').append(button)
            }
            document.getElementById("CO.1btn").style.backgroundColor = "#94000e"

















            // var select=document.createElement('select');
            // select.setAttribute('id', 'sel_options');
            // select.setAttribute('onchange',"selChangeFunc($(this))")
            // for (var i=0;i<colist.length;i++){
            //                 var option=document.createElement('option');
            //                 option.value=colist[i];
            //                 option.text=colist[i];
            //                 select.append(option);
            // }
            // $('#select_div').empty();
            // $('#select_div').append(select);   
            var shw_disp=[];
            var hide_disp=[];
            var feat_dsp=crit_order_dict["CO.1_Cdm.Def"];
            console.log("feat_dsp",feat_dsp)
            feat_to_disp=feat_dsp;
            var feat_hide=crit_hide_dict["CO.1_Cdm.Def"];
            console.log("feat_hide",feat_hide);
            var flg="true";
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
             
            $('ul').sortable({
                        axis: 'y',
                        stop: function (event, ui) {
                        var data = $(this).sortable('serialize').split("&");
                        var arr=[];
                        for (var key in data)
                        {   
                            arr.push(data[key].split("=")[0].replace('[]',''));
                        }
                        console.log("arr",arr)
                        console.log("crit_order_dict-->",crit_order_dict)

                        console.log("jason string",JSON.stringify(arr))

                        // $('span').text(data);
                        if (default_active==="true"){
                            if (crit_order_dict[active_co+"_Cdm.Def"]===undefined){
                            crit_order_dict[active_co+"_Cdm.Def"]=[]
                            }
                            else{
                                crit_order_dict[active_co+"_Cdm.Def"]=arr;
                                crit_hide_dict[active_co+"_Cdm.Def"]=hide_disp;
                                
                                console.log("crit_order_dict-",crit_order_dict)
                                console.log("crit_hide_dict-",crit_hide_dict);
                            }
                        }
                        
                        cdm_off_co_on_TreeView();

                        }
                    });
                    cdm_off_co_on_TreeView();

        }   
        else {
        $.ajax({
                    url: "{% url 'ordercriteriasetup' %}",
                    type:'GET',
                    'data': {
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                    },
                    dataType: "json",
                    
                    success: function(data){
                    var inputdata =colist
                    var select=document.createElement('select');
                    select.setAttribute('id', 'sel_options');

                    select.setAttribute('onchange',"selChangeFunc($(this))")
                    for (var i=0;i<inputdata.length;i++){
                            var option=document.createElement('option');
                            option.value=inputdata[i];
                            option.text=inputdata[i];
                            select.append(option);
                    }
                    $('#select_div').empty();
                    $('#select_div').append(select);   
                    console.log("data['feature_to_display'];",data['feature_to_display'])
                    var shw_disp=[];
                    var hide_disp=[];
                    if (data["co_set_flag_length"]==="one"){
                        var mand=data['mandatory'];
                        var feat_dsp=data['feature_to_display'];
                        feat_to_disp=data['feature_to_display'];
                        var feat_hide=data['feature_to_hide'];
                        feat_to_hide=data['feature_to_hide'];
                        var flg=data['flag'];
                        console.log("Flag",flg);
                        default_crit_show_disp=data['feature_to_display'];
                        default_crit_hide_disp=data['feature_to_hide'];
                        
                        mandatory_list=mand;
                        default_crit_show_dict['Cdm.Def']=default_crit_show_disp;
                        default_crit_hide_dict["Cdm.Def"]=default_crit_hide_disp;
                        data=htmlF(shw_disp,hide_disp,mand,feat_dsp,feat_hide,flg)
                        if(default_active==="true"){
                            for (var co in colist){
                            crit_order_dict[colist[co]+"_Cdm.Def"]=data['shw_disp'];
                            crit_hide_dict[colist[co]+"_Cdm.Def"]=data['hide_disp'];
                            }
                        }
                    }
                    else{ 
                        var mand=data['mandatory'];
                        co_set_show_dict=JSON.parse(data['co_set_show_dict'])
                        co_set_hide_dict=JSON.parse(data['co_set_hide_dict'])

                        var feat_dsp=co_set_show_dict['CO.1'];
                        feat_to_disp=feat_dsp;
                        var feat_hide=co_set_hide_dict["CO.1"];
                        feat_to_hide=feat_hide;
                        var flg=data['flag'];
                        console.log("Flag",flg);
                        default_crit_show_disp=feat_to_disp;
                        default_crit_hide_disp=feat_to_hide;
                        
                        mandatory_list=mand;
                        default_crit_show_dict['Cdm.Def']=default_crit_show_disp;
                        default_crit_hide_dict["Cdm.Def"]=default_crit_hide_disp;
                        data=htmlF(shw_disp,hide_disp,mand,feat_dsp,feat_hide,flg)
                       
                            for (var co in colist){
                            console.log("CCCC",colist[co])
                            console.log("****",co_set_show_dict["CO.1"])
                            crit_order_dict[colist[co]+"_Cdm.Def"]=co_set_show_dict[colist[co]];
                            crit_hide_dict[colist[co]+"_Cdm.Def"]=co_set_hide_dict[colist[co]];
                            }
                    }
                   
                   

                    

                
                    console.log("crit_order_dict-->",crit_order_dict);
                    console.log("crit_hide_dict-->",crit_hide_dict);
                     
                    console.log("default_crit_show_dict-->",default_crit_show_dict);
                    console.log("default_crit_hide_dict-->",default_crit_hide_dict);
                    
                   
                    
                    $('ul').sortable({
                        axis: 'y',
                        stop: function (event, ui) {
                        var data = $(this).sortable('serialize').split("&");
                        var arr=[];
                        for (var key in data)
                        {   
                            arr.push(data[key].split("=")[0].replace('[]',''));
                        }
                        console.log("arr",arr)
                        console.log("crit_order_dict-->",crit_order_dict)

                        console.log("jason string",JSON.stringify(arr))

                        // $('span').text(data);
                        if (default_active==="true"){
                            if (crit_order_dict[active_co+"_Cdm.Def"]===undefined){
                            crit_order_dict[active_co+"_Cdm.Def"]=[]
                            }
                            else{
                                crit_order_dict[active_co+"_Cdm.Def"]=arr;
                                crit_hide_dict[active_co+"_Cdm.Def"]=hide_disp;
                                
                                console.log("crit_order_dict-",crit_order_dict)
                                console.log("crit_hide_dict-",crit_hide_dict);
                            }
                        }
                        
                  
                        cdm_off_co_on_TreeView();
                        }
                    });
                    

                }

            });
    $("#cdm_off_co_on_tree_view_div").empty();
    cdm_off_co_on_TreeView();
        }
        
    }
    function saveOrderSet(){
        console.log("crit_order_dict",crit_order_dict);
        console.log("crit_hide_dict",crit_hide_dict);
        current_save_state="CDM_off_CO_on"
        // make an ajax call that will send the two dicts to server. 
        dummysendFeatureLevels();
        $.ajax({
                                
                                        type: 'POST',
                                        dataType: "json",
                                        'data': {
                                        'featlevels_dic': JSON.stringify(block_feat_dict,undefined,''),
                                        'crit_order_dict':JSON.stringify(crit_order_dict),
                                        'crit_hide_dict':JSON.stringify(crit_hide_dict),
                                        "final_def_blocks_to_send":JSON.stringify(final_def_blocks_to_send),

                                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                                        },
                                        
                                        url: "{% url 'ordercriteriasetup' %}",
                                        success: function(data){
                                            alert("FFF")
                                            if(exp_id===""){
                                                    exp_id = data['exp_id'];
                                                    custom_exp_id = data['custom_exp_id'];
                                                    showExpWIP()
                                                    }
                                                    if (data['block_list']!=null){
                                                        blockList = data['block_list']
                                                        table_blocks=draw_block_table(blockList)
                                                        display_blocktable(table_blocks);
                                                        window.localStorage.setItem("blockList", JSON.stringify(blockList));
                                                    }

                                                    showFeatureLvls_Active_CO();    
                                                    // not a good sol
                                                    $('#6-innercheckboxdiv').show();                               
                                        }
                                    });


    }
    function nextOrderSet(){
        co_feature_active="C.Prune";
        console.log("co_feature_active",co_feature_active);
        $("#main_row_co").remove();
        product_Section();
        get_data_Ajax_Co(['']);
        }
    function showSetDef_CO_ON(){
        var current= $('.breadcrumb').find('li.bdcrumb_active');
        var current_index=$( ".breadcrumb li" ).index( current );
        var prev_element_index=current_index-1;
        var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        dict_not_empty_flag="true";
        def_cdm_co_on_HtmlSetup();


    }
    function showFeatureLvls_Active_CO(){
        showFeatureLvls();
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#ftlvl').prop('class', 'custom_nav_btn active');


    }
    var dict_not_empty_flag="false";
    function def_cdm_co_on_BreadCrumbActivateFunc(li_element){
        console.log("li_ele",li_element);
        var current= $('.breadcrumb').find('li.bdcrumb_active')


       
        // var current=$("breadcrumb-item .active");

        // if the position of the selected element is less than the current element
        // then 1st change the active state to the selected one and remove the 
        // current element and elements after the current element. 
       
        if ($( ".breadcrumb li" ).index( li_element )<$( ".breadcrumb li" ).index( current )){
            // current.remove();
            dict_not_empty_flag="true";

            def_cdm_co_on_HtmlSetup();

        }
        else{
            orderCriteriaHtmlSetup();
        }
       
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(li_element).prop('class', 'breadcrumb-item bdcrumb_active');

    }
    function defaultBreadCrumbActivateFunc(li_element){
        console.log("li_ele",li_element);
        var current= $('.breadcrumb').find('li.bdcrumb_active')

        // var current=$("breadcrumb-item .active");

        // if the position of the selected element is less than the current element
        // then 1st change the active state to the selected one and remove the 
        // current element and elements after the current element. 
       
        if ($( ".breadcrumb li" ).index( li_element )<$( ".breadcrumb li" ).index( current )){
            // current.remove();
            dict_not_empty_flag="true";
            // defualtCriteriaHtmlSetup();
             defualtCriteriaOrderHtmlSetup();
        }
        else{
            defualtCriteriaHtmlSetup();
        }
       
      
        console.log("current", current);
        console.log("current", current.attr('class'))
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(li_element).prop('class', 'breadcrumb-item bdcrumb_active');
    }  
    function defualtCriteriaOrderHtmlSetup(){

        $("#ol1").show();
        // $('#ol1').empty();
        $("#default_tree_view_div").show();
        if (dict_not_empty_flag==="false"){
        var breadcrumb_ol=document.getElementById("ol1");
        // $('.breadcrumb').append('<li class="breadcrumb-item active"><a href="#" onclick="defaultBreadCrumbActivateFunc($(this).parent())">Set Def Crit Order</a></li>"')
        var  lit=document.createElement("li");
        lit.setAttribute("class","breadcrumb-item bdcrumb_active");
        breadcrumb_ol.append(lit);

        console.log("li",lit)
        var a=document.createElement("a");
        a.setAttribute("href","#");
        a.setAttribute("onclick","defaultBreadCrumbActivateFunc($(this).parent())");
        a.setAttribute("style","color:white")
        a.innerHTML="Set Default Criteria Order";
        lit.append(a);
        console.log("li",lit)
        }
        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#default_criteria_div").show();
        $("#catalog_crit_sel").empty();
        
        var catalog_crit_sel=document.getElementById("catalog_crit_sel")
        var catalog_crit_sel_row_div=document.createElement("div")
        catalog_crit_sel.append(catalog_crit_sel_row_div)
        catalog_crit_sel_row_div.setAttribute("class","row")
        var col=document.createElement("div");
        col.setAttribute("class","col");
        catalog_crit_sel_row_div.append(col);
        var p_ele=document.createElement("p");
        p_ele.innerHTML="Catalog Criteria"
        col.append(p_ele);
        var col=document.createElement("div");
        col.setAttribute("class","col")

        catalog_crit_sel_row_div.append(col);
        var  input_num_field_catalog_crit=document.createElement("input")
        input_num_field_catalog_crit.setAttribute("id","input_num_field_catalog_crit")
        input_num_field_catalog_crit.setAttribute("type","number")
        col.append(input_num_field_catalog_crit);
        var  save_btn_catalog_crit=document.createElement("button")
        save_btn_catalog_crit.setAttribute("id","save_btn_catalog_crit")
        save_btn_catalog_crit.setAttribute("onclick","saveCatalogCrit()")
        save_btn_catalog_crit.innerHTML="Save"
        col.append(save_btn_catalog_crit);
        var col=document.createElement("div");
        col.setAttribute("class","col")
        col.setAttribute("id","catalog_crit_disp_col")

        catalog_crit_sel_row_div.append(col);

        var default_criteria_div=document.getElementById("default_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        default_criteria_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row");
        container.append(heading_row_div);
        var heading_content=document.createElement("H5");
        heading_content.innerHTML="Set Default Criteria Order";
          
        heading_row_div.append(heading_content);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="def_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_def_btn";

        back_to_main_setup_btn.setAttribute('onclick','showFeatureLvls_defautCriteria()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        // var hiddenfeat_div=document.createElement('div');
        // col_md_5_2.append(hiddenfeat_div);
        // var h2=document.createElement('h2');
        // h2.innerHTML="Hidden Features";
        // hiddenfeat_div.append(h2);
        // var hide_feature_div=document.createElement('div');
        // hide_feature_div.setAttribute('id','hide_feature_div');
        // hiddenfeat_div.append(hide_feature_div);
        // var recenthiddenfeat_div=document.createElement('div');
        // recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        // col_md_5_2.append(recenthiddenfeat_div);
        // var h2=document.createElement('h2');
        // h2.innerHTML="Recent  Hidden Features";
        // var ul_mylist=document.createElement('ul');
        // ul_mylist.setAttribute('id','myList');
        // recenthiddenfeat_div.append(h2);
        // recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var continue_btn=document.createElement('button');
        continue_btn.innerHTML="Continue";
        continue_btn.id="count_def_btn";
        continue_btn.setAttribute('onclick',"defualtCriteriaHtmlSetup()");
        col_md_1.append(continue_btn);
        // if (default_crit_show_dict["default"]!==undefined && default_crit_hide_dict["default"]!==undefined){
        //        // alert(cdm_crit_order_on_flag)
        //     var shw_disp=[];
        //     var hide_disp=[];
        //     var feat_dsp=default_crit_show_dict["default"];
        //     feat_to_disp=feat_dsp;
        //     var feat_hide=default_crit_hide_dict["default"];
        //     var flg="true";
        //     cdm_crit_order_on_flag="true";

        //     data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)

        // }
        // else{
        if (dict_not_empty_flag==="true"){
             
                    var shw_disp=[];
                    var hide_disp=[];
                    var feat_dsp=default_crit_show_dict["default"];
                    feat_to_disp=feat_dsp;
                    var feat_hide=[];
                    var flg="true";
                    cdm_crit_order_on_flag="true";

                    data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
                    data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                    data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                    default_crit_show_dict['default']=data_obj_show;
                    // default_crit_hide_dict['default']=data_obj_hide;
                    data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
                    // data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
                    static_default_crit_show_dict['default']=data_obj_show_1;
                    // static_default_crit_hide_dict['default']=data_obj_hide_2;

                    console.log("default_crit_show_dict-->",default_crit_show_dict);
                    // console.log("default_crit_hide_dict-->",default_crit_hide_dict);
                    $('ul').sortable({
                    axis: 'y',
                    stop: function (event, ui) {
                    var data = $(this).sortable('serialize').split("&");
                    var arr=[];
                    for (var key in data)
                    {   
                        arr.push(data[key].split("=")[0].replace('[]',''));
                    }
                    console.log("arr",arr);

                    console.log("jason string",JSON.stringify(arr));

                    // $('span').text(data);
                    default_crit_show_dict["default"]=arr;
                    arr_2=JSON.parse(JSON.stringify(arr));

                    static_default_crit_show_dict['default']=arr_2;
                    $("#default_tree_view_div").empty();
                    hide_show_order_display_Default_TreeView(); 


                    // var main_treeview_list=[];
                    // var main_treeview_dict={};

                    // main_treeview_dict['name']="Default Criteria Tree View";
                    // mainchildlist=[];
                    // var defaut_criteria_order_dict={};
                    // defaut_criteria_order_dict_childlist=[];
                    // defaut_criteria_order_dict['name']='Defaut criteria order';

                    //         for (var i in static_default_crit_show_dict['default'])
                    //         {
                                
                    //             var defaut_criteria_order_child_dict={};
                    //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['default'][i];
                    //             defaut_criteria_order_child_dict['childern']=[];
                    //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                    //         }
                    // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                    // mainchildlist.push(defaut_criteria_order_dict);
                    // main_treeview_dict['children']=mainchildlist


                    // main_treeview_list.push(main_treeview_dict);
                    // var tree=main_treeview_list;
                    // //
                    // // Create tree
                    // //
                    // var t = new TreeView(tree, 'default_tree_view_div');
                    // t.expandAll(); 
                        
                    
                    
                    }
            });    

            hide_show_order_display_Default_TreeView(); 

    
        }
        else{
        $.ajax({
                                url: "{% url 'defaultcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=data['feature_to_display'];
                                var flg=data['flag'];
                                mandatory_list=mand;
                                var feat_hide=data['feature_to_hide'];
                                feat_to_hide=feat_hide;
                                cdm_crit_order_on_flag="true";
                                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                                data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                                data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                                default_crit_show_dict['default']=data_obj_show;
                                default_crit_hide_dict['default']=data_obj_hide;
                                data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
                                data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
                                static_default_crit_show_dict['default']=data_obj_show_1;
                                static_default_crit_hide_dict['default']=data_obj_hide_2;

                                console.log("default_crit_show_dict-->",default_crit_show_dict);
                                console.log("default_crit_hide_dict-->",default_crit_hide_dict);
                                $('ul').sortable({
                                axis: 'y',
                                stop: function (event, ui) {
                                var data = $(this).sortable('serialize').split("&");
                                var arr=[];
                                for (var key in data)
                                {   
                                    arr.push(data[key].split("=")[0].replace('[]',''));
                                }
                                console.log("arr",arr);

                                console.log("jason string",JSON.stringify(arr));

                                // $('span').text(data);
                                default_crit_show_dict["default"]=arr;
                                arr_2=JSON.parse(JSON.stringify(arr));

                                static_default_crit_show_dict['default']=arr_2;
                                $("#default_tree_view_div").empty();
                                hide_show_order_display_Default_TreeView(); 


                                // var main_treeview_list=[];
                                // var main_treeview_dict={};

                                // main_treeview_dict['name']="Default Criteria Tree View";
                                // mainchildlist=[];
                                // var defaut_criteria_order_dict={};
                                // defaut_criteria_order_dict_childlist=[];
                                // defaut_criteria_order_dict['name']='Defaut criteria order';

                                //         for (var i in static_default_crit_show_dict['default'])
                                //         {
                                            
                                //             var defaut_criteria_order_child_dict={};
                                //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['default'][i];
                                //             defaut_criteria_order_child_dict['childern']=[];
                                //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                //         }
                                // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                // mainchildlist.push(defaut_criteria_order_dict);
                                // main_treeview_dict['children']=mainchildlist


                                // main_treeview_list.push(main_treeview_dict);
                                // var tree=main_treeview_list;
                                // //
                                // // Create tree
                                // //
                                // var t = new TreeView(tree, 'default_tree_view_div');
                                // t.expandAll(); 

                               
                                
                                }
                        });    

                                $( "#sortable" ).enableSelection();
                                $("#default_tree_view_div").empty();
                                hide_show_order_display_Default_TreeView(); 

                                // var main_treeview_list=[];
                                // var main_treeview_dict={};

                                // main_treeview_dict['name']="Default Criteria Tree View";
                                // mainchildlist=[];
                                // var defaut_criteria_order_dict={};
                                // defaut_criteria_order_dict_childlist=[];
                                // defaut_criteria_order_dict['name']='Defaut criteria order';

                                //         for (var i in static_default_crit_show_dict['default'])
                                //         {
                                            
                                //             var defaut_criteria_order_child_dict={};
                                //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['default'][i];
                                //             defaut_criteria_order_child_dict['childern']=[];
                                //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                //         }
                                // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                // mainchildlist.push(defaut_criteria_order_dict);
                                // main_treeview_dict['children']=mainchildlist


                                // main_treeview_list.push(main_treeview_dict);
                                // var tree=main_treeview_list;
                                // //
                                // // Create tree
                                // //
                                // var t = new TreeView(tree, 'default_tree_view_div');
                                // t.expandAll(); 

                                

                        
                        }
                });
        }
    }
    function defualtCriteriaHtmlSetup(){
        $("#ol1").show();

        if ( $('.breadcrumb li').length===1 ){
            var current= $('.breadcrumb').find('li.bdcrumb_active')
            var breadcrumb_ol=document.getElementById("ol1");
            var  li=document.createElement("li");
            li.setAttribute("class","breadcrumb-item");
            breadcrumb_ol.append(li);
            var a=document.createElement("a");
            a.setAttribute("href","#");
            a.setAttribute("onclick","defaultBreadCrumbActivateFunc($(this).parent())");
            a.setAttribute("style","color:white")

            a.innerHTML="Filter Default Criteria ";
            li.append(a);
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(li).prop('class', 'breadcrumb-item bdcrumb_active');
        }else{
            var current= $('.breadcrumb').find('li.bdcrumb_active');
            var current_index=$( ".breadcrumb li" ).index( current );
            var prev_element_index=current_index-1;
            var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');

         
        }
        /* emptying and showing order criteria div */
        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#default_criteria_div").show();
        // CREATING HTML <-->
        var default_criteria_div=document.getElementById("default_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        default_criteria_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row")
        container.append(heading_row_div);
        var heading_content=document.createElement("H4");
        heading_content.innerHTML="Default CDM";
          
        
        heading_row_div.append(heading_content);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="def_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_def_btn";

        back_to_main_setup_btn.setAttribute('onclick','showDef_CDM_CO()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var save_to_main_setup_btn=document.createElement('button');
        save_to_main_setup_btn.innerHTML="Save";
        save_to_main_setup_btn.id="SAVE_def_BTN";

        save_to_main_setup_btn.setAttribute('onclick',"saveDefaultCriteriaSet()");
        col_md_1.append(save_to_main_setup_btn);

        if (default_crit_show_dict["default"]!==undefined && default_crit_hide_dict["default"]!==undefined){
           
            var shw_disp=[];
            var hide_disp=[];
            var feat_dsp=default_crit_show_dict["default"];
            feat_to_disp=feat_dsp;
            var feat_hide=default_crit_hide_dict["default"];
            var flg="true";
            cdm_crit_order_on_flag="false";

            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)


        }
        else{
            alert("MAking Ajax Call to get default data")
        $.ajax({
                                url: "{% url 'defaultcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=data['feature_to_display'];
                                var flg=data['flag'];
                                mandatory_list=mand;
                                console.log("flag",flg)
                                console.log("featTODISP^^^^",feat_to_disp)
                                var feat_hide=data['feature_to_hide'];
                                feat_to_hide=feat_hide;
                                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                                data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                                data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                                default_crit_show_dict['default']=data_obj_show;
                                default_crit_hide_dict['default']=data_obj_hide;
                                console.log("default_crit_show_dict-->",default_crit_show_dict);
                                console.log("default_crit_hide_dict-->",default_crit_hide_dict);

                              
                                

                            }

                        });
       
        }
    } 
    function saveDefaultCriteriaSet(){
            // dict['C']=['C.full'];
            // console.log("DICTO",dict);
            current_save_state="CDM_off_CO_off"
          // make an ajax call that will send full criterias that will be enabled for the experiment. 
          dummysendFeatureLevels();
          console.log("final_def_blocks_to_send",final_def_blocks_to_send)
          $.ajax({
                                
                                type: 'POST',
                                dataType: "json",
                                'data': {
                                'featlevels_dic': JSON.stringify(block_feat_dict,undefined,''),
                                "final_def_blocks_to_send":JSON.stringify(final_def_blocks_to_send),

                                'default_crit_show_dict': JSON.stringify(default_crit_show_dict,undefined,''),
                                'default_crit_hide_dict': JSON.stringify(default_crit_hide_dict,undefined,''),
                                'cataloglist':JSON.stringify(cataloglist),
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                url: "{% url 'defaultcriteriasetup' %}",
                                success: function(data){
                                    console.log(data);
                                    // checkbox_id_dict[5]=['0-innercheckbox-5'];
                                    // showcheckboxes_stored();
                                    showFeatureLvls_defautCriteria();     
                                    if(exp_id===""){
                                            exp_id = data['exp_id'];
                                            custom_exp_id = data['custom_exp_id'];
                                            showExpWIP()
                                            }
                                            if (data['block_list']!=null){
                                                blockList = data['block_list']
                                                table_blocks=draw_block_table(blockList)
                                                display_blocktable(table_blocks);
                                                window.localStorage.setItem("blockList", JSON.stringify(blockList));
                                              

                                            }
                                            // var current=$(".active");
                                            // current.prop('class',current.attr('class').replace('active',""));
                                            // $('#ftlvl').prop('class', 'custom_nav_btn active');
                                            
                                    //         alert("HERE")

                                            
                                }
          });
          hide_show_order_display_Default_TreeView(); 
    }
    function showDef_CDM_CO(){

    var current= $('.breadcrumb').find('li.bdcrumb_active');
    var current_index=$( ".breadcrumb li" ).index( current );
    var prev_element_index=current_index-1;
    var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
    current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
    $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
    dict_not_empty_flag="true";

    defualtCriteriaOrderHtmlSetup();
    }
    function showFeatureLvls_defautCriteria(){
        showFeatureLvls();
        var current=$("#def_crit_list_btn");
        current.prop('class',current.attr('class').replace('active',""));
        $('#ftlvl').prop('class', 'custom_nav_btn active');


    }
    function Cdm_on_CO_off_BreadCrumbActivateFunc(li_element){
        console.log("li_ele",li_element);
        // delete cdm_crit_show_dict['c.full'];
        // delete cdm_crit_hide_dict['c.full'];
        // delete cdm_crit_show_dict['c.prune'];
        // delete cdm_crit_hide_dict['c.prune'];



        var current= $('.breadcrumb').find('li.bdcrumb_active')
    
      
        if ($( ".breadcrumb li" ).index( li_element )<$( ".breadcrumb li" ).index( current )){
           
                    
                        // current.remove();
                        $("#cdm_on_co_off_tree_view_div").empty();
                        dict_not_empty_flag="true"
                        cdm_defaultCriteriaOrderHTMLSetup();

                    }
                    else{
                        CdmCriteriaHTMLSetup();

                    }
            
            
        
        console.log("current", current);
        console.log("current", current.attr('class'))
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(li_element).prop('class', 'breadcrumb-item bdcrumb_active');
    }
    function cdm_defaultCriteriaOrderHTMLSetup(){
        if (default_crit_show_dict['cdm']!==undefined){
            delete default_crit_show_dict['cdm'];
            delete default_crit_hide_dict['cdm'];
        }
        $("#ol2").show();
         // $('#ol2').empty();
        //  prune_empty_flag="true";
        var current_text= $('.breadcrumb').find('li.bdcrumb_active').find('a').text()
        if (dict_not_empty_flag==="false"){
            var breadcrumb_ol=document.getElementById("ol2");
            var  lit=document.createElement("li");
            lit.setAttribute("class","breadcrumb-item bdcrumb_active");
            breadcrumb_ol.append(lit);
            var a=document.createElement("a");
            a.setAttribute("href","#");
            a.setAttribute("onclick","Cdm_on_CO_off_BreadCrumbActivateFunc($(this).parent())");
            a.setAttribute("style","color:white")
            a.innerHTML="Set Default Criteria Order";
            lit.append(a);
        }
        $("#cdm_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#cdm_criteria_div").show();


        $("#catalog_crit_sel").empty();
        var catalog_crit_sel=document.getElementById("catalog_crit_sel")
        var catalog_crit_sel_row_div=document.createElement("div")
        catalog_crit_sel.append(catalog_crit_sel_row_div)
        catalog_crit_sel_row_div.setAttribute("class","row")
        var col=document.createElement("div");
        col.setAttribute("class","col");
        catalog_crit_sel_row_div.append(col);
        var p_ele=document.createElement("p");
        p_ele.innerHTML="Catalog Criteria"
        col.append(p_ele);
        var col=document.createElement("div");
        col.setAttribute("class","col")

        catalog_crit_sel_row_div.append(col);
        var  input_num_field_catalog_crit=document.createElement("input")
        input_num_field_catalog_crit.setAttribute("id","input_num_field_catalog_crit")
        input_num_field_catalog_crit.setAttribute("type","number")
        col.append(input_num_field_catalog_crit);
        var  save_btn_catalog_crit=document.createElement("button")
        save_btn_catalog_crit.setAttribute("id","save_btn_catalog_crit")
        save_btn_catalog_crit.setAttribute("onclick","saveCatalogCrit_cdm_on_co_off()")
        save_btn_catalog_crit.innerHTML="Save"
        col.append(save_btn_catalog_crit);
        var col=document.createElement("div");
        col.setAttribute("class","col")
        col.setAttribute("id","catalog_crit_disp_col")
        catalog_crit_sel_row_div.append(col);







        var cdm_criteria_div=document.getElementById("cdm_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        cdm_criteria_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row");
        container.append(heading_row_div);
        var heading_content=document.createElement("H5");
        heading_content.innerHTML="Set Default Criteria Order";
          
        heading_row_div.append(heading_content);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="def_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_def_btn";

        back_to_main_setup_btn.setAttribute('onclick','showFeatureLvls_cdm_co()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        // var hiddenfeat_div=document.createElement('div');
        // col_md_5_2.append(hiddenfeat_div);
        // var h2=document.createElement('h2');
        // h2.innerHTML="Hidden Features";
        // hiddenfeat_div.append(h2);
        // var hide_feature_div=document.createElement('div');
        // hide_feature_div.setAttribute('id','hide_feature_div');
        // hiddenfeat_div.append(hide_feature_div);
        // var recenthiddenfeat_div=document.createElement('div');
        // recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        // col_md_5_2.append(recenthiddenfeat_div);
        // var h2=document.createElement('h2');
        // h2.innerHTML="Recent  Hidden Features";
        // var ul_mylist=document.createElement('ul');
        // ul_mylist.setAttribute('id','myList');
        // recenthiddenfeat_div.append(h2);
        // recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var continue_btn=document.createElement('button');
        continue_btn.innerHTML="Continue";
        continue_btn.id="count_def_btn";
        continue_btn.setAttribute('onclick',"Continue_CdmCriteriaHTMLSetup()");
        col_md_1.append(continue_btn);
      
        if (dict_not_empty_flag==="true"){
            var shw_disp=[];
            var hide_disp=[]
            console.log("Cdm_Crit_show",cdm_crit_show_dict)
            var feat_dsp=cdm_crit_show_dict['c.full'];
            feat_to_disp=feat_dsp;
            console.log("FEATODISPLAY",feat_dsp)
            var flg="true";
            var feat_hide=[]
            feat_to_hide=feat_hide;
            cdm_crit_order_on_flag="true";
            console.log("feat_to_disp",feat_to_disp);

            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
            default_crit_show_dict['cdm']=data_obj_show;
            // default_crit_hide_dict['cdm']=data_obj_hide;
            data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
            // data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
            static_default_crit_show_dict['cdm']=data_obj_show_1;
            // static_default_crit_hide_dict['cdm']=data_obj_hide_2;
           
                $('ul').sortable({
                axis: 'y',
                stop: function (event, ui) {
                    var data = $(this).sortable('serialize').split("&");
                    var arr=[];
                        for (var key in data)
                        {   
                            arr.push(data[key].split("=")[0].replace('[]',''));
                        }
                                
                        // $('span').text(data);
                        default_crit_show_dict["cdm"]=arr;
                        console.log("default_crit_show_dict",default_crit_show_dict);
                        arr_2=JSON.parse(JSON.stringify(arr));
                        static_default_crit_show_dict['cdm']=arr_2;
                        if(cdm_crit_show_dict['c.full']!==undefined){

                        cdm_crit_show_dict['c.full']=arr_2;
                        }
                        $("#cdm_on_co_off_tree_view_div").empty();
                        // var main_treeview_list=[];
                        // var main_treeview_dict={};

                        // main_treeview_dict['name']="Cdm On CO Off Criteria Tree View";
                        // mainchildlist=[];
                        // var defaut_criteria_order_dict={};
                        // defaut_criteria_order_dict_childlist=[];
                        // defaut_criteria_order_dict['name']='Defaut criteria order';

                        // for (var i in default_crit_show_dict['cdm'])
                        // {
                            
                        //     var defaut_criteria_order_child_dict={};
                        //     defaut_criteria_order_child_dict['name']=default_crit_show_dict['cdm'][i];
                        //     defaut_criteria_order_child_dict['childern']=[];
                        //     defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                        // }
                        // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                        // mainchildlist.push(defaut_criteria_order_dict);
                        // main_treeview_dict['children']=mainchildlist


                        // main_treeview_list.push(main_treeview_dict);
                        // var tree=main_treeview_list;
                        //
                        // Create tree
                        //
                        // var t = new TreeView(tree, 'cdm_on_co_off_tree_view_div');
                        // t.expandAll(); 
                        def_crit_cdm_on_co_off_TreeView();
                    }
                });    
                $( "#sortable" ).enableSelection();
                $("#cdm_on_co_off_tree_view_div").empty();
                def_crit_cdm_on_co_off_TreeView();

                // var main_treeview_list=[];
                // var main_treeview_dict={};

                // main_treeview_dict['name']="Cdm On CO Off Criteria Tree View";
                // mainchildlist=[];
                // var defaut_criteria_order_dict={};
                // defaut_criteria_order_dict_childlist=[];
                // defaut_criteria_order_dict['name']='Defaut criteria order';

                // for (var i in default_crit_show_dict['cdm'])
                //         {
                            
                //             var defaut_criteria_order_child_dict={};
                //             defaut_criteria_order_child_dict['name']=default_crit_show_dict['cdm'][i];
                //             defaut_criteria_order_child_dict['childern']=[];
                //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                //         }
                // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                // mainchildlist.push(defaut_criteria_order_dict);
                // main_treeview_dict['children']=mainchildlist


                //     main_treeview_list.push(main_treeview_dict);
                //     var tree=main_treeview_list;
                    //
                    // Create tree
                    //
                    // var t = new TreeView(tree, 'cdm_on_co_off_tree_view_div');
                    // t.expandAll(); 
        }

        else{
                $.ajax({
                                url: "{% url 'cdmcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=data['feature_to_display'];
                                console.log("FEATODISPLAY",feat_dsp)
                                var flg=data['flag'];
                                mandatory_list=mand;
                                var feat_hide=data['feature_to_hide'];
                                feat_to_hide=feat_hide;
                                cdm_crit_order_on_flag="true";
                                console.log("feat_to_disp",feat_to_disp);

                                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                                data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                                data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                                default_crit_show_dict['cdm']=data_obj_show;
                                default_crit_hide_dict['cdm']=data_obj_hide;
                                data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
                                data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
                                static_default_crit_show_dict['cdm']=data_obj_show_1;
                                static_default_crit_hide_dict['cdm']=data_obj_hide_2;

                                $('ul').sortable({
                                axis: 'y',
                                stop: function (event, ui) {
                                var data = $(this).sortable('serialize').split("&");
                                var arr=[];
                                for (var key in data)
                                {   
                                    arr.push(data[key].split("=")[0].replace('[]',''));
                                }
                                console.log("arr",arr);

                                console.log("jason string",JSON.stringify(arr));

                                // $('span').text(data);
                                default_crit_show_dict["cdm"]=arr;
                                console.log("default_crit_show_dict",default_crit_show_dict);
                                arr_2=JSON.parse(JSON.stringify(arr));
                                static_default_crit_show_dict['cdm']=arr_2;
                                $("#cdm_on_co_off_tree_view_div").empty();
                                var main_treeview_list=[];
                                var main_treeview_dict={};

                                main_treeview_dict['name']="Cdm On CO Off Criteria Tree View";
                                mainchildlist=[];
                                var defaut_criteria_order_dict={};
                                defaut_criteria_order_dict_childlist=[];
                                defaut_criteria_order_dict['name']='Defaut criteria order';

                                        for (var i in default_crit_show_dict['cdm'])
                                        {
                                            
                                            var defaut_criteria_order_child_dict={};
                                            defaut_criteria_order_child_dict['name']=default_crit_show_dict['cdm'][i];
                                            defaut_criteria_order_child_dict['childern']=[];
                                            defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                        }
                                defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                mainchildlist.push(defaut_criteria_order_dict);
                                main_treeview_dict['children']=mainchildlist


                                main_treeview_list.push(main_treeview_dict);
                                var tree=main_treeview_list;
                                //
                                // Create tree
                                //
                                var t = new TreeView(tree, 'cdm_on_co_off_tree_view_div');
                                t.expandAll(); 
                                }
                                });    
                                $( "#sortable" ).enableSelection()
                                $("#cdm_on_co_off_tree_view_div").empty();
                                var main_treeview_list=[];
                                var main_treeview_dict={};

                                main_treeview_dict['name']="Cdm On CO Off Criteria Tree View";
                                mainchildlist=[];
                                var defaut_criteria_order_dict={};
                                defaut_criteria_order_dict_childlist=[];
                                defaut_criteria_order_dict['name']='Defaut criteria order';

                                for (var i in default_crit_show_dict['cdm'])
                                        {
                                            
                                            var defaut_criteria_order_child_dict={};
                                            defaut_criteria_order_child_dict['name']=default_crit_show_dict['cdm'][i];
                                            defaut_criteria_order_child_dict['childern']=[];
                                            defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                        }
                                defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                mainchildlist.push(defaut_criteria_order_dict);
                                main_treeview_dict['children']=mainchildlist


                                main_treeview_list.push(main_treeview_dict);
                                var tree=main_treeview_list;
                                //
                                // Create tree
                                //
                                var t = new TreeView(tree, 'cdm_on_co_off_tree_view_div');
                                t.expandAll(); 
                            }

                        });
        }

    }
    function CdmCriteriaHTMLSetup(){
        $("#ol2").show();

        if (dict_not_empty_flag==="false"){
                if ($('.breadcrumb li').length===1 ){
                    alert("IN ")
                    var current= $('.breadcrumb').find('li.bdcrumb_active')
                    var breadcrumb_ol=document.getElementById("ol2");
                    var  li=document.createElement("li");
                    li.setAttribute("class","breadcrumb-item");
                    breadcrumb_ol.append(li);
                    var a=document.createElement("a");
                    a.setAttribute("href","#");
                    a.setAttribute("onclick","Cdm_on_CO_off_BreadCrumbActivateFunc($(this).parent())");
                    a.setAttribute("style","color:white");

                    a.innerHTML="Set C.Full and Prune Criteria ";
                    li.append(a);
                    current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                    $(li).prop('class', 'breadcrumb-item bdcrumb_active');
                }else{
                }
        }
        /* emptying and showing order criteria div */
        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#cdm_criteria_div").show();
        // CREATING HTML <-->
        cdm_full_btn_on="true";
        cdm_crit_order_on_flag="false";

        var cdm_criteria_div=document.getElementById("cdm_criteria_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        cdm_criteria_div.append(container);
      
        var toggle_btn_row_div=document.createElement('div');
        toggle_btn_row_div.setAttribute("class","row");
        container.append(toggle_btn_row_div);
        var col_md_12=document.createElement('div');
        col_md_12.setAttribute('class','col-md-9 btn-group');
        col_md_12.id="set_buttons_cdm"
        toggle_btn_row_div.append(col_md_12);
        cmd_set_list=["C.FULL","C.PRUNE"];
        for (var i=0;i<cmd_set_list.length;i++){
            var button=document.createElement('button')
            button.id=cmd_set_list[i]+"btn"
            button.innerHTML=cmd_set_list[i];
            button.setAttribute("onclick","cdm_btn_func($(this))")
            if (i===0){
                var active_b=button
            }
            $('#set_buttons_cdm').append(button)
        }
        document.getElementById("C.FULLbtn").style.backgroundColor = "#94000e"




        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="cdm_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.setAttribute('onclick','showSetDefCritOrd_Cdm()')
        back_to_main_setup_btn.id="back_cdm_btn";
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
       


        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        // var next_to_main_setup_btn=document.createElement('button');
        // next_to_main_setup_btn.innerHTML="Next";
        // next_to_main_setup_btn.id="NEXT_CDM_BTN";
        // next_to_main_setup_btn.setAttribute('onclick',"nextStepCdmCriteriaHTMLSetup()");
        // col_md_1.append(next_to_main_setup_btn);
        // if flag for c.full is active that retrieve info 
        // from cdm_crit_dict[c.full]
        if (cdm_crit_show_dict['c.full']!==undefined ){
            alert("FIRSt1 if")
            var shw_disp=[];var hide_disp=[];
            console.log("cdm_crit_show_dict['c.full']*************",cdm_crit_show_dict['c.full'])

            var feat_dsp=cdm_crit_show_dict['c.full'];
            var feat_hide=cdm_crit_hide_dict['c.full'];
            var flg="true";
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
            if ((cdm_crit_show_dict["c.full"]!==undefined || cdm_crit_hide_dict["c.full"]!==undefined)||(cdm_crit_show_dict["c.full"]!==undefined || cdm_crit_hide_dict["c.full"]!==undefined)){
                $("#full_crit_selected").show();
            }  
            default_crit_show_dict["cdm"]=data_obj_show
            default_crit_hide_dict["cdm"]=data_obj_hide
        }
        else{
          

        if (prune_empty_flag==="true" ){
            console.log("default_crit_show_dict['cdm']*************",default_crit_show_dict["cdm"])
            if (default_crit_show_dict["cdm"]!==undefined || default_crit_hide_dict["cdm"]!==undefined) {

                    var shw_disp=[];
                    var hide_disp=[];
                    var feat_dsp=default_crit_show_dict["cdm"];
                    feat_to_disp=feat_dsp;
                    var feat_hide=default_crit_hide_dict["cdm"];
                    var flg="true";
                    cdm_crit_order_on_flag="false";

                    data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
                    data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                    data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                    
                    cdm_crit_show_dict["c.full"]=data_obj_show;
                    cdm_crit_hide_dict["c.full"]=data_obj_hide;

                    default_crit_show_dict['cdm']=feat_to_disp;
                    default_crit_hide_dict["cdm"]=feat_to_hide;
                                

            }
            else{

                
                $.ajax({
                                url: "{% url 'cdmcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                mandatory_list=mand;
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=feat_dsp;
                                var feat_hide=data["feature_to_hide"];
                                feat_to_hide=feat_hide;
                               
                                var flg=data['flag'];

                                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                                
                                data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                                data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                                
                            
                                cdm_crit_show_dict["c.full"]=data_obj_show;
                                cdm_crit_hide_dict["c.full"]=data_obj_hide;

                                default_crit_show_dict['cdm']=feat_to_disp;
                                default_crit_hide_dict["cdm"]=feat_to_hide;
                               
                                console.log("default_crit_show_dict",default_crit_show_dict)

                                console.log("default_crit_hide_dict",default_crit_hide_dict)
                                                                

                            }

                        });
           
            }
        }

        else if (prune_empty_flag==="false" || default_crit_show_dict["cdm"]!==undefined && default_crit_hide_dict["cdm"]!==undefined ) {
            alert("prune flag");
            alert(prune_empty_flag);
            alert("else if1")

            var shw_disp=[];var hide_disp=[];
            var feat_dsp=cdm_crit_show_dict['c.full'];
            var feat_hide=cdm_crit_hide_dict['c.full'];
            var flg="true";
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            console.log("C>PURNE",shw_disp)
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
            if ((cdm_crit_show_dict["c.full"]!==undefined || cdm_crit_hide_dict["c.full"]!==undefined)||(cdm_crit_show_dict["c.full"]!==undefined || cdm_crit_hide_dict["c.full"]!==undefined)){
                alert("NO NEW INSERTION iN PRune")
                $("#full_crit_selected").show();
            }  
        
    }
    
        }
    
    
    def_crit_cdm_on_co_off_TreeView();
}
    function saveCdmCriteriaHTMLSetup(){  
         // make an ajax call that will send full criterias that will be enabled for the experiment. 
         current_save_state="CDM_on_CO_off";
         dummysendFeatureLevels();
          $.ajax({
                                
                                type: 'POST',
                                dataType: "json",
                                'data': {
                                'featlevels_dic': JSON.stringify(block_feat_dict,undefined,''),
                                'cdm_crit_show_dict': JSON.stringify(cdm_crit_show_dict,undefined,''),
                                'cdm_crit_hide_dict': JSON.stringify(cdm_crit_hide_dict,undefined,''),
                                'cataloglist':JSON.stringify(cataloglist),
                                "final_def_blocks_to_send":JSON.stringify(final_def_blocks_to_send),
       
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                url: "{% url 'cdmcriteriasetup' %}",
                                success: function(data){
                                    // checkbox_id_dict[5]=['0-innercheckbox-5'];
                                    // showcheckboxes_stored();
                                    
                                    if(exp_id===""){
                                            exp_id = data['exp_id'];
                                            custom_exp_id = data['custom_exp_id'];
                                            showExpWIP()
                                            }
                                    if (data['block_list']!=null){
                                        blockList = data['block_list']
                                        table_blocks=draw_block_table(blockList)
                                        display_blocktable(table_blocks);
                                        window.localStorage.setItem("blockList", JSON.stringify(blockList));
                                        

                                    }
                                    showFeatureLvls();     
                                    var current=$(".active");
                                    current.prop('class',current.attr('class').replace('active',""));
                                    $('#ftlvl').prop('class', 'custom_nav_btn active');
                                    
                                    //         alert("HERE")

                                            
                                }
          });
        //   cdm_full_btn_on="true";
        //   CdmCriteriaHTMLSetup();

    }
    function nextStepCdmCriteriaHTMLSetup(){
        cdm_full_btn_on="false";
        prune_empty_flag="false";
      


        document.getElementById("C.PRUNEbtn").style.backgroundColor = "#94000e"
        document.getElementById("C.FULLbtn").style.backgroundColor = ""

        $("#cdm_main_row_co_def").empty();

        var main_row=document.getElementById("cdm_main_row_co_def")
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_cdm_btn";
        back_to_main_setup_btn.setAttribute('onclick','CdmCriteriaHTMLSetup()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);

        var full_crit_selected=document.createElement("div");
        full_crit_selected.setAttribute("id","full_crit_selected");
        col_md_5_2.append(full_crit_selected);
        var h4=document.createElement('h4');
        h4.innerHTML="Full Selected Features";
        full_crit_selected.append(h4);
        var full_crit_sel_inner_div=document.createElement('div');
        full_crit_sel_inner_div.setAttribute('id','full_crit_sel_inner_div');
        full_crit_selected.append(full_crit_sel_inner_div)




        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var save_setup_btn=document.createElement('button');
        save_setup_btn.innerHTML="Save";
        save_setup_btn.id="SAVE_CDM_BTN";
        save_setup_btn.setAttribute('onclick',"saveCdmCriteriaHTMLSetup()");
        col_md_1.append(save_setup_btn);
        // if flag for c.full is active that retrieve info 
        // from cdm_crit_dict[c.full]
        if (cdm_full_btn_on==="true"){
        $.ajax({
                                url: "{% url 'cdmcriteriasetup' %}",
                                type:'GET',
                                'data': {
                                'csrfmiddlewaretoken': '{{ csrf_token }}',
                                },
                                dataType: "json",
                                
                                success: function(data){
                              
                                var shw_disp=[];
                                var hide_disp=[];
                                var mand=data['mandatory'];
                                mandatory_list=mand;
                                var feat_dsp=data['feature_to_display'];
                                feat_to_disp=data['feature_to_display'];
                                var flg=data['flag'];

                                console.log("flag",flg)
                                console.log("featTODISP^^^^",feat_to_disp)

                                var disp_feat_div=document.getElementById('display_feature_div');

                                /* 
                                    Creating ul and li for displaying and hidding features. 
                                */
                                var ul_sortable=document.createElement('ul');
                                ul_sortable.setAttribute('id','sortable');
                                disp_feat_div.append(ul_sortable);
                                // Loop for getting the features to display... and creating html for them. 
                                for (var i in feat_dsp){
                                var li_sortable=document.createElement('li');
                                // li_sortable.id=feat_dsp[i].feature+"_"+feat_dsp[i].position;
                                if (flg==="true"){
                                    li_sortable.id=feat_dsp[i][0]+"_"+feat_dsp[i][1];

                                }else{
                                    li_sortable.id=feat_dsp[i].criteria_name+"_"+feat_dsp[i].position;

                                }
                                ul_sortable.append(li_sortable);
                                var div_row=document.createElement('div');
                                div_row.setAttribute("class",'row');
                                li_sortable.append(div_row);    
                                var div_col_md_6_1=document.createElement('div');
                                div_col_md_6_1.setAttribute("class","col-md-6");
                                div_row.append(div_col_md_6_1);
                                var btn_btn_primary=document.createElement('p');
                                btn_btn_primary.setAttribute("class","h2_feature");
                                // btn_btn_primary.innerHTML=feat_dsp[i].feature;
                                if (flg==="true"){
                                    btn_btn_primary.innerHTML=feat_dsp[i][0];
                                }else{
                                    btn_btn_primary.innerHTML=feat_dsp[i].criteria_name;
                                }
                                // btn_btn_primary.innerHTML=feat_dsp[i].criteria_name;
                                
                                div_col_md_6_1.appendChild(btn_btn_primary);
                                var div_col_md_6_2=document.createElement('div');
                                div_col_md_6_2.setAttribute('class',"col-md-6");
                                div_row.append(div_col_md_6_2);
                                // check if i present in mandatory list. If it does dont show the hide button
                                if (flg==="true"){
                                    var fet_dsp=feat_dsp[i][0];
                                }else{
                                    var fet_dsp=feat_dsp[i].criteria_name;
                                }
                                if(mand.includes(fet_dsp)){
                                    console.log("HIDE THE HIDE buttOn")
                                }
                                else {
                                    var btn_show_hide=document.createElement('button');
                                    btn_show_hide.setAttribute("class","show_hide");
                                    btn_show_hide.setAttribute("onclick","hideFromDisplay_CDM($(this).parent().parent().parent().attr('id'))");
                                    btn_show_hide.innerHTML="Hide";
                                    div_col_md_6_2.appendChild(btn_show_hide);
                                    
                                }
                                // shw_disp.push(feat_dsp[i].feature);
                                if (flg==="true"){
                                    shw_disp.push(feat_dsp[i][0]);
                                }else{
                                    shw_disp.push(feat_dsp[i].criteria_name);
                                }

                                }
                                var feat_hide=data['feature_to_hide'];
                                feat_to_hide=data['feature_to_hide'];
                                console.log("feat-to-hide",feat_to_hide)
                                var hide_feat_div=document.getElementById('hide_feature_div');
                                var ul_hiddenfeat=document.createElement('ul');
                                ul_hiddenfeat.setAttribute("id","hiddenfeat");
                                hide_feat_div.append(ul_hiddenfeat);
                                for (var i in feat_hide){

                                    var li_hiddenfeat=document.createElement('li');
                                    // li_hiddenfeat.id=feat_hide[i].feature+"_"+feat_hide[i].position
                                if (flg==="true"){
                                        li_hiddenfeat.id=feat_hide[i]+"_"+0

                                }else{
                                    li_hiddenfeat.id=feat_hide[i].criteria_name+"_"+feat_hide[i].position

                                }

                                    ul_hiddenfeat.append(li_hiddenfeat);

                                    var div_row=document.createElement('div')
                                    div_row.setAttribute('class','row');
                                    li_hiddenfeat.append(div_row);
                                    var div_col_md_6_1=document.createElement('div');
                                    div_col_md_6_1.setAttribute('class','col-md-6');
                                    div_row.append(div_col_md_6_1);
                                    var div_col_md_6_2=document.createElement('div');
                                    div_col_md_6_2.setAttribute('class','col-md-6');
                                    div_row.append(div_col_md_6_2);
                                    var btn_btn_primary=document.createElement('btn');
                                    btn_btn_primary.setAttribute('class','btn btn-primary');
                                    // btn_btn_primary.innerHTML=feat_hide[i].feature;
                                    if (flg==="true"){
                                        btn_btn_primary.innerHTML=feat_hide[i];

                                }else{
                                        btn_btn_primary.innerHTML=feat_hide[i].criteria_name;

                                }


                                    div_col_md_6_1.append(btn_btn_primary);
                                    var btn_show_hide=document.createElement('button');
                                    btn_show_hide.setAttribute('class','show_hide');
                                    btn_show_hide.setAttribute('onclick','showToDisplay_CDM($(this).parent().parent().parent().attr("id"))');
                                    btn_show_hide.innerHTML="show";
                                    div_col_md_6_2.append(btn_show_hide);
                                    // hide_disp.push(feat_hide[i].feature)
                                      if (flg==="true"){
                                        hide_disp.push(feat_hide[i])

                                        }else{
                                            hide_disp.push(feat_hide[i].criteria_name)
                                        }

                               
                                }
                                /// add the show_disp and hide_disp to default_crit_disp....
                                cdm_crit_show_dict['c.full']=shw_disp
                                cdm_crit_hide_dict['c.full']=hide_disp

                                console.log("cdm_crit_show_dict-->",cdm_crit_show_dict);
                                console.log("cdm_crit_hide_dict-->",cdm_crit_hide_dict);

                                $('ul').sortable({
                                    axis: 'y',
                                    stop: function (event, ui) {
                                    var data = $(this).sortable('serialize').split("&");
                                    var arr=[];
                                    for (var key in data)
                                    {   
                                        arr.push(data[key].split("=")[0].replace('[]',''));
                                    }
                                    // $('span').text(data);
                                    if (cdm_crit_show_dict['c.full']===undefined){
                                        cdm_crit_show_dict['c.full']=[]
                                    }
                                    else{
                                    // add the arrays to new dictionary cdm_crit_show_dict
                                    cdm_crit_show_dict['c.full']=arr;
                                    cdm_crit_hide_dict['c.full']=hide_disp;
                                    console.log("cdm_crit_show_dict",cdm_crit_show_dict);
                                    console.log("cdm_crit_show_dict",cdm_crit_show_dict);

                                    }
                                    }
                                });
                                

                            }

                        });
        }
        else {
            var shw_disp=[];var hide_disp=[];
            var feat_dsp=cdm_crit_show_dict['c.full'];
            var feat_hide=[];
            var flg="true";
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
            cdm_crit_show_dict['c.pruned']=shw_disp;
            cdm_crit_hide_dict['c.pruned']=[];
            console.log("cdm_crit_show_dict",cdm_crit_show_dict);
            console.log("cdm_crit_hide_dict",cdm_crit_hide_dict);            
            var full_crit_sel_inner_div=document.getElementById('full_crit_sel_inner_div');
            var ul_cfull_crit=document.createElement('ul');
            ul_cfull_crit.setAttribute("id","cfull_crit");
            full_crit_sel_inner_div.append(ul_cfull_crit);
                        for (var i in feat_dsp ){
                            var li_cfull_crit=document.createElement('li');
                            li_cfull_crit.innerHTML=feat_dsp[i];
                            ul_cfull_crit.append(li_cfull_crit);
                            
                            // var div_row=document.createElement('div')
                            // div_row.setAttribute('class','row');
                            // li_cfull_crit.append(div_row);
                            // var div_col_md_6_1=document.createElement('div');
                            // div_col_md_6_1.setAttribute('class','col-md-6');
                            // div_row.append(div_col_md_6_1);
                            // var div_col_md_6_2=document.createElement('div');
                            // div_col_md_6_2.setAttribute('class','col-md-6');
                            // div_row.append(div_col_md_6_2);
                            // var btn_btn_primary=document.createElement('btn');
                            // btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                            // btn_btn_primary.innerHTML=feat_dsp[i];   
                            // div_col_md_6_1.append(btn_btn_primary);
                        
                        }  
            def_crit_cdm_on_co_off_TreeView();         
        }
    }
    function Continue_CdmCriteriaHTMLSetup (){
        if (dict_not_empty_flag==="true"){
            var current= $('.breadcrumb').find('li.bdcrumb_active');
            var current_index=$( ".breadcrumb li" ).index( current );
            var prev_element_index=current_index-1;
            var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        }
        CdmCriteriaHTMLSetup();

    }

    function cdm_btn_func(elementid){
        console.log(typeof(elementid))
      
        var element_os=$(elementid).attr('id');
      
        
        console.log("elementid",$(elementid).attr('id'))
        if(element_os==="C.FULLbtn"){
            document.getElementById("C.FULLbtn").style.backgroundColor = "#94000e"
            document.getElementById("C.PRUNEbtn").style.backgroundColor = ""
            cdm_full_btn_on="true"
            
        $("#cdm_main_row_co_def").empty();

        var main_row=document.getElementById("cdm_main_row_co_def")
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_cdm_btn";

        back_to_main_setup_btn.setAttribute('onclick','showSetDefCritOrd_Cdm()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        // var next_to_main_setup_btn=document.createElement('button');
        // next_to_main_setup_btn.innerHTML="Next";
        // next_to_main_setup_btn.id="NEXT_CDM_BTN";
        // next_to_main_setup_btn.setAttribute('onclick',"nextStepCdmCriteriaHTMLSetup()");
        // col_md_1.append(next_to_main_setup_btn);

        var shw_disp=[];var hide_disp=[];
        var feat_dsp=cdm_crit_show_dict['c.full'];
        var feat_hide=cdm_crit_hide_dict['c.full'];
        var flg="true"
        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
        def_crit_cdm_on_co_off_TreeView();


                    

                                

        }
        else if(element_os==="C.PRUNEbtn"){
                if (cdm_crit_show_dict['c.pruned']!==undefined){
                    prune_list_show=cdm_crit_show_dict['c.pruned'];
                    prune_list_hide=cdm_crit_hide_dict['c.pruned'];
                    temp_list=[];
                    temp_list2=[];
                    for (var i in cdm_crit_show_dict['c.full']){
                        if(prune_list_show.includes(cdm_crit_show_dict['c.full'][i])){
                            temp_list.push(cdm_crit_show_dict['c.full'][i])
                        }
                        else if (prune_list_hide.includes(cdm_crit_show_dict['c.full'][i])){
                            // temp_list.push(cdm_crit_show_dict['c.full'][i])
                        }
                        else{
                            temp_list2.push(cdm_crit_show_dict['c.full'][i])
                        }  
                        // cdm_crit_show_dict['c.full'].indexOf(cdm_crit_show_dict['c.full'][i])
                        
                    }
                    console.log("temp_list2",temp_list2)
                    if (temp_list2.length!==0){
                        for (var i in temp_list2){
                            temp_list.push(temp_list2[i]);

                        }
                    }
                    cdm_crit_show_dict['c.pruned']=temp_list;
                    for (  var i in cdm_crit_hide_dict['c.full']){
                        if (prune_list_hide.includes(cdm_crit_hide_dict['c.full'][i])){
                            var ind=prune_list_hide.indexOf(cdm_crit_hide_dict['c.full'][i]);
                            prune_list_hide.splice(ind,1)
                            // temp_list.push(cdm_crit_show_dict['c.full'][i])
                        }
                    }
                    cdm_crit_hide_dict['c.pruned']=prune_list_hide;
                    // if (cdm_crit_show_dict['c.full'].length!==cdm_crit_show_dict['c.prune'].length){
                    // alert("Please press NEXT TO set Pruned Criterias")
                    // return;
                    // }
                    // data_obj_show=JSON.parse(JSON.stringify(cdm_crit_show_dict['c.full']));

                    // cdm_crit_show_dict['c.prune']=data_obj_show;
                }
                else{
                    nextStepCdmCriteriaHTMLSetup();
                    // alert("Please first press NEXT TO set Pruned Criterias")
                    // return; 
                }
                
            
            
            document.getElementById("C.PRUNEbtn").style.backgroundColor = "#94000e"
            document.getElementById("C.FULLbtn").style.backgroundColor = ""

            cdm_full_btn_on="false"
            $("#cdm_main_row_co_def").empty();

            var main_row=document.getElementById("cdm_main_row_co_def")
            var col_md_1=document.createElement('div');
            col_md_1.setAttribute('class','col-md-1');
            main_row.append(col_md_1);
            var back_to_main_setup_btn=document.createElement('button');
            back_to_main_setup_btn.innerHTML="Back";
            back_to_main_setup_btn.id="back_cdm_btn";
            back_to_main_setup_btn.setAttribute('onclick','showSetDefCritOrd_Cdm()')
            col_md_1.append(back_to_main_setup_btn);
            var col_md_5=document.createElement('div');
            col_md_5.setAttribute('class','col-md-5 text-left');
            main_row.append(col_md_5);

            // var select_div=document.createElement('div');
            // select_div.setAttribute('id','select_div');
            var container_two=document.createElement('div');
            container_two.setAttribute('class','container ');
            container_two.id="product-section";
            // col_md_5.append(select_div);
            col_md_5.append(container_two);
            var disp_feat_div=document.createElement("div");
            disp_feat_div.setAttribute('id','display_feature_div');
            container_two.append(disp_feat_div);
            var col_md_5_2=document.createElement('div');
            col_md_5_2.setAttribute('class','col-md-5');
            main_row.append(col_md_5_2);
            var hiddenfeat_div=document.createElement('div');
            col_md_5_2.append(hiddenfeat_div);
            var h2=document.createElement('h5');
            h2.innerHTML="Hidden Features";
            hiddenfeat_div.append(h2);
            var hide_feature_div=document.createElement('div');
            hide_feature_div.setAttribute('id','hide_feature_div');
        
            hiddenfeat_div.append(hide_feature_div);
            var recenthiddenfeat_div=document.createElement('div');
            recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
            col_md_5_2.append(recenthiddenfeat_div);
            var h2=document.createElement('h5');
            h2.innerHTML="Recent  Hidden Features";
            var ul_mylist=document.createElement('ul');
            ul_mylist.setAttribute('id','myList');
            recenthiddenfeat_div.append(h2);
            recenthiddenfeat_div.append(ul_mylist);
            // var full_crit_selected=document.createElement("div");
            // full_crit_selected.setAttribute("id","full_crit_selected");
            // col_md_5_2.append(full_crit_selected);
            // var h4=document.createElement('h4');
            // h4.innerHTML="Full Selected Features";
            // full_crit_selected.append(h4);
            // var full_crit_sel_inner_div=document.createElement('div');
            // full_crit_sel_inner_div.setAttribute('id','full_crit_sel_inner_div');
            // full_crit_selected.append(full_crit_sel_inner_div)
            
            var full_crit_hidden=document.createElement("div");
            full_crit_hidden.setAttribute("id","full_crit_hidden");
            col_md_5_2.append(full_crit_hidden);
            var h4=document.createElement('h4');
            h4.innerHTML="Full Hidden Features";
            full_crit_hidden.append(h4);
            var full_crit_hid_inner_div=document.createElement('div');
            full_crit_hid_inner_div.setAttribute('id','full_crit_hid_inner_div');
            full_crit_hidden.append(full_crit_hid_inner_div)





            var col_md_1=document.createElement('div');
            col_md_1.setAttribute('class','col-md-1');
            main_row.append(col_md_1);
            var save_setup_btn=document.createElement('button');
            save_setup_btn.innerHTML="Save";
            save_setup_btn.setAttribute('onclick',"saveCdmCriteriaHTMLSetup()");
            save_setup_btn.id="SAVE_CDM_BTN";
            col_md_1.append(save_setup_btn);
        console.log("cdm_crit_show_diCT%%%%%%",cdm_crit_show_dict)
        console.log("cdm_crit_hide_diCT%%%%%%",cdm_crit_hide_dict)

        var shw_disp=[];var hide_disp=[];
        
        var feat_dsp=cdm_crit_show_dict['c.pruned'];
        var feat_hide=cdm_crit_hide_dict['c.pruned'];
        var flg="true";
        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
        // var full_crit_sel_inner_div=document.getElementById('full_crit_sel_inner_div');
        //     var ul_cfull_crit=document.createElement('ul');
        //     ul_cfull_crit.setAttribute("id","cfull_crit");
        //     full_crit_sel_inner_div.append(ul_cfull_crit);
        //     var crit_full_list=cdm_crit_show_dict['c.full'];
        //                 for (var i in crit_full_list ){

        //                     var li_cfull_crit=document.createElement('li');
        //                     // li_cfull_crit.innerHTML=crit_full_list[i];
        //                     ul_cfull_crit.append(li_cfull_crit);
        //                     var btn_btn_primary=document.createElement('button');
        //                     btn_btn_primary.setAttribute("class","sortable_custom_show_btns");
        //                     btn_btn_primary.innerHTML=crit_full_list[i];;
        //                     btn_btn_primary.title=crit_full_list[i];
        //                     li_cfull_crit.append(btn_btn_primary);

        //                 }  
        var full_crit_hid_inner_div=document.getElementById('full_crit_hid_inner_div');
            var ul_cfull_crit=document.createElement('ul');
            ul_cfull_crit.setAttribute("id","cfull_crit_hidden");
            full_crit_hid_inner_div.append(ul_cfull_crit);
            var crit_full_list=cdm_crit_hide_dict['c.full'];
                        for (var i in crit_full_list ){
                            var li_cfull_crit=document.createElement('li');
                            // li_cfull_crit.innerHTML=crit_full_list[i];
                            ul_cfull_crit.append(li_cfull_crit);
                            var btn_btn_primary=document.createElement('button');
                            btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                            btn_btn_primary.innerHTML=crit_full_list[i];;
                            btn_btn_primary.title=crit_full_list[i];
                            li_cfull_crit.append(btn_btn_primary);
                        
                        }  
        def_crit_cdm_on_co_off_TreeView();

        }

    }
    var cdm_co_on_toggle_btn_active_status=""
    function cdm_co_on_btn_func(elementid){
        var element_os=$(elementid).attr('id');
        if(element_os==="C.FULLbtn"){

            // document.getElementById("C.FULLbtn").style.backgroundColor = "#94000e"
            // document.getElementById("C.PRUNEbtn").style.backgroundColor = ""   
            if (cdm_co_on_toggle_btn_active_status==="C.FULLbtn"){
                return;
            }else{
                cdm_On_Full_Co_HtmlSetup_back_req_from_Prune();

            $("#cdm_co_on_show_Option").empty();

            $("#cdm_co_on_show_Option").append("<h5>Full Criteria </h5>");
            cdm_co_on_toggle_btn_active_status="C.FULLbtn"

            }
        }
        else if(element_os==="C.PRUNEbtn"){
            // document.getElementById("C.FULLbtn").style.backgroundColor = ""
            console.log("color",$("#C.PRUNEbtn").prop("style"))
            if (cdm_co_on_toggle_btn_active_status==="C.PRUNEbtn"){
                return;

            }else{
            // cdm_On_Prune_Co_HtmlSetup();
            showSetPrunCrit_Cdm_Co_Next();
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_show_Option").append("<h5>Pruned Criteria </h5>");

            cdm_co_on_toggle_btn_active_status="C.PRUNEbtn"
            }

            
        }
    }
    function showFeatureLvls_Cdm(){
        showFeatureLvls();
        $("#ol2").hide();
        $('#cdm_criteria_div').hide();
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#ftlvl').prop('class', 'custom_nav_btn active');
    }
    function showSetDefCritOrd_Cdm(){

        var current= $('.breadcrumb').find('li.bdcrumb_active');
        var current_index=$( ".breadcrumb li" ).index( current );
        var prev_element_index=current_index-1;
        var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        dict_not_empty_flag="true";

        cdm_defaultCriteriaOrderHTMLSetup();
    }
    /*
        // First HTML For C.full will be created here(having next button). 
        // crit_order_dict will be used. 
        // key will be C.Full_CO.1 and C.Full_C0.2.
        // Same values will be stored in both keys. 
        // On pressing next cdm_On_Prune_Co_HtmlSetup will run. 
        // itll simply save the values from the full keys to new keys
        // C.Prune_CO.1 and C.Prune_CO.2
        // once this user presses save now
        // Last function will be called ... Cdm_Order_ON_CO_HtmlSetup
        // This will take colist to create selection options. 
        // based on active button Such as C.FULL or C.Prune. . .
        // value from key will be populated
        // Now if user changes the selector E.g. CO.2 then selection_CDM_CO_Changer() will be called. 
        // which will get the active_co and check active button. e.g. C.Full 
        // on the basis of it the data from crit_order_dict will be exctracted and populted 
        // any changes to the order will be changed in the values of keys present in crit_order_dict.....
        // 
    */
    function showSetCritOrder_Cdm_Co_Next(){
        var TESXT= $('.breadcrumb').find('li').find('a').text().split("  ");
        $('#cdm_co_on_cfull_cprune_btn_div').empty();
        // $("#cdm_co_on_show_Option").empty();

        if (TESXT.includes("Set Criteria Order")){
            dict_not_empty_flag="true";
            var current= $('.breadcrumb').find('li.bdcrumb_active');
                var current_index=$( ".breadcrumb li" ).index( current );
                var prev_element_index=current_index+1;
                var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
                current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
                cdm_Order_On_Co_HtmlSetup();
        }
        else{

            dict_not_empty_flag="false";
            cdm_Order_On_Co_HtmlSetup()

        }
         
    }
    
    function showSetPrunCrit_Cdm_Co_Next(){
        var TESXT= $('.breadcrumb').find('li').find('a').text().split("  ");

             if (TESXT.includes("Set Prune Criteria")){
                dict_not_empty_flag="true";
            }
            else{
                dict_not_empty_flag="false";

            }
            if (dict_not_empty_flag==="false"){
                cdm_On_Prune_Co_HtmlSetup();

            }
            else{
                var current= $('.breadcrumb').find('li.bdcrumb_active');
                var current_index=$( ".breadcrumb li" ).index( current );
                var prev_element_index=current_index+1;
                var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
                current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
                cdm_On_Prune_Co_HtmlSetup();
            }
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_show_Option").append("<h5>Pruned Criteria</h5>");

            document.getElementById("C.FULLbtn").style.backgroundColor = ""
            document.getElementById("C.PRUNEbtn").style.backgroundColor = "#94000e"      

      
    }
    function showSetFullCrit_Cdm_Co_continue(){
            if (dict_not_empty_flag==="false"){
                cdm_On_Full_Co_HtmlSetup();

                }
            else{
                var current= $('.breadcrumb').find('li.bdcrumb_active');
                var current_index=$( ".breadcrumb li" ).index( current );
                var prev_element_index=current_index+1;
                var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
                current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
                cdm_On_Full_Co_HtmlSetup();
            }
      

    }
    function showSetDefCritOrd_Cdm_Co(){
        $('#cdm_co_on_cfull_cprune_btn_div').empty();
        var current= $('.breadcrumb').find('li.bdcrumb_active');
        var current_index=$( ".breadcrumb li" ).index( current );
        var prev_element_index=current_index-1;
        var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        dict_not_empty_flag="true";
        cdm_on_co_on_DefaultCriteriaHtmlSetup();
    }
    function showFeatureLvls_cdm_co(){
        $("#ol3").hide();
        showFeatureLvls();
        var current=$(".active");
        current.prop('class',current.attr('class').replace('active',""));
        $('#ftlvl').prop('class', 'custom_nav_btn active');


    }
    var  cdm_crit_order_on_flag="false";
    var request_from_full="true";
    request_from_set_def_criteria="true";
    function Cdm_on_CO_on_BreadCrumbActivateFunc(li_element){
        console.log("li_ele",li_element);
        var current= $('.breadcrumb').find('li.bdcrumb_active')
    
        if ($( ".breadcrumb li" ).index( li_element )===0){
            if($( ".breadcrumb li" ).index( li_element )===$( ".breadcrumb li").index(current)){
                return;
            }
            // delete crit_order_dict["CO.1_C.Full"]
            // delete crit_order_dict["CO.1_C.Full"]
            // delete crit_hide_dict["CO.1_C.Full"]
            // delete crit_hide_dict["CO.1_C.Full"]
            // delete default_crit_show_dict['C.Full'];
            // delete default_crit_show_dict['C.Prune'];
            // delete default_crit_hide_dict['C.Full'];
            // delete default_crit_hide_dict['C.Prune'];
            dict_not_empty_flag="true";
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_cfull_cprune_btn_div").empty();

            cdm_on_co_on_DefaultCriteriaHtmlSetup();
        }
        else if ($( ".breadcrumb li" ).index( li_element )===1){
            if($( ".breadcrumb li" ).index( li_element )===$( ".breadcrumb li").index(current)){
                return;
            }
            dict_not_empty_flag="true";
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_cfull_cprune_btn_div").empty();

            cdm_On_Full_Co_HtmlSetup();
            // $( li_element ).nextAll().remove();
        }
        else if ($( ".breadcrumb li" ).index( li_element )===2){
            if($( ".breadcrumb li" ).index( li_element )===$( ".breadcrumb li").index(current)){
                return;
            }
            if ($( ".breadcrumb li").index(current)>$( ".breadcrumb li" ).index( li_element )){
                request_from_full="false";
            }
            dict_not_empty_flag="true";
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_cfull_cprune_btn_div").empty();

            cdm_On_Prune_Co_HtmlSetup();
            // $( li_element ).nextAll().remove();

        }
        else if ($( ".breadcrumb li" ).index( li_element )===3){
            if($( ".breadcrumb li" ).index( li_element )===$( ".breadcrumb li").index(current)){
                return;
            }
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_cfull_cprune_btn_div").empty();

            cdm_Order_On_Co_HtmlSetup();
        }
            
        
        console.log("current", current);
        console.log("current", current.attr('class'))
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(li_element).prop('class', 'breadcrumb-item bdcrumb_active');


    }
    function cdm_on_co_on_DefaultCriteriaHtmlSetup(){
        $("#ol3").show();
        prune_empty_flag="true";
        request_from_set_def_criteria="true";

        // if (default_crit_show_dict['C.Full']!==undefined){
        //     delete default_crit_show_dict['C.Full'];
        //     delete default_crit_hide_dict['C.Full'];
        // }
        if ( dict_not_empty_flag==="false"){
            var breadcrumb_ol=document.getElementById("ol3");
            var  lit=document.createElement("li");
            lit.setAttribute("class","breadcrumb-item bdcrumb_active");
            breadcrumb_ol.append(lit);
            var a=document.createElement("a");
            a.setAttribute("href","#");
            a.setAttribute("onclick","Cdm_on_CO_on_BreadCrumbActivateFunc($(this).parent())");
            a.setAttribute("style","color:white")
            a.innerHTML="Set Default Criteria Order  ";
            lit.append(a);
        }
            $("#default_criteria_div").empty();
            $("#order_criteria_div").empty();
            $("#cdm_criteria_div").empty();
            $("#cdm_co_on_div").empty();
            $("#cdm_co_on_div").show();
            $("#cdm_co_on_show_Option").empty();
            $("#catalog_crit_sel").empty();
        
            var catalog_crit_sel=document.getElementById("catalog_crit_sel")
            var catalog_crit_sel_row_div=document.createElement("div")
            catalog_crit_sel.append(catalog_crit_sel_row_div)
            catalog_crit_sel_row_div.setAttribute("class","row")
            var col=document.createElement("div");
            col.setAttribute("class","col");
            catalog_crit_sel_row_div.append(col);
            var p_ele=document.createElement("p");
            p_ele.innerHTML="Catalog Criteria"
            col.append(p_ele);
            var col=document.createElement("div");
            col.setAttribute("class","col")

            catalog_crit_sel_row_div.append(col);
            var  input_num_field_catalog_crit=document.createElement("input")
            input_num_field_catalog_crit.setAttribute("id","input_num_field_catalog_crit")
            input_num_field_catalog_crit.setAttribute("type","number")
            col.append(input_num_field_catalog_crit);
            var  save_btn_catalog_crit=document.createElement("button")
            save_btn_catalog_crit.setAttribute("id","save_btn_catalog_crit")
            save_btn_catalog_crit.setAttribute("onclick","saveCatalogCrit_cdm_on_co_on()")
            save_btn_catalog_crit.innerHTML="Save"
            col.append(save_btn_catalog_crit);
            var col=document.createElement("div");
            col.setAttribute("class","col")
            col.setAttribute("id","catalog_crit_disp_col")

            catalog_crit_sel_row_div.append(col);


        var cdm_co_on_div=document.getElementById("cdm_co_on_div");
        var container=document.createElement("div");
        container.setAttribute('class','container-fluid text-center');
        cdm_co_on_div.append(container);
        var heading_row_div=document.createElement("div");
        heading_row_div.setAttribute("class","row");
        container.append(heading_row_div);
        var heading_content=document.createElement("H5");
        heading_content.innerHTML="Set Default Criteria Order";
          
        heading_row_div.append(heading_content);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="def_main_row_co_def";

        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_def_btn";

        back_to_main_setup_btn.setAttribute('onclick','showFeatureLvls_cdm_co()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        // var select_div=document.createElement('div');
        // select_div.setAttribute('id','select_div');
        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="product-section";
        // col_md_5.append(select_div);
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);
       
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
        var continue_btn=document.createElement('button');
        continue_btn.innerHTML="Continue";
        continue_btn.id="count_def_btn";
        continue_btn.setAttribute('onclick',"showSetFullCrit_Cdm_Co_continue()");
        col_md_1.append(continue_btn);
      
        if (dict_not_empty_flag==="true"){
            var shw_disp=[];
            var hide_disp=[]
            var loook=JSON.parse(JSON.stringify(crit_order_dict["CO.1_C.Full"]));
            // var hide_loook=JSON.parse(JSON.stringify(crit_hide_dict["CO.1_C.Full"]));

            var feat_dsp=loook;
            feat_to_disp=feat_dsp;
            var flg="true";
            var feat_hide=[]
            feat_to_hide=feat_hide;
            cdm_crit_order_on_flag="true";
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
            data_obj_show=JSON.parse(JSON.stringify(loook));
            data_obj_hide=JSON.parse(JSON.stringify(crit_hide_dict["CO.1_C.Full"]));
        
            default_crit_show_dict['C.Full']=data_obj_show;
            default_crit_hide_dict['C.Full']=data_obj_hide;
            data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
            data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
            static_default_crit_show_dict['C.Full']=data_obj_show_1;
            static_default_crit_hide_dict['C.Full']=data_obj_hide_2;

            $('ul').sortable({
                                axis: 'y',
                                stop: function (event, ui) {
                                var data = $(this).sortable('serialize').split("&");
                                var arr=[];
                                for (var key in data)
                                {   
                                    arr.push(data[key].split("=")[0].replace('[]',''));
                                }
                                console.log("arr",arr);

                                console.log("jason string",JSON.stringify(arr));

                                // $('span').text(data);
                                default_crit_show_dict["C.Full"]=arr;
                                arr_2=JSON.parse(JSON.stringify(arr));

                                static_default_crit_show_dict['C.Full']=arr_2;
                                // colist=dict['CO']
                                //  for (var co in colist){

                                //     crit_order_dict[colist[co]+"_C.Full"]=arr_2;

                                // }
                                console.log("-----------")        

                                console.log("static_default_crit_show_dict",static_default_crit_show_dict)        
                                console.log("crid_order_dict",crit_order_dict)        
                                // console.log("crid_hide_dict",crit_hide_dict)        
                               
                                $("#cdm_on_co_on_tree_view_div").empty();
                                cdm_on_co_on_TreeView();


                                // var main_treeview_list=[];
                                // var main_treeview_dict={};

                                // main_treeview_dict['name']="CDM On CO ON Criteria Tree View";
                                // mainchildlist=[];
                                // var defaut_criteria_order_dict={};
                                // defaut_criteria_order_dict_childlist=[];
                                // defaut_criteria_order_dict['name']='Defaut criteria order';

                                //         for (var i in static_default_crit_show_dict['C.Full'])
                                //         {
                                            
                                //             var defaut_criteria_order_child_dict={};
                                //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['C.Full'][i];
                                //             defaut_criteria_order_child_dict['childern']=[];
                                //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                //         }
                                // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                // mainchildlist.push(defaut_criteria_order_dict);
                                // main_treeview_dict['children']=mainchildlist


                                // main_treeview_list.push(main_treeview_dict);
                                // var tree=main_treeview_list;
                                // //
                                // // Create tree
                                // //
                                // var t = new TreeView(tree, 'cdm_on_co_on_tree_view_div');
                                // t.expandAll(); 
                                
                                
                                }
                        });    

                        $( "#sortable" ).enableSelection();
                    $("#cdm_on_co_on_tree_view_div").empty();
                    cdm_on_co_on_TreeView();


                
        }
        
        else{
              
            $.ajax({
                                    url: "{% url 'defaultcriteriasetup' %}",
                                    type:'GET',
                                    'data': {
                                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                                    },
                                    dataType: "json",
                                    
                                    success: function(data){
                                
                                    var shw_disp=[];
                                    var hide_disp=[];
                                    var mand=data['mandatory'];
                                    var feat_dsp=data['feature_to_display'];
                                    feat_to_disp=data['feature_to_display'];
                                    var flg=data['flag'];
                                    mandatory_list=mand;
                                    var feat_hide=data['feature_to_hide'];
                                    feat_to_hide=feat_hide;
                                    cdm_crit_order_on_flag="true";
                                    data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg);
                                    data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                                    data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
                                    default_crit_show_dict['C.Full']=data_obj_show;
                                    default_crit_hide_dict['C.Full']=data_obj_hide;
                                    data_obj_show_1=JSON.parse(JSON.stringify(data_obj_show));
                                    data_obj_hide_2=JSON.parse(JSON.stringify(data_obj_hide));
                                    static_default_crit_show_dict['C.Full']=data_obj_show_1;
                                    static_default_crit_hide_dict['C.Full']=data_obj_hide_2;

                                    console.log("default_crit_show_dict-->",default_crit_show_dict);
                                    console.log("default_crit_hide_dict-->",default_crit_hide_dict);
                                    $('ul').sortable({
                                    axis: 'y',
                                    stop: function (event, ui) {
                                    var data = $(this).sortable('serialize').split("&");
                                    var arr=[];
                                    for (var key in data)
                                    {   
                                        arr.push(data[key].split("=")[0].replace('[]',''));
                                    }
                                    console.log("arr",arr);

                                    console.log("jason string",JSON.stringify(arr));

                                    // $('span').text(data);
                                    default_crit_show_dict["C.Full"]=arr;
                                    arr_2=JSON.parse(JSON.stringify(arr));

                                    static_default_crit_show_dict['C.Full']=arr_2;
                                    $("#cdm_on_co_on_tree_view_div").empty();


                                    // var main_treeview_list=[];
                                    // var main_treeview_dict={};

                                    // main_treeview_dict['name']="CDM On CO ON Criteria Tree View";
                                    // mainchildlist=[];
                                    // var defaut_criteria_order_dict={};
                                    // defaut_criteria_order_dict_childlist=[];
                                    // defaut_criteria_order_dict['name']='Defaut criteria order';

                                    //         for (var i in static_default_crit_show_dict['C.Full'])
                                    //         {
                                                
                                    //             var defaut_criteria_order_child_dict={};
                                    //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['C.Full'][i];
                                    //             defaut_criteria_order_child_dict['childern']=[];
                                    //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                    //         }
                                    // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                    // mainchildlist.push(defaut_criteria_order_dict);
                                    // main_treeview_dict['children']=mainchildlist


                                    // main_treeview_list.push(main_treeview_dict);
                                    // var tree=main_treeview_list;
                                    // //
                                    // // Create tree
                                    // //
                                    // var t = new TreeView(tree, 'cdm_on_co_on_tree_view_div');
                                    // t.expandAll(); 
                                    cdm_on_co_on_TreeView();


                                
                                    
                                    }
                            });    

                                    $( "#sortable" ).enableSelection();
                                    $("#cdm_on_co_on_tree_view_div").empty();
                                    // var main_treeview_list=[];
                                    // var main_treeview_dict={};

                                    // main_treeview_dict['name']="CDM On CO Off Tree View";
                                    // mainchildlist=[];
                                    // var defaut_criteria_order_dict={};
                                    // defaut_criteria_order_dict_childlist=[];
                                    // defaut_criteria_order_dict['name']='Defaut criteria order';

                                    //         for (var i in static_default_crit_show_dict['C.Full'])
                                    //         {
                                                
                                    //             var defaut_criteria_order_child_dict={};
                                    //             defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['C.Full'][i];
                                    //             defaut_criteria_order_child_dict['childern']=[];
                                    //             defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                                    //         }
                                    // defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                                    // mainchildlist.push(defaut_criteria_order_dict);
                                    // main_treeview_dict['children']=mainchildlist


                                    // main_treeview_list.push(main_treeview_dict);
                                    // var tree=main_treeview_list;
                                    // //
                                    // // Create tree
                                    // //
                                    // var t = new TreeView(tree, 'default_tree_view_div');
                                    // t.expandAll(); 

                                    cdm_on_co_on_TreeView();


                            
                            }
                    });
            }       

    }
    function btn_Cdm_Co_On_Func2(element){
        alert($(element).attr("id"));
        co_feature_active=$(element).attr("id");
        if(co_feature_active==="C.Full"){
            document.getElementById("C.Full").style.backgroundColor = "#94000e"
            document.getElementById("C.Prune").style.backgroundColor = ""
            cdm_On_Full_Co_HtmlSetup();
        }else{
            document.getElementById("C.Prune").style.backgroundColor = "#94000e"
            document.getElementById("C.Full").style.backgroundColor = "";
            cdm_On_Prune_Co_HtmlSetup();
        }
    }
    function cdm_On_Full_Co_HtmlSetup(){
        
        request_from_full="true";
        co_feature_active="C.Full";
        cdm_crit_order_on_flag="false";
        $("#ol1").empty();
        $("#ol2").empty();
        $("#ol4").empty();

        $("#ol3").show();
        if ($('.breadcrumb li').length>0 && $('.breadcrumb li').length===1 ){
            var current= $('.breadcrumb').find('li.bdcrumb_active')
            var breadcrumb_ol=document.getElementById("ol3");
            var  li=document.createElement("li");
            li.setAttribute("class","breadcrumb-item");
            breadcrumb_ol.append(li);
            var a=document.createElement("a");
            a.setAttribute("href","#");
            a.setAttribute("onclick","Cdm_on_CO_on_BreadCrumbActivateFunc($(this).parent())");
            a.setAttribute("style","color:white")

            a.innerHTML="Set Full Criteria  ";
            li.append(a);
            current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
            $(li).prop('class', 'breadcrumb-item bdcrumb_active');
        }else{ }
        
        
        $("#default_criteria_div").empty();
        $("#order_criteria_div").empty();
        $("#cdm_criteria_div").empty();
        $("#cdm_co_on_div").empty();
        $("#cdm_co_on_div").show();
        // $("#cdm_co_on_show_Option").empty();
        // $("#cdm_co_on_show_Option").show();

       
        if ( $('#cdm_co_on_cfull_cprune_btn_div').children().length == 0 ) {
        $("#cdm_co_on_show_Option").append("<h5>Full Criteria </h5>");
        var cdm_co_on_cfull_cprune_btn_div=document.getElementById("cdm_co_on_cfull_cprune_btn_div");
        var toggle_btn_row_div=document.createElement('div');
        toggle_btn_row_div.setAttribute("class","row");
        cdm_co_on_cfull_cprune_btn_div.append(toggle_btn_row_div);
        var col_md_12=document.createElement('div');
        col_md_12.setAttribute('class','col-md-9 btn-group');
        col_md_12.id="cdm_co_on_set_buttons"
        toggle_btn_row_div.append(col_md_12);
        cdm_co_on_set_list=["C.FULL","C.PRUNE"];
        for (var i=0;i<cdm_co_on_set_list.length;i++){
            var button=document.createElement('button')
            button.id=cdm_co_on_set_list[i]+"btn"
            button.innerHTML=cdm_co_on_set_list[i];
            button.setAttribute("onclick","cdm_co_on_btn_func($(this))")
            if (i===0){
                var active_b=button
            }
            $('#cdm_co_on_set_buttons').append(button)
        }
        document.getElementById("C.FULLbtn").style.backgroundColor = "#94000e"
        }

        cdm_co_on_div=document.getElementById("cdm_co_on_div");
        var container=document.createElement("container");
        container.setAttribute("class","cdm_co_cont");
        cdm_co_on_div.append(container);


        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="main_row_co";
        container.append(main_row);
        
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);

        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_cdm_btn";
    
        back_to_main_setup_btn.setAttribute('onclick','showSetDefCritOrd_Cdm_Co()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="feature_display_container";
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);

        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";

        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);
    
        var next_to_main_setup_btn=document.createElement('button');
        next_to_main_setup_btn.innerHTML="Next";
        next_to_main_setup_btn.id="NEXT_CDM_BTN";
        next_to_main_setup_btn.setAttribute('onclick',"showSetPrunCrit_Cdm_Co_Next()");
        col_md_1.append(next_to_main_setup_btn);
      
       
        if (crit_order_dict["CO.1_C.Full"]!==undefined || crit_hide_dict["CO.1_C.Full"]!==undefined ){
                var shw_disp=[];
                var hide_disp=[];
                if (request_from_set_def_criteria==="true"){
                    // alert("request_from_set_def_criteria true")
                    var feat_dsp=JSON.parse(JSON.stringify(default_crit_show_dict['C.Full']));
                    // crit_order_dict["CO.1_C.Full"]=feat_dsp;
                    feat_to_disp=feat_dsp;
                    var feat_hide=JSON.parse(JSON.stringify(default_crit_hide_dict['C.Full']));
                    // crit_hide_dict["CO.1_C.Full"]=feat_hide
                    feat_to_hide=feat_hide
                    var flg="true";
                    data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)         
                    var colist=block_feat_dict['CO']
                    for (var co in colist){
                        // crit_order_dict[colist[co]+"_"+co_feature_active]=data_obj_show;
                        // crit_hide_dict[colist[co]+"_"+co_feature_active]=data_obj_hide;
                        crit_order_dict[colist[co]+"_C.Full"]=feat_dsp;
                        crit_hide_dict[colist[co]+"_C.Full"]=feat_hide;

                    }
                }else{
                    // alert("request_from_set_def_criteria false")

                    var feat_dsp=JSON.parse(JSON.stringify(crit_order_dict["CO.1_C.Full"]));
                    feat_to_disp=feat_dsp;
                    var feat_hide=JSON.parse(JSON.stringify(crit_hide_dict["CO.1_C.Full"]));
                    feat_to_hide=feat_hide
                    var flg="true";
                    data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)  
                    //    TESTING PHASE> 
                    // var colist=block_feat_dict['CO']
                        // for (var co in colist){
                        //     // crit_order_dict[colist[co]+"_"+co_feature_active]=data_obj_show;
                        //     // crit_hide_dict[colist[co]+"_"+co_feature_active]=data_obj_hide;
                        //     crit_order_dict[colist[co]+"_C.Full"]=feat_dsp;
                        //     crit_hide_dict[colist[co]+"_C.Full"]=feat_hide;

                        // }
                }    
               
                       
        }
        else{
            if (default_crit_show_dict['C.Full'] !==undefined && default_crit_hide_dict['C.Full'] !==undefined){
                var shw_disp=[];
                var hide_disp=[];

                var feat_dsp=JSON.parse(JSON.stringify(default_crit_show_dict['C.Full']));
                // crit_order_dict["CO.1_C.Full"]=feat_dsp;
                feat_to_disp=feat_dsp;
                var feat_hide=JSON.parse(JSON.stringify(default_crit_hide_dict['C.Full']));
                // crit_hide_dict["CO.1_C.Full"]=feat_hide
                feat_to_hide=feat_hide
                var flg="true";
            
                data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
                var colist=block_feat_dict["CO"];
                data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
                data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

                for (var co in colist){
                    // crit_order_dict[colist[co]+"_"+co_feature_active]=data_obj_show;
                    // crit_hide_dict[colist[co]+"_"+co_feature_active]=data_obj_hide;
                    crit_order_dict[colist[co]+"_C.Full"]=data_obj_show;
                    crit_hide_dict[colist[co]+"_C.Full"]=data_obj_hide;

                }
                                
                                
                                    
             }
            //  $.ajax({
            //                     url: "{% url 'cdm_on_co_on_criteriasetup' %}",
            //                     type:'GET',
            //                     'data': {
            //                     'csrfmiddlewaretoken': '{{ csrf_token }}',
            //                     },
            //                     dataType: "json",
                                
            //                     success: function(data){
            //                     // var inputdata =block_feat_dict["CO"]
            //                     // var select=document.createElement('select');
            //                     // select.setAttribute('id', 'sel_options');
            //                     // select.setAttribute('onchange',"selChangeFunc($(this))")
            //                     // for (var i=0;i<inputdata.length;i++){
            //                     //         var option=document.createElement('option');
            //                     //         option.value=inputdata[i];
            //                     //         option.text=inputdata[i];
            //                     //         select.append(option);
            //                     // }
                                
            //                     var shw_disp=[];
            //                     var hide_disp=[];
            //                     var mand=data['mandatory'];
            //                     var feat_dsp=data['feature_to_display'];
            //                     feat_to_disp=data['feature_to_display'];
            //                     var feat_hide=data['feature_to_hide'];
            //                     feat_to_hide=data['feature_to_hide'];
            //                     var flg=data['flag'];
            //                     default_crit_show_disp=data['feature_to_display'];
            //                     default_crit_hide_disp=data['feature_to_hide'];
                                
            //                     mandatory_list=mand;
            //                     // $('#select_div').empty();
            //                     // $('#select_div').append(select);   

            //                     data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
            //                     var colist=block_feat_dict["CO"];
            //                     data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            //                     data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

            //                     for (var co in colist){
            //                         crit_order_dict[colist[co]+"_"+co_feature_active]=data_obj_show;
            //                         crit_hide_dict[colist[co]+"_"+co_feature_active]=data_obj_hide;

            //                     }
                                
                                
                               
            //                     console.log("crit_order_dict-->",crit_order_dict);
            //                     console.log("crit_hide_dict-->",crit_hide_dict);
            //                     default_crit_show_dict['C.Full']=default_crit_show_disp;
            //                     default_crit_hide_dict["C.Full"]=default_crit_hide_disp;
            //                     console.log("default_crit_show_dict",default_crit_show_dict);
            //                     console.log("default_crit_hide_dict",default_crit_hide_dict);
                               
            //                 }

            //             });
       
                          
        }
        cdm_on_co_on_TreeView();
        request_from_set_def_criteria="false";

    }
    function cdm_On_Prune_Co_HtmlSetup(){
        cdm_crit_order_on_flag="false";

          
        $("#cdm_co_on_div").empty();
        // $("#cdm_co_on_show_Option").empty();
        if ( $('#cdm_co_on_cfull_cprune_btn_div').children().length == 0 ) {
            $("#cdm_co_on_show_Option").empty();
            $("#cdm_co_on_show_Option").append("<h5>Pruned Criteria</h5>");
            var cdm_co_on_cfull_cprune_btn_div=document.getElementById("cdm_co_on_cfull_cprune_btn_div");
            var toggle_btn_row_div=document.createElement('div');
            toggle_btn_row_div.setAttribute("class","row");
            cdm_co_on_cfull_cprune_btn_div.append(toggle_btn_row_div);
            var col_md_12=document.createElement('div');
            col_md_12.setAttribute('class','col-md-9 btn-group');
            col_md_12.id="cdm_co_on_set_buttons"
            toggle_btn_row_div.append(col_md_12);
            cdm_co_on_set_list=["C.FULL","C.PRUNE"];
            for (var i=0;i<cdm_co_on_set_list.length;i++){
                var button=document.createElement('button')
                button.id=cdm_co_on_set_list[i]+"btn"
                button.innerHTML=cdm_co_on_set_list[i];
                button.setAttribute("onclick","cdm_co_on_btn_func($(this))")
                if (i===0){
                    var active_b=button
                }
                $('#cdm_co_on_set_buttons').append(button)
            }
            document.getElementById("C.PRUNEbtn").style.backgroundColor = "#94000e"

        }
        cdm_co_on_div=document.getElementById("cdm_co_on_div");
        var container=document.createElement("container");
        container.setAttribute("class","cdm_co_cont");
        cdm_co_on_div.append(container);
        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="main_row_co";
        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);

        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_cdm_btn";

        back_to_main_setup_btn.setAttribute('onclick','cdm_On_Full_Co_HtmlSetup_back_req_from_Prune()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="feature_display_container";
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);

        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Recent  Hidden Features";

        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);

        // var full_crit_selected=document.createElement("div");
        //     full_crit_selected.setAttribute("id","full_crit_selected");
        //     col_md_5_2.append(full_crit_selected);
        //     var h4=document.createElement('h4');
        //     h4.innerHTML="Full Selected Features";
        //     full_crit_selected.append(h4);
        //     var full_crit_sel_inner_div=document.createElement('div');
        //     full_crit_sel_inner_div.setAttribute('id','full_crit_sel_inner_div');
        //     full_crit_selected.append(full_crit_sel_inner_div)
            
            var full_crit_hidden=document.createElement("div");
            full_crit_hidden.setAttribute("id","full_crit_hidden");
            col_md_5_2.append(full_crit_hidden);
            var h4=document.createElement('h4');
            h4.innerHTML="Full Hidden Features";
            full_crit_hidden.append(h4);
            var full_crit_hid_inner_div=document.createElement('div');
            full_crit_hid_inner_div.setAttribute('id','full_crit_hid_inner_div');
            full_crit_hidden.append(full_crit_hid_inner_div)

       
       
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1 ');
        main_row.append(col_md_1);
    
        var next_to_main_setup_btn=document.createElement('button');
        next_to_main_setup_btn.innerHTML="Next";
        next_to_main_setup_btn.id="NEXT_CDM_BTN";
        next_to_main_setup_btn.setAttribute('onclick',"showSetCritOrder_Cdm_Co_Next()");
        col_md_1.append(next_to_main_setup_btn);

        co_feature_active="C.Prune";
        var shw_disp=[];
        var hide_disp=[];
        var crit_ord_dict=JSON.parse(JSON.stringify(crit_order_dict));
        var crit_hd_dict=JSON.parse(JSON.stringify(crit_hide_dict));

        console.log("crit_ord_dict['CO.1_C.Full']",crit_ord_dict['CO.1_C.Full'])
        if (request_from_full==="true"){
          
            $("#ol3").show();

            

            var TESXT= $('.breadcrumb').find('li').find('a').text().split("  ");
            console.log("TEXST",TESXT);
            if (TESXT.includes("Set Prune Criteria")){
                dict_not_empty_flag="true";
            }
            else{
                dict_not_empty_flag="false";

            }
            // var current_index=$( ".breadcrumb li" ).index( current );
            // if (current_index!==2){

            if(dict_not_empty_flag==="false"){
                var current= $('.breadcrumb').find('li.bdcrumb_active')

                var breadcrumb_ol=document.getElementById("ol3");
                var  li=document.createElement("li");
                li.setAttribute("class","breadcrumb-item");
                breadcrumb_ol.append(li);
                var a=document.createElement("a");
                a.setAttribute("href","#");
                a.setAttribute("onclick","Cdm_on_CO_on_BreadCrumbActivateFunc($(this).parent())");
                a.setAttribute("style","color:white");

                a.innerHTML="Set Prune Criteria  ";
                li.append(a);
                current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                $(li).prop('class', 'breadcrumb-item bdcrumb_active');
                var feat_dsp=crit_ord_dict['CO.1_C.Full'];
                feat_to_disp=feat_dsp;
                var feat_hide=[]
                feat_to_hide=feat_hide
                var flg="true";
                default_crit_show_disp=feat_to_disp;
                default_crit_hide_disp=feat_to_hide;
                default_crit_show_dict['C.Prune']=default_crit_show_disp;
                default_crit_hide_dict["C.Prune"]=default_crit_hide_disp;

            }
            else{               
                $("#cdm_co_on_div").show();
                var colist=block_feat_dict['CO'];
                for (var co in colist){
                    
                        prune_list_show=crit_order_dict[colist[co]+"_C.Prune"];
                        prune_list_hide=crit_hide_dict[colist[co]+"_C.Prune"];
                        temp_list=[];
                        temp_list2=[];
                        for (var i in crit_order_dict[colist[co]+"_C.Full"]){
                            if(prune_list_show.includes(crit_order_dict[colist[co]+"_C.Full"][i])){
                                temp_list.push(crit_order_dict[colist[co]+"_C.Full"][i])
                            }
                            else if (prune_list_hide.includes(crit_order_dict[colist[co]+"_C.Full"][i])){
                            }
                            else{
                                temp_list2.push(crit_order_dict[colist[co]+"_C.Full"][i])
                            }  

                        }
                        
                        if (temp_list2.length!==0){
                            for (var i in temp_list2){
                                temp_list.push(temp_list2[i]);

                            }
                        }
                        crit_order_dict[colist[co]+"_C.Prune"]=temp_list;
                        for (  var i in crit_hide_dict[colist[co]+"_C.Full"]){
                            if (prune_list_hide.includes(crit_hide_dict[colist[co]+"_C.Full"][i])){
                                var ind=prune_list_hide.indexOf(crit_hide_dict[colist[co]+"_C.Full"][i]);
                                prune_list_hide.splice(ind,1)
                            }
                        }
                        crit_hide_dict[colist[co]+"_C.Prune"]=prune_list_hide;

                    
                }
               
                var feat_dsp=crit_order_dict["CO.1_C.Prune"]
                // var feat_dsp=default_crit_show_dict['C.Prune']
                feat_to_disp=feat_dsp;
                // var feat_hide=crit_hd_dict['CO.1_C.Prune'];
                var feat_hide=crit_hide_dict["CO.1_C.Prune"]
                feat_to_hide=feat_hide
                var flg="true";

            }
            
         
                
   

        }
        else{
            $("#cdm_co_on_div").show();

            var feat_dsp=crit_ord_dict['CO.1_C.Prune'];
            feat_to_disp=feat_dsp;
            var feat_hide=crit_hd_dict['CO.1_C.Prune'];
            feat_to_hide=feat_hide
            var flg="true";
        
        
        }
  
        
        
 

        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
        var colist=block_feat_dict["CO"];
        data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
        data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

        for (var co in colist){

            crit_order_dict[colist[co]+"_"+co_feature_active]=data_obj_show;
            crit_hide_dict[colist[co]+"_"+co_feature_active]=data_obj_hide;

        }
        
        console.log("crit_order_dict----",crit_order_dict);
        console.log("crit_hide_dict----",crit_hide_dict);
        console.log("default_crit_show_dict----",default_crit_show_dict);
        console.log("default_crit_hide_dict----",default_crit_hide_dict);
        // var full_crit_sel_inner_div=document.getElementById('full_crit_sel_inner_div');
        //     var ul_cfull_crit=document.createElement('ul');
        //     ul_cfull_crit.setAttribute("id","cfull_crit");
        //     full_crit_sel_inner_div.append(ul_cfull_crit);
        //     var crit_full_list=crit_order_dict['CO.1_C.Full'];
        //                 for (var i in crit_full_list ){

        //                     var li_cfull_crit=document.createElement('li');
        //                     // li_cfull_crit.innerHTML=crit_full_list[i];
        //                     ul_cfull_crit.append(li_cfull_crit);
        //                     var btn_btn_primary=document.createElement('button');
        //                     btn_btn_primary.setAttribute("class","sortable_custom_show_btns");
        //                     btn_btn_primary.innerHTML=crit_full_list[i];;
        //                     btn_btn_primary.title=crit_full_list[i];
        //                     li_cfull_crit.append(btn_btn_primary);

        //                 }  
        var full_crit_hid_inner_div=document.getElementById('full_crit_hid_inner_div');
            var ul_cfull_crit=document.createElement('ul');
            ul_cfull_crit.setAttribute("id","cfull_crit_hidden");
            full_crit_hid_inner_div.append(ul_cfull_crit);
            var crit_full_list=crit_hide_dict['CO.1_C.Full'];
                        for (var i in crit_full_list ){
                            var li_cfull_crit=document.createElement('li');
                            // li_cfull_crit.innerHTML=crit_full_list[i];
                            ul_cfull_crit.append(li_cfull_crit);
                            var btn_btn_primary=document.createElement('button');
                            btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                            btn_btn_primary.innerHTML=crit_full_list[i];;
                            btn_btn_primary.title=crit_full_list[i];
                            li_cfull_crit.append(btn_btn_primary);
                        
                        }  
        cdm_on_co_on_TreeView();
       
    }
    function cdm_On_Full_Co_HtmlSetup_back_req_from_Prune(){
        var current= $('.breadcrumb').find('li.bdcrumb_active');
        var current_index=$( ".breadcrumb li" ).index( current );
        var prev_element_index=current_index-1;
        var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        $("#cdm_co_on_show_Option").empty();
        $("#cdm_co_on_show_Option").append("<h5>Full Criteria</h5>");

        
        document.getElementById("C.FULLbtn").style.backgroundColor = "#94000e"
        document.getElementById("C.PRUNEbtn").style.backgroundColor = ""      
        
        cdm_On_Full_Co_HtmlSetup();
    }
    function cdm_On_Prune_Co_HtmlSetup__back_req_from_CO(){
        request_from_full="false";
        var current= $('.breadcrumb').find('li.bdcrumb_active');
        var current_index=$( ".breadcrumb li" ).index( current );
        var prev_element_index=current_index-1;
        var prev_element= $( ".breadcrumb li" ).get( prev_element_index )
        current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
        $(prev_element).prop('class', 'breadcrumb-item bdcrumb_active');
        cdm_On_Prune_Co_HtmlSetup();
    }
    function cdm_Order_On_Co_HtmlSetup(){
        cdm_crit_order_on_flag="true";

        $("#cdm_co_on_div").show();
        $("#ol3").show();  
       var TESXT= $('.breadcrumb').find('li').find('a').text().split("  ");
         console.log("TEXST",TESXT)
        if (TESXT.includes("Set Criteria Order")){
            dict_not_empty_flag="true";
            
        }
        else{
            dict_not_empty_flag="false";

        }
        if(dict_not_empty_flag==="false"){

                var current= $('.breadcrumb').find('li.bdcrumb_active');
                var breadcrumb_ol=document.getElementById("ol3");
                var  li=document.createElement("li");
                li.setAttribute("class","breadcrumb-item");
                breadcrumb_ol.append(li);
                var a=document.createElement("a");
                a.setAttribute("href","#");
                a.setAttribute("onclick","Cdm_on_CO_on_BreadCrumbActivateFunc($(this).parent())");
                a.setAttribute("style","color:white");

                a.innerHTML="Set Criteria Order  ";
                li.append(a);
                current.prop('class',current.attr('class').replace('breadcrumb-item bdcrumb_active',"breadcrumb-item"));
                $(li).prop('class', 'breadcrumb-item bdcrumb_active');
            }
        $("#cdm_co_on_div").empty();
        $("#cdm_co_on_show_Option").empty();
        $("#cdm_co_on_show_Option").append("<h5>Criteria Ordering</h5>");
       
        var cdm_co_on_div=document.getElementById("cdm_co_on_div");
        var container=document.createElement("div");
        var container=document.createElement("container");
        container.setAttribute("class","cdm_co_cont");
        cdm_co_on_div.append(container);

        var co_sel_list_row_div=document.createElement("div");
        co_sel_list_row_div.setAttribute("class","row");
        co_sel_list_row_div.setAttribute("id","co_sel_list_row_div");
        container.append(co_sel_list_row_div);

        var col_1=document.createElement("div");
        col_1.setAttribute("class","col");
        co_sel_list_row_div.append(col_1);
        
        var col_2=document.createElement("div");
        col_2.setAttribute("class","col");
        col_2.setAttribute("style"," text-align: center;");

        co_sel_list_row_div.append(col_2);

        var col_3=document.createElement("div");
        col_3.setAttribute("class","col");
        co_sel_list_row_div.append(col_3);

        var select_div=document.createElement('div');
        select_div.setAttribute('id','select_div');
        select_div.setAttribute("style","display: inline-block;");


        col_2.append(select_div);


        var div_cdm=document.createElement("div")
        
        var toggle_btn_row_div=document.createElement('div');
        toggle_btn_row_div.setAttribute("class","row");
        container.append(toggle_btn_row_div);
        var col_md_12=document.createElement('div');
        col_md_12.setAttribute('class','col-md-9 btn-group');
        col_md_12.id="set_buttons_cdm_co"
        toggle_btn_row_div.append(col_md_12);
        cmd_set_list_co=["C.Full","C.Prune"];
        for (var i=0;i<cmd_set_list_co.length;i++){
            var button=document.createElement('button');
            button.id=cmd_set_list_co[i];
            button.innerHTML=cmd_set_list_co[i];
            button.setAttribute("onclick","btn_Cdm_Co_On_Func($(this))")
            if (i===0){
                var active_b=button
            }
            $('#set_buttons_cdm_co').append(button)
        }
        document.getElementById("C.Full").style.backgroundColor = "#94000e";
        document.getElementById("C.Prune").style.backgroundColor = "";



        var main_row=document.createElement('div');
        main_row.setAttribute('class','row content');
        main_row.id="main_row_co";
        container.append(main_row);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);

        var back_to_main_setup_btn=document.createElement('button');
        back_to_main_setup_btn.innerHTML="Back";
        back_to_main_setup_btn.id="back_cdm_btn";
        back_to_main_setup_btn.setAttribute('onclick','cdm_On_Prune_Co_HtmlSetup__back_req_from_CO()')
        col_md_1.append(back_to_main_setup_btn);
        var col_md_5=document.createElement('div');
        col_md_5.setAttribute('class','col-md-5 text-left');
        main_row.append(col_md_5);

        var container_two=document.createElement('div');
        container_two.setAttribute('class','container ');
        container_two.id="feature_display_container";
        col_md_5.append(container_two);
        var disp_feat_div=document.createElement("div");
        disp_feat_div.setAttribute('id','display_feature_div');
        container_two.append(disp_feat_div);
        var col_md_5_2=document.createElement('div');
        col_md_5_2.setAttribute('class','col-md-5');
        main_row.append(col_md_5_2);

        var hiddenfeat_div=document.createElement('div');
        col_md_5_2.append(hiddenfeat_div);
        var h2=document.createElement('h5');
        h2.innerHTML="Hidden Features";
        hiddenfeat_div.append(h2);
        var hide_feature_div=document.createElement('div');
        hide_feature_div.setAttribute('id','hide_feature_div');
        hiddenfeat_div.append(hide_feature_div);
        var recenthiddenfeat_div=document.createElement('div');
        recenthiddenfeat_div.setAttribute('id','recent_hidden_div');
        col_md_5_2.append(recenthiddenfeat_div);
        var h2=document.createElement('h5');
        // h2.innerHTML="Recent  Hidden Features";

        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        var col_md_1=document.createElement('div');
        col_md_1.setAttribute('class','col-md-1');
        main_row.append(col_md_1);
    
        var save_to_main_setup_btn=document.createElement('button');
        save_to_main_setup_btn.innerHTML="Save";
        save_to_main_setup_btn.id="SAVE_CDM_BTN";
        save_to_main_setup_btn.setAttribute('onclick',"Save_Cdm_CO_On()");
        col_md_1.append(save_to_main_setup_btn);
        var select_div=document.getElementById('select_div');
        var toggle_btn_row_div=document.createElement('div');
        toggle_btn_row_div.setAttribute("class","row");
        select_div.append(toggle_btn_row_div);
        var col_md_12=document.createElement('div');
        col_md_12.setAttribute('class','col-md-9 btn-group');
        col_md_12.id="set_button_cdm_on_co_on"
        toggle_btn_row_div.append(col_md_12);
        colist=block_feat_dict["CO"];
        for (var i=0;i<colist.length;i++){
            var button=document.createElement('button')
            button.id=colist[i]+"btn"
            button.innerHTML=colist[i];
            button.value=colist[i];
            button.setAttribute("onclick","select_Cmd_Co_On_Changer($(this))")
            if (i===0){
                var active_b=button
            }
            $('#set_button_cdm_on_co_on').append(button)
        }
        document.getElementById("CO.1btn").style.backgroundColor = "#94000e"

        // var inputdata =block_feat_dict["CO"];
        // var select=document.createElement('select');
        // select.setAttribute('id', 'sel_options');
        // select.setAttribute('onchange',"select_Cmd_Co_On_Changer($(this))")
        // for (var i=0;i<inputdata.length;i++){
        //         var option=document.createElement('option');
        //         option.value=inputdata[i];
        //         option.text=inputdata[i];
        //         select.append(option);
        // }
        // $('#select_div').empty();
        // $('#select_div').append(select);   

                               
        co_feature_active="C.Full";
        active_co="CO.1"
        var shw_disp=[];
        var hide_disp=[];
        var crit_ord_dict=JSON.parse(JSON.stringify(crit_order_dict));
        var crit_hd_dict=JSON.parse(JSON.stringify(crit_hide_dict));

        console.log("crit_ord_dict['CO.1_C.Full']",crit_ord_dict['CO.1_C.Full'])

        var feat_dsp=crit_ord_dict['CO.1_C.Full'];
        feat_to_disp=feat_dsp;
        var feat_hide=crit_hd_dict['CO.1_C.Full'];
        feat_to_hide=feat_hide;
        var flg="true";
        default_crit_show_disp=feat_to_disp;
        default_crit_hide_disp=feat_to_hide;
        // $('#select_div').empty();
        // $('#select_div').append(select);   
       
 

        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
        var colist=block_feat_dict["CO"];
        data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
        data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

        // for (var co in colist){
        //     crit_order_dict[colist[co]+co_feature_active]=data_obj_show;
        //     crit_hide_dict[colist[co]+co_feature_active]=data_obj_hide;

        // }
        
        console.log("crit_order_dict----",crit_order_dict);
        console.log("crit_hide_dict----",crit_hide_dict);
        $('ul').sortable({
                                    axis: 'y',
                                    stop: function (event, ui) {
                                    var data = $(this).sortable('serialize').split("&");
                                    var arr=[];
                                    for (var key in data)
                                    {   
                                        arr.push(data[key].split("=")[0].replace('[]',''));
                                    }
                                    console.log("arr",arr)
                                    console.log("crit_order_dict-->",crit_order_dict)

                                    console.log("jason string",JSON.stringify(arr))

                                    // $('span').text(data);
                                   
                                        if (crit_order_dict[active_co+"_"+co_feature_active]===undefined){
                                        crit_order_dict[active_co+"_"+co_feature_active]=[]
                                        }
                                        else{
                                            crit_order_dict[active_co+"_"+co_feature_active]=arr;
                                            crit_hide_dict[active_co+"_"+co_feature_active]=hide_disp;
                                            
                                            console.log("crit_order_dict-",crit_order_dict)
                                            console.log("crit_hide_dict-",crit_hide_dict);
                                        }
                                        cdm_on_co_on_TreeView();
                                    }
                                });
        cdm_on_co_on_TreeView();
    }
    var cdm_co_on_ord_button_active="C.Full"
    function btn_Cdm_Co_On_Func(element){
        cdm_co_on_ord_button_active=$(element).attr("id");
        alert($(element).attr("id"));
        co_feature_active=$(element).attr("id");
        if(co_feature_active==="C.Full"){
            document.getElementById("C.Full").style.backgroundColor = "#94000e"
            document.getElementById("C.Prune").style.backgroundColor = ""
        }else{
            document.getElementById("C.Prune").style.backgroundColor = "#94000e"
            document.getElementById("C.Full").style.backgroundColor = ""
        }
        $('#recent_hidden_div').empty();
        $('#hide_feature_div').empty();
        $("#display_feature_div").empty();
       
        if(co_feature_active==="C.Full"){
            var recenthiddenfeat_div=document.getElementById('recent_hidden_div');
        console.log("recenthiddenfeat_div",recenthiddenfeat_div)
        var h2=document.createElement('h5');
        // h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        
        var hide_feature_div=document.getElementById('hide_feature_div');

        var ul_hiddenfeat=document.createElement('ul');
        ul_hiddenfeat.setAttribute("id","hiddenfeat");
        hide_feature_div.append(ul_hiddenfeat);
      
            var shw_disp=[];
            var hide_disp=[];
            var crit_ord_dict=JSON.parse(JSON.stringify(crit_order_dict));
            var crit_hd_dict=JSON.parse(JSON.stringify(crit_hide_dict));


            var feat_dsp=crit_ord_dict[active_co+"_"+co_feature_active];
            feat_to_disp=feat_dsp;
            var feat_hide=crit_hd_dict[active_co+"_"+co_feature_active];
            feat_to_hide=feat_hide
            var flg="true";

        
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)
            // var colist=block_feat_dict["CO"];
            // data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            // data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));
            
            $('ul').sortable({
                    axis: 'y',
                    stop: function (event, ui) {
                    var data = $(this).sortable('serialize').split("&");
                    var arr=[];
                    for (var key in data)
                    {   
                        arr.push(data[key].split("=")[0].replace('[]',''));

                    }
            
                                        // $('span').text(data);
                                    
                                            if (crit_order_dict[active_co+"_"+co_feature_active]===undefined){
                                            crit_order_dict[active_co+"_"+co_feature_active]=[]
                                            }
                                            else{
                                                crit_order_dict[active_co+"_"+co_feature_active]=arr;
                                                crit_hide_dict[active_co+"_"+co_feature_active]=hide_disp;
                                                
                                                console.log("crit_order_dict-",crit_order_dict)
                                                console.log("crit_hide_dict-",crit_hide_dict);
                                            }
                                    

                        cdm_on_co_on_TreeView();
                        
                        }
                    });


        }
        else{
        var recenthiddenfeat_div=document.getElementById('recent_hidden_div');
        console.log("recenthiddenfeat_div",recenthiddenfeat_div)
        var h2=document.createElement('h5');
        // h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        
        var hide_feature_div=document.getElementById('hide_feature_div');

        var ul_hiddenfeat=document.createElement('ul');
        ul_hiddenfeat.setAttribute("id","hiddenfeat");
        hide_feature_div.append(ul_hiddenfeat);
      
            var colist=block_feat_dict["CO"];
            // for (var co in colist){
            //     var koool=colist[co]+"_C.Prune";
            //     console.log("pruned list",crit_order_dict[koool])
            //     var prune_list=crit_order_dict[koool];
            //     var temp_list=[];
            //     for (var i in crit_order_dict[colist[co]+'_C.Full']){
            //             if(prune_list.includes(crit_order_dict[colist[co]+'_C.Full'][i])){
            //                 temp_list.push(crit_order_dict[colist[co]+'_C.Full'][i])
            //             }                          
            //         }
            //         console.log("temp list",temp_list)
            //     crit_order_dict[koool]=temp_list;
                    
            // }
            var colist=block_feat_dict['CO'];
                for (var co in colist){
                    
                        prune_list_show=crit_order_dict[colist[co]+"_C.Prune"];
                        prune_list_hide=crit_hide_dict[colist[co]+"_C.Prune"];
                        temp_list=[];
                        temp_list2=[];
                        for (var i in crit_order_dict[colist[co]+"_C.Full"]){
                            if(prune_list_show.includes(crit_order_dict[colist[co]+"_C.Full"][i])){
                                temp_list.push(crit_order_dict[colist[co]+"_C.Full"][i])
                            }
                            else if (prune_list_hide.includes(crit_order_dict[colist[co]+"_C.Full"][i])){
                            }
                            else{
                                temp_list2.push(crit_order_dict[colist[co]+"_C.Full"][i])
                            }  

                        }
                        
                        if (temp_list2.length!==0){
                            for (var i in temp_list2){
                                temp_list.push(temp_list2[i]);

                            }
                        }
                        crit_order_dict[colist[co]+"_C.Prune"]=temp_list;
                        for (  var i in crit_hide_dict[colist[co]+"_C.Full"]){
                            if (prune_list_hide.includes(crit_hide_dict[colist[co]+"_C.Full"][i])){
                                var ind=prune_list_hide.indexOf(crit_hide_dict[colist[co]+"_C.Full"][i]);
                                prune_list_hide.splice(ind,1)
                            }
                        }
                        crit_hide_dict[colist[co]+"_C.Prune"]=prune_list_hide;

                    
                }
               
            var shw_disp=[];
            var hide_disp=[];
            var crit_ord_dict=JSON.parse(JSON.stringify(crit_order_dict));
            var crit_hd_dict=JSON.parse(JSON.stringify(crit_hide_dict));

            var feat_dsp=crit_ord_dict[active_co+"_"+co_feature_active];
            feat_to_disp=feat_dsp;
            var feat_hide=crit_hd_dict[active_co+"_"+co_feature_active];
            feat_to_hide=feat_hide
            var flg="true";

        
            data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,flg)

           console.log("CRIT ORDER",crit_order_dict)
        }
        cdm_on_co_on_TreeView();

   }
    function Save_Cdm_CO_On(){
        current_save_state="CDM_on_CO_on"
        console.log("crit_order_dict",crit_order_dict);
        console.log("crit_hide_dict",crit_hide_dict);
        // make an ajax call that will send the two dicts to server. 
        $.ajax({
                                
                                        type: 'POST',
                                        dataType: "json",
                                        'data': {
                                        'featlevels_dic': JSON.stringify(block_feat_dict,undefined,''),
                                        'crit_order_dict':JSON.stringify(crit_order_dict),
                                        'crit_hide_dict':JSON.stringify(crit_hide_dict),
                                        'cataloglist':JSON.stringify(cataloglist),

                                        'csrfmiddlewaretoken': '{{ csrf_token }}',
                                        },
                                        
                                        url: "{% url 'cdm_on_co_on_criteriasetup' %}",
                                        success: function(data){
                                            if(exp_id===""){
                                                    exp_id = data['exp_id'];
                                                    custom_exp_id = data['custom_exp_id'];
                                                    showExpWIP()
                                                    }
                                                    if (data['block_list']!=null){
                                                        blockList = data['block_list']
                                                        table_blocks=draw_block_table(blockList)
                                                        display_blocktable(table_blocks);
                                                        window.localStorage.setItem("blockList", JSON.stringify(blockList));
                                                    }
                                                    showFeatureLvls_Active_CO();   
                                                    cdm_on_co_on_TreeView(); 
                                                                                  
                                        }
                                    });


    }
   </script>
<script>

    function selChangeFunc(element){
        role_data=$(element).val();
        console.log("role_data", role_data ); 
        active_co=role_data;
        var buttons=$("#set_button_cdm_off_co_on").find("button")
        $( buttons ).each(function( index ) {
            if ( $( this ).val()===role_data){
                console.log("VALE",$( this ).val())

                document.getElementById(role_data+"btn").style.backgroundColor = "#94000e"

            }
            else{
                document.getElementById($( this ).val()+"btn").style.backgroundColor = ""

            }
        
        });
        // $("#product_section").empty();
        // orderCriteriaHtmlSetup("CO",["CO.1","CO.2"],"true");
        // alert(active_co);
        $('#recent_hidden_div').empty();
        $('#hide_feature_div').empty();
        $("#display_feature_div").empty();
        // if ( crit_order_dict[active_co+"_C.Full"]===undefined){
        //     crit_order_dict[active_co+"_C.Full"]=default_crit_show_disp;
        //     crit_order_dict[active_co+"_C.Full"]=default_crit_hide_disp;
        //     console.log(active_co+"_C.Full")
        $("#main_row_co").remove();

        product_Section();
        //     get_data_Ajax_Co(['']);
        // }
        

        // var recenthiddenfeat_div=document.getElementById('recent_hidden_div');
        // console.log("recenthiddenfeat_div",recenthiddenfeat_div)
        // var h2=document.createElement('h2');
        // h2.innerHTML="Recent  Hidden Features";
        // var ul_mylist=document.createElement('ul');
        // ul_mylist.setAttribute('id','myList');
        // recenthiddenfeat_div.append(h2);
        // recenthiddenfeat_div.append(ul_mylist);
        
        // var hide_feature_div=document.getElementById('hide_feature_div');

        // var ul_hiddenfeat=document.createElement('ul');
        // ul_hiddenfeat.setAttribute("id","hiddenfeat");
        // hide_feature_div.append(ul_hiddenfeat);
        // have to change the checks as well... 
        if(default_active==="true"){
            if(crit_order_dict[active_co+"_Cdm.Def"]===undefined || crit_hide_dict[active_co+"_Cdm.Def"]===undefined){
                // set the default feature disp and hide here. along with mand and flag
                var feat_dsp=default_crit_show_disp;
                var feat_hide=default_crit_hide_disp;
                
            }
            else{
                data_obj_show=JSON.parse(JSON.stringify(crit_order_dict[active_co+"_Cdm.Def"]));
                data_obj_hide=JSON.parse(JSON.stringify(crit_hide_dict[active_co+"_Cdm.Def"]));

                var feat_dsp =data_obj_show;
                var feat_hide=data_obj_hide
                crit_flag="true";
            }  
        }
        else{
            // check to see if pruned is empty or not. 
            if(crit_order_dict[active_co+co_feature_active]===undefined || crit_hide_dict[active_co+co_feature_active]===undefined){
                // set the default feature disp and hide here. along with mand and flag
                var feat_dsp=default_crit_show_disp;
                var feat_hide=default_crit_hide_disp;
                
            }
            else{
                var feat_dsp =crit_order_dict[active_co+co_feature_active];
                var feat_hide=crit_hide_dict[active_co+co_feature_active];
                crit_flag="true";
            }  

        }

        var shw_disp=[];
        var hide_disp=[];

        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,crit_flag)

        
        if(default_active==="true"){
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

            crit_order_dict[active_co+"_Cdm.Def"]=data_obj_show;
            crit_hide_dict[active_co+"_Cdm.Def"]=data_obj_hide;
        }else{
            data_obj_show=JSON.parse(JSON.stringify(data['shw_disp']));
            data_obj_hide=JSON.parse(JSON.stringify(data['hide_disp']));

            crit_order_dict[active_co+co_feature_active]=data_obj_show;
            crit_hide_dict[active_co+co_feature_active]=data_obj_hide;
        }
           
            console.log("crit_order_dict->>",crit_order_dict);
            console.log("crit_hide_dict->>",crit_hide_dict);

            $('ul').sortable({
                axis: 'y',
                stop: function (event, ui) {
                var data = $(this).sortable('serialize').split("&");
                var arr=[];
                for (var key in data)
                {   
                    arr.push(data[key].split("=")[0].replace('[]',''));

                }
        
                                    // $('span').text(data);
                                    if (default_active==="true"){
                                        if (crit_order_dict[active_co+"_Cdm.Def"]===undefined){
                                        crit_order_dict[active_co+"_Cdm.Def"]=[]
                                        }
                                        else{
                                            data_obj_show=JSON.parse(JSON.stringify(arr));

                                            crit_order_dict[active_co+"_Cdm.Def"]=data_obj_show;
                                            crit_hide_dict[active_co+"_Cdm.Def"]=hide_disp;
                                            
                                            console.log("crit_order_dict-",crit_order_dict)
                                            console.log("crit_hide_dict-",crit_hide_dict);
                                      
                                                    
                                        }
                                    }
                                    else{
                                        if (crit_order_dict[active_co+co_feature_active]===undefined){
                                        crit_order_dict[active_co+co_feature_active]=[]
                                        }
                                        else{
                                            data_obj_show=JSON.parse(JSON.stringify(arr));

                                            crit_order_dict[active_co+co_feature_active]=data_obj_show;
                                            crit_hide_dict[active_co+co_feature_active]=hide_disp;
                                            
                                            console.log("crit_order_dict-",crit_order_dict)
                                            console.log("crit_hide_dict-",crit_hide_dict);
                                        }
                                   

                                    }


                                    
                                    cdm_off_co_on_TreeView();
                                }
                });
                cdm_off_co_on_TreeView();
        }
     
    function select_Cmd_Co_On_Changer(element){
        role_data=$(element).val();
        console.log("role_data", role_data ); 
        active_co=role_data;
        var buttons=$("#set_button_cdm_on_co_on").find("button")
        $( buttons ).each(function( index ) {
            if ( $( this ).val()===role_data){
                document.getElementById(role_data+"btn").style.backgroundColor = "#94000e"

            }
            else{
                document.getElementById($( this ).val()+"btn").style.backgroundColor = ""

            }
        
        });
         
    
        // $("#product_section").empty();
        // orderCriteriaHtmlSetup("CO",["CO.1","CO.2"],"true");
        // alert(active_co)
        $('#recent_hidden_div').empty();
        $('#hide_feature_div').empty();
        $("#display_feature_div").empty();
        // if ( crit_order_dict[active_co+"_C.Full"]===undefined){
        //     crit_order_dict[active_co+"_C.Full"]=default_crit_show_disp;
        //     crit_order_dict[active_co+"_C.Full"]=default_crit_hide_disp;
        //     console.log(active_co+"_C.Full")
    // }

        var recenthiddenfeat_div=document.getElementById('recent_hidden_div');
        console.log("recenthiddenfeat_div",recenthiddenfeat_div)
        var h2=document.createElement('h5');
        // h2.innerHTML="Recent  Hidden Features";
        var ul_mylist=document.createElement('ul');
        ul_mylist.setAttribute('id','myList');
        recenthiddenfeat_div.append(h2);
        recenthiddenfeat_div.append(ul_mylist);
        
        var hide_feature_div=document.getElementById('hide_feature_div');

        var ul_hiddenfeat=document.createElement('ul');
        ul_hiddenfeat.setAttribute("id","hiddenfeat");
        hide_feature_div.append(ul_hiddenfeat);
       
       
        var feat_dsp =JSON.parse(JSON.stringify(crit_order_dict[active_co+"_"+co_feature_active]));

        var feat_hide=JSON.parse(JSON.stringify(crit_hide_dict[active_co+"_"+co_feature_active]));
        crit_flag="true";


        var shw_disp=[];
        var hide_disp=[];
        data=htmlF(shw_disp,hide_disp,mandatory_list,feat_dsp,feat_hide,crit_flag)

        

           
            console.log("crit_order_dict->>",crit_order_dict);
            console.log("crit_hide_dict->>",crit_hide_dict);
            // $("#set_buttons_cdm_co").find("button").each(function( index ) {
            //     console.log($(this).attr("style").length);

            //     if (($(this).attr("style").length!==0)){
            //         console.log("COLOR",$(this).attr('id'))
            //         console.log($(this).attr("style"))
            //         button_active= $(this).attr('id');
                  
            //     }
            //     });
            // alert(button_active)
            alert(cdm_co_on_ord_button_active)
            if (cdm_co_on_ord_button_active!=="C.Prune"){
            $('ul').sortable({
                axis: 'y',
                stop: function (event, ui) {
                var data = $(this).sortable('serialize').split("&");
                var arr=[];
                for (var key in data)
                {   
                    arr.push(data[key].split("=")[0].replace('[]',''));

                }
        
                                    // $('span').text(data);
                                   
                                        if (crit_order_dict[active_co+"_"+co_feature_active]===undefined){
                                        crit_order_dict[active_co+"_"+co_feature_active]=[]
                                        }
                                        else{
                                            crit_order_dict[active_co+"_"+co_feature_active]=arr;
                                            crit_hide_dict[active_co+"_"+co_feature_active]=hide_disp;
                                            
                                            console.log("crit_order_dict-",crit_order_dict)
                                            console.log("crit_hide_dict-",crit_hide_dict);
                                        }
                                   

                     cdm_on_co_on_TreeView();

                    }
                });
            }
            cdm_on_co_on_TreeView();

        }
        
    function hideFromDisplay_Def_Cdm_CO_On(id) {
           var item = $('#'+id);
           console.log(id);
           var temp=document.getElementById(id);
          //  var temp = item;
          
          item.find(".show_hide").remove();
          var btn=document.createElement('button');
          btn.setAttribute('class','show_hide');
          btn.setAttribute('onclick','showToDisplay_Def_Cdm_CO_On($(this).parent().parent().parent().attr("id"))');
          btn.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');

          btn.innerHTML="show"
          var data = id.split("_");  
          console.log("data",data[0]);
          var arr=[];
          var elem="";
          for (var key in data)
                    {   
                        console.log("key",key);
                        arr.push(data[key]);
                        elem=data[key];
                        break;
                    } 
            item.remove();
            // if active_co doesnt exsist then user is using default func so 
            // check if active_co exists, if it doesn't then simply 
            // run default_crit_show_dict['default'].indexOf(elem);;;;
            var colist=block_feat_dict["CO"];
            // def_dict_show_obj=JSON.parse(JSON.stringify(default_crit_show_dict));
            for ( var co in colist){
                var koool=colist[co]+"_Cdm.Def";
                console.log("KOOOL",koool)
                        // if (crit_order_dict[koool]===undefined){
                        //     crit_order_dict[koool]=[]
                        //     crit_order_dict[koool]=def_dict_show_obj["C.Full"]
                        //     crit_hide_dict[koool]=[]
                console.log("crit_order_dict",crit_order_dict)
                        // }
                var index = crit_order_dict[koool].indexOf(elem);
                    console.log("INDEX",index)
                    if (index > -1) {
                        console.log("crit_order_dict[koool]--",crit_order_dict[koool])
                        crit_order_dict[koool].splice(index, 1);
                        console.log("crit_order_dict[koool]--",crit_order_dict[koool])
                        crit_hide_dict[koool].push(elem);
                        console.log("crit_hide_dict--",crit_hide_dict[koool])

                        }
                    }

              
                    var mylist=document.getElementById('myList');
                    
                    while (temp.firstChild) {
                    temp.removeChild(temp.firstChild);
                    }
                    console.log("lastchild",temp);
                    mylist.append(temp);

                    var div_row=document.createElement('div');
                    div_row.setAttribute('class','row');
                    temp.append(div_row);
                    var div_col_md_6_1=document.createElement('div');
                    div_col_md_6_1.setAttribute('class','col');
                    div_row.append(div_col_md_6_1);
                    var btn_btn_primary=document.createElement('btn');
                    btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                    btn_btn_primary.innerHTML=data[0];
                    btn_btn_primary.title=data[0];
                    div_col_md_6_1.append(btn_btn_primary);
                    var div_col_md_6_2=document.createElement('div');
                    div_col_md_6_2.setAttribute('class','col');
                    div_row.append(div_col_md_6_2);
                    div_col_md_6_2.append(btn);
                    console.log("crit_order_dict",crit_order_dict)
                    console.log("crit_hide_dict",crit_hide_dict)
                    cdm_off_co_on_TreeView();
         } 
    function showToDisplay_Def_Cdm_CO_On(id){
        console.log("showToDisplayid",id)
            var item = $("#"+id);
            //var item=document.getElementById(id)
            // var item = $(id);
             var temp = document.getElementById(id);
            item.find(".show_hide").remove();
            //  var btn = $('<button>Hide</button>').attr('width', '200px').addClass('show_hide').attr('onclick', '(hideFromDisplay($(this).parent().attr("id")))');
            var btn=document.createElement('button');
            btn.setAttribute('class','show_hide');
            btn.setAttribute('onclick',"hideFromDisplay_Def_Cdm_CO_On($(this).parent().parent().parent().attr('id'))");
            btn.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")

            btn.innerHTML="Hide";
            var data =item.attr('id');
            console.log("showToDisplay_data",data)
            var d=data.split("_");
            var arr=[]; 
            var elem='';
            console.log("Dddd",d)
                for (var key in d)
                  {   
                          console.log("key",key);
                          arr.push(d[key]);
                          elem=d[key];
                          console.log("ELEM",elem)
                          break;
                }
                item.remove();
        
                // temp.append(btn);
            /*
                    // if active_co doesnt exsist then user is using default func so 
                    // check if active_co exists, if it doesn't then simply 
                    // run default_crit_hide_dict['default'].indexOf(elem);;;;
            */
            
               
                    console.log("active_co",active_co)
                    var colist=block_feat_dict["CO"];
                    for (var co in colist){
                        var koool=colist[co]+"_Cdm.Def"
                        var index = crit_hide_dict[koool].indexOf(elem);
                        console.log("INDEX",index)
                        if (index > -1) {
                        crit_hide_dict[koool].splice(index, 1);
                        crit_order_dict[koool].push(elem);

                        }
                    }
                    console.log("crit_order_dict>>>>",crit_order_dict);
                    console.log("crit_hide_dict>>>>",crit_hide_dict);
                   
                
            
            
         
                var ul_sortable=document.getElementById('sortable');
                ul_sortable.append(temp);
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
        
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                temp.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute("class","sortable_custom_show_btns");
                btn_btn_primary.innerHTML=d[0];
                btn_btn_primary.title=d[0];

                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute("class","col");
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.appendChild(btn);
                cdm_off_co_on_TreeView();
    }
    function hideFromDisplay(id) {
           var item = $('#'+id);
           console.log(id);
           var temp=document.getElementById(id);
          //  var temp = item;
          
          item.find(".show_hide").remove();
          //  var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay('+id+'))');
          // var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay($(this).parent().attr("id")))');
          var btn=document.createElement('button');
          btn.setAttribute('class','show_hide');
          btn_show_hide.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');
          btn.setAttribute('onclick','showToDisplay($(this).parent().parent().parent().attr("id"))');
          btn.innerHTML="show"
          var data = id.split("_");  
          console.log("data",data[0]);
          var arr=[];
          var elem="";
          for (var key in data)
                    {   
                        console.log("key",key);
                        arr.push(data[key]);
                        elem=data[key];
                        break;
                    } 
            item.remove();
            // if active_co doesnt exsist then user is using default func so 
            // check if active_co exists, if it doesn't then simply 
            // run default_crit_show_dict['default'].indexOf(elem);;;;
            if(default_active==="true"){
                if(crit_order_dict[active_co+"_Cdm.Def"]===undefined || crit_hide_dict[active_co+"_Cdm.Def"]===undefined){
                    var index =  default_crit_show_dict['default'].indexOf(elem);
                    if (index > -1) {
                    default_crit_show_dict['Cdm.Def'].splice(index, 1);
                    }
                    default_crit_hide_dict['Cdm.Def'].push(elem);
                }
                else{
                    console.log("active_co",active_co)
                    console.log("crit_order_dict",crit_order_dict)

                    var index = crit_order_dict[active_co+"_Cdm.Def"].indexOf(elem);
                    if (index > -1) {
                    crit_order_dict[active_co+"_Cdm.Def"].splice(index, 1);
                        }
                
                    crit_hide_dict[active_co+"_Cdm.Def"].push(elem);
                    console.log("crit_order_dict###",crit_order_dict);
                    console.log("crit_hide_dict###",crit_hide_dict);
                    console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                    console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);


                }
            }
            else {
                var koool=active_co+co_feature_active;
                console.log("KOOOL",koool)
                if(crit_order_dict[koool]===undefined || crit_hide_dict[koool]===undefined){
                    var index =  default_crit_show_dict['default'].indexOf(elem);
                    if (index > -1) {
                    default_crit_show_dict['Cdm.Def'].splice(index, 1);
                    }
                    default_crit_hide_dict['Cdm.Def'].push(elem);
                }
                else{
                    console.log("active_co",active_co)
                    console.log("co_feature_active-del",co_feature_active)
                    console.log("crit_order_dict[active_co_co_feature_active]",crit_order_dict[koool])

                    var index = crit_order_dict[koool].indexOf(elem);
                    if (index > -1) {
                    console.log("crit_order_dict[koool]@@@",crit_order_dict)

                    crit_order_dict[koool].splice(index, 1);
                   
                        }
                
                    crit_hide_dict[koool].push(elem);
                    console.log("crit_hide_dict[active_co_co_feature_active]@@@",crit_hide_dict[koool])

                }
                console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);
                console.log("crit_order_dict###",crit_order_dict);
                console.log("crit_hide_dict###",crit_hide_dict);


            }

                    var mylist=document.getElementById('myList');
                    
                    while (temp.firstChild) {
                    temp.removeChild(temp.firstChild);
                    }
                    console.log("lastchild",temp);
                    mylist.append(temp);

                    var div_row=document.createElement('div');
                    div_row.setAttribute('class','row');
                    temp.append(div_row);
                    var div_col_md_6_1=document.createElement('div');
                    div_col_md_6_1.setAttribute('class','col');
                    div_row.append(div_col_md_6_1);
                    var btn_btn_primary=document.createElement('btn');
                    btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');

                    btn_btn_primary.innerHTML=data[0];
                    btn_btn_primary.title=data[0];

                    div_col_md_6_1.append(btn_btn_primary);
                    var div_col_md_6_2=document.createElement('div');
                    div_col_md_6_2.setAttribute('class','col');
                    div_row.append(div_col_md_6_2);
                    div_col_md_6_2.append(btn);
         } 
    function showToDisplay(id) {
            console.log("showToDisplayid",id)
            var item = $("#"+id);
            //var item=document.getElementById(id)
            // var item = $(id);
            var temp = document.getElementById(id);
            item.find(".show_hide").remove();
            //  var btn = $('<button>Hide</button>').attr('width', '200px').addClass('show_hide').attr('onclick', '(hideFromDisplay($(this).parent().attr("id")))');
            var btn=document.createElement('button');
            btn.setAttribute('class','show_hide');btn.setAttribute('onclick',"hideFromDisplay($(this).parent().parent().parent().attr('id'))");
            btn_show_hide.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")

            btn.innerHTML="Hide";
            var data =item.attr('id');
            console.log("showToDisplay_data",data)
            var d=data.split("_");
            var arr=[]; 
            var elem='';
            console.log("Dddd",d)
                for (var key in d)
                  {   
                          console.log("key",key);
                          arr.push(d[key]);
                          elem=d[key];
                          console.log("ELEM",elem)
                          break;
                }
                item.remove();
        
                // temp.append(btn);
            /*
                    // if active_co doesnt exsist then user is using default func so 
                    // check if active_co exists, if it doesn't then simply 
                    // run default_crit_hide_dict['default'].indexOf(elem);;;;
            */
            if(default_active==="true"){
                if(crit_order_dict[active_co+"_Cdm.Def"]===undefined || crit_hide_dict[active_co+"_Cdm.Def"]===undefined){
                    var index = default_crit_hide_dict['Cdm.Def'].indexOf(elem);
                        if (index > -1) {
                            default_crit_hide_dict['Cdm.Def'].splice(index, 1);
                            }
                    default_crit_show_dict['Cdm.Def'].push(elem);
                    console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                    console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);

                }
                else{
                    var index = crit_hide_dict[active_co+"_Cdm.Def"].indexOf(elem);
                    console.log("INDEX",index)
                            if (index > -1) {
                            crit_hide_dict[active_co+"_Cdm.Def"].splice(index, 1);
                                    }
                    
                    crit_order_dict[active_co+"_Cdm.Def"].push(elem);
                    console.log("crit_order_dict>>>>",crit_order_dict);
                    console.log("crit_hide_dict>>>>",crit_hide_dict);
                    console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                    console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);

                }
            }

            else{
                if(crit_order_dict[active_co+co_feature_active]===undefined || crit_hide_dict[active_co+co_feature_active]===undefined){
                    var index = default_crit_hide_dict['default'].indexOf(elem);
                    console.log("INDEX",index)
                        if (index > -1) {
                            default_crit_hide_dict['default'].splice(index, 1);
                            }
                
                    default_crit_show_dict['default'].push(elem);
                    console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                    console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);

                }
                else{
                    console.log("active_co",active_co)
                    var index = crit_hide_dict[active_co+co_feature_active].indexOf(elem);
                    console.log("INDEX",index)
                            if (index > -1) {
                            crit_hide_dict[active_co+co_feature_active].splice(index, 1);
                                    }
                    
                    crit_order_dict[active_co+co_feature_active].push(elem);
                    console.log("crit_order_dict>>>>",crit_order_dict);
                    console.log("crit_hide_dict>>>>",crit_hide_dict);
                    console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                    console.log("default_crit_hide_dict>>>>",default_crit_hide_dict);

                }
            }
            
        
            
                
                var ul_sortable=document.getElementById('sortable');
                ul_sortable.append(temp);
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
        
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                temp.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute('class','sortable_custom_show_btns');
                btn_btn_primary.innerHTML=d[0];
                btn_btn_primary.title=data[0];

                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute("class","col");
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.appendChild(btn);
           
         }
        
    function hide_show_order_display_Default_TreeView(){
        $("#default_tree_view_div").empty();

                                
                    var main_treeview_list=[];
                    var main_treeview_dict={};

                    main_treeview_dict['name']="Default Criteria Tree View";
                    mainchildlist=[];
                    var defaut_criteria_order_dict={};
                    var defaut_criteria_order_dict_childlist=[];
                    defaut_criteria_order_dict['name']='Defaut criteria order';

                            for (var i in static_default_crit_show_dict['default'])
                            {
                                
                                var defaut_criteria_order_child_dict={};
                                defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['default'][i];
                                defaut_criteria_order_child_dict['childern']=[];
                                defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                            }
                    defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                mainchildlist.push(defaut_criteria_order_dict);
                    

                    var default_cdm_dict={};
                    var default_cdm_childlist=[];
                    default_cdm_dict['name']="Default CDM";
                        var default_selected_criteria_dict={};
                        var default_selected_criteria_childlist=[];
                        default_selected_criteria_dict['name']="Default Selected";
                                    for (var i in default_crit_show_dict['default']){
                                        var default_selected_child_dict={};
                                        default_selected_child_dict['name']= default_crit_show_dict['default'][i];
                                        default_selected_child_dict['children']=[];
                                        default_selected_criteria_childlist.push(default_selected_child_dict);

                                    }
                        default_selected_criteria_dict['children']=default_selected_criteria_childlist;
                    default_cdm_childlist.push(default_selected_criteria_dict);
                    default_cdm_dict['children']=default_cdm_childlist;
                
                        var default_hidden_criteria_dict={};
                        var default_hidden_criteria_childlist=[];  
                        default_hidden_criteria_dict['name']="Default Hidden";
                                    for (var i in default_crit_hide_dict['default']){
                                        var default_hidden_child_dict={};
                                        default_hidden_child_dict['name']= default_crit_hide_dict['default'][i];
                                        default_hidden_child_dict['children']=[];
                                        default_hidden_criteria_childlist.push(default_hidden_child_dict);

                                    }            
                        default_hidden_criteria_dict['children']=default_hidden_criteria_childlist;
                    default_cdm_childlist.push(default_hidden_criteria_dict);
                    default_cdm_dict['children']=default_cdm_childlist;
                mainchildlist.push(default_cdm_dict);

                                    
                        
                    



                main_treeview_dict['children']=mainchildlist
                main_treeview_list.push(main_treeview_dict);










            var tree=main_treeview_list;
            //
            // Create tree
            //
            var t = new TreeView(tree, 'default_tree_view_div');        
            t.expandAll(); 

    }
    function hideFromDisplay_Default(id) {
           var item = $('#'+id);
           console.log(id);
           var temp=document.getElementById(id);
          //  var temp = item;
          
          item.find(".show_hide").remove();
          //  var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay('+id+'))');
          // var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay($(this).parent().attr("id")))');
          var btn=document.createElement('button');
          btn.setAttribute('class','show_hide');
          btn.setAttribute('onclick','showToDisplay_Default($(this).parent().parent().parent().attr("id"))');
          btn.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');

          btn.innerHTML="show"
          var data = id.split("_");  
          console.log("data",data[0]);
          var arr=[];
          var elem="";
          for (var key in data)
                    {   
                        console.log("key",key);
                        arr.push(data[key]);
                        elem=data[key];
                        break;
                    } 
            item.remove();
            // if active_co doesnt exsist then user is using default func so 
            // check if active_co exists, if it doesn't then simply 
            // run default_crit_show_dict['default'].indexOf(elem);;;;
            if (crit_order_dict[active_co]===undefined){
             
                var index =  default_crit_show_dict['default'].indexOf(elem);
                if (index > -1) {
                default_crit_show_dict['default'].splice(index, 1);
                }
                default_crit_hide_dict['default'].push(elem);
                }
                console.log("default_crit_show_dict@@@",default_crit_show_dict);
                console.log("default_crit_hide_dict@@@",default_crit_hide_dict);

          
                    var mylist=document.getElementById('myList');
                    
                    while (temp.firstChild) {
                    temp.removeChild(temp.firstChild);
                    }
                    console.log("lastchild",temp);
                    mylist.append(temp);

                    var div_row=document.createElement('div');
                    div_row.setAttribute('class','row');
                    temp.append(div_row);
                    var div_col_md_6_1=document.createElement('div');
                    div_col_md_6_1.setAttribute('class','col');
                    div_row.append(div_col_md_6_1);
                    var btn_btn_primary=document.createElement('btn');
                    btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                    btn_btn_primary.innerHTML=data[0];
                    btn_btn_primary.title=data[0];
                    div_col_md_6_1.append(btn_btn_primary);
                    var div_col_md_6_2=document.createElement('div');
                    div_col_md_6_2.setAttribute('class','col');
                    div_row.append(div_col_md_6_2);
                    div_col_md_6_2.append(btn);

                  
        hide_show_order_display_Default_TreeView();   



         } 
    
    function showToDisplay_Default(id) {
            var item = $("#"+id);
            //var item=document.getElementById(id)
            // var item = $(id);
            var temp = document.getElementById(id);
            item.find(".show_hide").remove();
            //  var btn = $('<button>Hide</button>').attr('width', '200px').addClass('show_hide').attr('onclick', '(hideFromDisplay($(this).parent().attr("id")))');
            var btn=document.createElement('button');
            btn.setAttribute('class','show_hide');
            btn.setAttribute('onclick',"hideFromDisplay_Default($(this).parent().parent().parent().attr('id'))");
            btn.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")

            btn.innerHTML="Hide";
            var data =item.attr('id');
            console.log("showToDisplay_data",data)
            var d=data.split("_");
            var arr=[]; 
            var elem='';
            console.log("Dddd",d)
                for (var key in d)
                  {   
                          console.log("key",key);
                          arr.push(d[key]);
                          elem=d[key];
                          console.log("ELEM",elem)
                          break;
                }
                item.remove();
        
                // temp.append(btn);
            /*
                    // if active_co doesnt exsist then user is using default func so 
                    // check if active_co exists, if it doesn't then simply 
                    // run default_crit_hide_dict['default'].indexOf(elem);;;;
            */
            if (crit_hide_dict[active_co]===undefined){
                var index = default_crit_hide_dict['default'].indexOf(elem);
                console.log("INDEX",index)
                    if (index > -1) {
                        default_crit_hide_dict['default'].splice(index, 1);
                        }
            
                default_crit_show_dict['default'].push(elem);
                console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                console.log("default_crit_show_dict>>>>",default_crit_hide_dict);
            }
           
            
                
                var ul_sortable=document.getElementById('sortable');
                ul_sortable.append(temp);
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
        
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                temp.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute('class','sortable_custom_show_btns');
                btn_btn_primary.innerHTML=d[0];
                btn_btn_primary.title=data[0];
                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute("class","col");
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.appendChild(btn);



        hide_show_order_display_Default_TreeView();









               
         }

    function cdm_off_co_on_TreeView(){
        var colist=block_feat_dict['CO'];
                        $("#cdm_off_co_on_tree_view_div").empty();
                        var main_treeview_list=[];
                        var main_treeview_dict={};

                                main_treeview_dict['name']="Cdm off Co on Criteria Tree View";
                                mainchildlist=[];
                                var criteria_order_dict={};
                                var criteria_order_dict_childlist=[];
                                criteria_order_dict['name']='Criteria order';
                                for (co in colist){
                                    var co_dyn_dict={};
                                    var co_dyn_child_list=[];
                                    co_dyn_dict['name']=[colist[co]+"_Cdm.Def"];
                                        for (var j in crit_order_dict[colist[co]+"_Cdm.Def"]){
                                            var criteria_order_child_dict={};
                                            criteria_order_child_dict['name']=crit_order_dict[colist[co]+"_Cdm.Def"][j];
                                            criteria_order_child_dict['childern']=[];
                                            co_dyn_child_list.push(criteria_order_child_dict);

                                        }
                                    co_dyn_dict['children']=co_dyn_child_list;
                                criteria_order_dict_childlist.push(co_dyn_dict);
                                criteria_order_dict['children']=criteria_order_dict_childlist;
                                }
                        mainchildlist.push(criteria_order_dict);
                        for (co in colist)
                        var default_cdm_dict={};
                        var default_cdm_childlist=[];
                        default_cdm_dict['name']="Default CDM";
                            var default_selected_criteria_dict={};
                            var default_selected_criteria_childlist=[];
                            default_selected_criteria_dict['name']="Default Selected";
                                        for (var i in crit_order_dict["CO.1_Cdm.Def"]){
                                            var default_selected_child_dict={};
                                            var ele=JSON.parse(JSON.stringify(crit_order_dict["CO.1_Cdm.Def"][i]));

                                            default_selected_child_dict['name']=ele;
                                            default_selected_child_dict['children']=[];
                                            default_selected_criteria_childlist.push(default_selected_child_dict);

                                        }
                            default_selected_criteria_dict['children']=default_selected_criteria_childlist;
                        default_cdm_childlist.push(default_selected_criteria_dict);
                        default_cdm_dict['children']=default_cdm_childlist;
                    
                            var default_hidden_criteria_dict={};
                            var default_hidden_criteria_childlist=[];  
                            default_hidden_criteria_dict['name']="Default Hidden";
                                        for (var i in crit_hide_dict["CO.1_Cdm.Def"]){
                                            var default_hidden_child_dict={};
                                            default_hidden_child_dict['name']= crit_hide_dict[colist[co]+"_Cdm.Def"][i];
                                            default_hidden_child_dict['children']=[];
                                            default_hidden_criteria_childlist.push(default_hidden_child_dict);

                                        }            
                            default_hidden_criteria_dict['children']=default_hidden_criteria_childlist;
                        default_cdm_childlist.push(default_hidden_criteria_dict);
                        default_cdm_dict['children']=default_cdm_childlist;
                   
                mainchildlist.push(default_cdm_dict);



                        main_treeview_dict['children']=mainchildlist


                        main_treeview_list.push(main_treeview_dict);
                        var tree=main_treeview_list;
                        //
                        // Create tree
                        //
                        var t = new TreeView(tree, 'cdm_off_co_on_tree_view_div');
                        t.expandAll(); 

    }
    function def_crit_cdm_on_co_off_TreeView(){
        $("#cdm_on_co_off_tree_view_div").empty();
                var main_treeview_list=[];
                var main_treeview_dict={};
                main_treeview_dict['name']="Cdm On CO Off Criteria Tree View";
                mainchildlist=[];
                        var defaut_criteria_order_dict={};
                        defaut_criteria_order_dict_childlist=[];
                        defaut_criteria_order_dict['name']='Defaut criteria order';
                        for (var i in default_crit_show_dict['cdm'])
                        {
                            
                            var defaut_criteria_order_child_dict={};
                            defaut_criteria_order_child_dict['name']=default_crit_show_dict['cdm'][i];
                            defaut_criteria_order_child_dict['childern']=[];
                            defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                        }
                        defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
                mainchildlist.push(defaut_criteria_order_dict);
                        var active_cdm_dict={};
                        var active_cdm_childlist=[];
                        active_cdm_dict['name']="Active CDM";
                            var cfull_criteria_dict={};
                            var cfull_criteria_childlist=[];
                            cfull_criteria_dict['name']="C.Full";
                                var full_selected_dict={};
                                var full_selected_childlist=[];
                                full_selected_dict['name']="Full Selected";
                                for (var i in cdm_crit_show_dict['c.full']){
                                    var full_single_crit_dict={};
                                    full_single_crit_dict['name']=cdm_crit_show_dict['c.full'][i];
                                    full_single_crit_dict['children']=[];
                                    full_selected_childlist.push(full_single_crit_dict);
                                }
                                full_selected_dict['children']=full_selected_childlist;
                            cfull_criteria_childlist.push(full_selected_dict);
                                var full_hidden_dict={};
                                var full_hidden_childlist=[];
                                full_hidden_dict['name']="Full Hidden";
                                for (var i in cdm_crit_hide_dict['c.full']){
                                    var full_single_crit_hidden_dict={};
                                    full_single_crit_hidden_dict['name']=cdm_crit_hide_dict['c.full'][i];
                                    full_single_crit_hidden_dict['children']=[];
                                    full_hidden_childlist.push(full_single_crit_hidden_dict);
                                }
                                full_hidden_dict['children']=full_hidden_childlist;
                            cfull_criteria_childlist.push(full_hidden_dict);

                            cfull_criteria_dict['children']=cfull_criteria_childlist;
                        active_cdm_childlist.push(cfull_criteria_dict);
                        if (cdm_full_btn_on==="false" || cdm_crit_show_dict['c.pruned']!==undefined){

                        
                            var cprune_criteria_dict={};
                            var cprune_criteria_childlist=[];
                            cprune_criteria_dict['name']="C.Prune";
                                var prune_selected_dict={};
                                var prune_selected_childlist=[];
                                prune_selected_dict['name']="Prune Selected";
                                for (var i in cdm_crit_show_dict['c.pruned']){
                                    var prune_single_crit_dict={};
                                    prune_single_crit_dict['name']=cdm_crit_show_dict['c.pruned'][i];
                                    prune_single_crit_dict['children']=[];
                                    prune_selected_childlist.push(prune_single_crit_dict);
                                }
                                prune_selected_dict['children']=prune_selected_childlist;
                            cprune_criteria_childlist.push(prune_selected_dict);
                                var prune_hidden_dict={};
                                var prune_hidden_childlist=[];
                                prune_hidden_dict['name']="Prune Hidden";
                                for (var i in cdm_crit_hide_dict['c.pruned']){
                                    var prune_single_crit_hidden_dict={};
                                    prune_single_crit_hidden_dict['name']=cdm_crit_hide_dict['c.pruned'][i];
                                    prune_single_crit_hidden_dict['children']=[];
                                    prune_hidden_childlist.push(prune_single_crit_hidden_dict);
                                }
                                prune_hidden_dict['children']=prune_hidden_childlist;
                            cprune_criteria_childlist.push(prune_hidden_dict);
                            cprune_criteria_dict['children']=cprune_criteria_childlist;
                        active_cdm_childlist.push(cprune_criteria_dict);
                        }



                        active_cdm_dict['children']=active_cdm_childlist;
                mainchildlist.push(active_cdm_dict);
                main_treeview_dict['children']=mainchildlist
                main_treeview_list.push(main_treeview_dict);
                
                
                
                
                
    var tree=main_treeview_list;
    var t = new TreeView(tree, 'cdm_on_co_off_tree_view_div');
    t.expandAll(); 
    }
    function hideFromDisplay_CDM(id){
        var item = $('#'+id);
        console.log(id);
        var temp=document.getElementById(id);
        //  var temp = item;
          
        item.find(".show_hide").remove();
        //  var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay('+id+'))');
        // var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay($(this).parent().attr("id")))');
        var btn=document.createElement('button');
        btn.setAttribute('class','show_hide');
        btn.setAttribute('onclick','showToDisplay_CDM($(this).parent().parent().parent().attr("id"))');
        btn.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');

        btn.innerHTML="show"
        var data = id.split("_");  
        console.log("data",data[0]);
        var arr=[];
        var elem="";
        for (var key in data)
                {   
                    console.log("key",key);
                    arr.push(data[key]);
                    elem=data[key];
                    break;
                } 
        item.remove();
        if (cdm_full_btn_on==="true"){
            console.log("cdm_full_btn_on1.1 hide",cdm_full_btn_on)
            cdm_hide_list=cdm_crit_hide_dict['c.full'];
            cdm_show_list=cdm_crit_show_dict['c.full'];




        }else{
            console.log("cdm_full_btn_on1.2 hide",cdm_full_btn_on)
            console.log("cdm_crit_show_dict--prunecheck",cdm_crit_show_dict)

            console.log("cdm_crit_hide_dict--prunecheck",cdm_crit_hide_dict)
            cdm_hide_list=cdm_crit_hide_dict['c.pruned']
            cdm_show_list=cdm_crit_show_dict['c.pruned']



        }
            // if active_co doesnt exsist then user is using default func so 
            // check if active_co exists, if it doesn't then simply 
            // run default_crit_show_dict['default'].indexOf(elem);;;;
            
            // if (crit_order_dict[active_co]===undefined){
                // a check here to see which full or prune active
                // if (cdm_full_btn_on==="false"){
                //     var index = cdm_crit_show_dict['c.full'].indexOf(elem);

                // }else{
                //     var index = cdm_crit_show_dict['c.prune'].indexOf(elem);

                // }
                var index = cdm_show_list.indexOf(elem);
                if (index > -1) {
                // check which if pruned or full on, onthe basis of it fetch the 
                // value from key.... 
                // if (cdm_full_btn_on==="false"){
                //     cdm_crit_show_dict['c.full'].splice(index, 1);
                // }else{
                //     cdm_crit_show_dict['c.prune'].splice(index, 1);
                //     console.log("cdm_crit_show_dict['c.prune']$$$",cdm_crit_show_dict['c.prune'])
                // }
                cdm_show_list.splice(index, 1);
                }
                // if (cdm_full_btn_on==="false"){
                //     cdm_crit_hide_dict['c.full'].push(elem);

                // }else{
                //     cdm_crit_hide_dict['c.prune'].push(elem);
                //     console.log("cdm_crit_hide_dict['c.prune']",cdm_crit_hide_dict['c.prune'])

                // }
                cdm_hide_list.push(elem);

                // }
                if (cdm_full_btn_on==="true"){
                    console.log("cdm_full_btn_on2.1 hide",cdm_full_btn_on)

                cdm_crit_hide_dict['c.full']=cdm_hide_list
                cdm_crit_show_dict['c.full']=cdm_show_list

                }
                else{
                    console.log("cdm_full_btn_on2.2 hide",cdm_full_btn_on)

                cdm_crit_hide_dict['c.pruned']= cdm_hide_list
                cdm_crit_show_dict['c.pruned']= cdm_show_list

   
                }
                console.log("cdm_crit_show_dict@@@",cdm_crit_show_dict)
                console.log("cdm_crit_hide_dict@@@",cdm_crit_hide_dict)

          
                var mylist=document.getElementById('myList');
                
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
                console.log("lastchild",temp);
                mylist.append(temp);

                var div_row=document.createElement('div');
                div_row.setAttribute('class','row');
                temp.append(div_row);
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute('class','col');
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('btn');
                btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                btn_btn_primary.innerHTML=data[0];
                btn_btn_primary.title=data[0];

                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute('class','col');
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.append(btn);
                def_crit_cdm_on_co_off_TreeView();

    }
    function showToDisplay_CDM(id){
        var item = $("#"+id);
            //var item=document.getElementById(id)
            // var item = $(id);
             var temp = document.getElementById(id);
                item.find(".show_hide").remove();
                //  var btn = $('<button>Hide</button>').attr('width', '200px').addClass('show_hide').attr('onclick', '(hideFromDisplay($(this).parent().attr("id")))');
                var btn=document.createElement('button');btn.setAttribute('class','show_hide');btn.setAttribute('onclick',"hideFromDisplay_CDM($(this).parent().parent().parent().attr('id'))");
                btn.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")

                btn.innerHTML="Hide";
                var data =item.attr('id');
                console.log("showToDisplay_data",data)
                var d=data.split("_");
                var arr=[]; 
                var elem='';
                console.log("Dddd",d)
                for (var key in d)
                  {   
                          console.log("key",key);
                          arr.push(d[key]);
                          elem=d[key];
                          console.log("ELEM",elem)
                          break;
                }
                item.remove();
        
                // temp.append(btn);
            /*
                    // if active_co doesnt exsist then user is using default func so 
                    // check if active_co exists, if it doesn't then simply 
                    // run default_crit_hide_dict['default'].indexOf(elem);;;;
            */
            if (cdm_full_btn_on==="true"){
                console.log("cdm_full_btn_on1.1 show",cdm_full_btn_on)

                cdm_hide_list=cdm_crit_hide_dict['c.full']
                cdm_show_list=cdm_crit_show_dict['c.full']
            }else{
                console.log("cdm_full_btn_on1.2 show",cdm_full_btn_on)
                console.log("cdm_crit_show_dict--prunecheck",cdm_crit_show_dict)

                console.log("cdm_crit_hide_dict--prunecheck",cdm_crit_hide_dict)
                cdm_hide_list=cdm_crit_hide_dict['c.pruned']
                cdm_show_list=cdm_crit_show_dict['c.pruned']
            }
            if (crit_hide_dict[active_co]===undefined){
                var index = cdm_hide_list.indexOf(elem);
                // if (cdm_full_btn_on==="false"){
                //     console.log("cdm_crit_hide_dict['c.full']^^^",cdm_crit_hide_dict['c.full'])

                //     var index = cdm_crit_hide_dict['c.full'].indexOf(elem);

                // }
                // else{
                //     console.log("cdm_crit_hide_dict['c.prune']^^^",cdm_crit_hide_dict['c.prune'])
                //     var index = cdm_crit_hide_dict['c.prune'].indexOf(elem);

                // }
                console.log("INDEX",index)
                    if (index > -1) {
                        // if (cdm_full_btn_on==="false"){
                        //     cdm_crit_hide_dict['c.full'].splice(index, 1);
                        // }else{
                        //     cdm_crit_hide_dict['c.prune'].splice(index, 1);
                        // }
                        cdm_hide_list.splice(index, 1);
                        }
                        // if (cdm_full_btn_on==="false"){
                        //     cdm_crit_show_dict['c.full'].push(elem);

                        // }
                        // else{
                        //     cdm_crit_show_dict['c.prune'].push(elem);

                        // }
                        cdm_show_list.push(elem);
                        
            }   
            if (cdm_full_btn_on==="true"){
                console.log("cdm_full_btn_on2.1 show",cdm_full_btn_on)

                cdm_crit_hide_dict['c.full']=cdm_hide_list
                cdm_crit_show_dict['c.full']=cdm_show_list
            }else{
                console.log("cdm_full_btn_on2.2 show",cdm_full_btn_on)

                cdm_crit_hide_dict['c.pruned']=cdm_hide_list
                cdm_crit_show_dict['c.pruned']=cdm_show_list
            }

                console.log("cdm_crit_show_dict****",cdm_crit_show_dict)
                console.log("cdm_crit_hide_dict****",cdm_crit_hide_dict)

                
                var ul_sortable=document.getElementById('sortable');
                ul_sortable.append(temp);
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
        
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                temp.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute('class','sortable_custom_show_btns');
                btn_btn_primary.innerHTML=d[0];
                btn_btn_primary.title=data[0];
                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute("class","col");
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.appendChild(btn);
                def_crit_cdm_on_co_off_TreeView();


    }

    function brandCheck_box(element){
        if (brand_set_dict[active_button]===undefined){
            brand_set_dict[active_button]=[];
        }
        
       
        if (element.checked === true){
            brand_set_dict[active_button].push(element.value);
            console.log("brand_set_dict!!!",brand_set_dict);
            $.ajax({
                type:"POST",
                dataType:"json",
                'data':{
                    'brands':JSON.stringify(brand_set_dict[active_button]),
                    'price':JSON.stringify(slider_set_dict[active_button]),
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                url: "{% url 'getReqPhones' %}",
                        success: function(data){
                            console.log(data['mobilephones']);
                                $('#mobile_catalog_div').empty();                            
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                    // if (i%3===0 && i!==0){
                                    //     console.log("asd",i)
                                    //     var hr=document.createElement('hr');
                                    //     lps.append(hr); 
                                    //     var rtc=document.createElement('DIV');
                                    //     rtc.setAttribute("class","row text-center");
                                    //     lps.append(rtc);
                                      
                                    // }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=slider_set_dict[active_button];

                                    if (slider_set_dict[active_button]===undefined){
                                        slider_set_dict[active_button]=[]
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }else{
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }
                                    // console.log('slider_set_dict',slider_set_dict)
                                    if (phoneset_dic[active_button]===undefined    ){
                                        phoneset_dic[active_button]=[];

                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    link.target='_blank';


                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager)
                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize: 9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();
                        }
                });
        }
        else{
            // // run the query and return the num of mob phones and populate mobile_catalog_div on success. 

            ind=brand_set_dict[active_button].indexOf(element.value),1
            brand_set_dict[active_button].splice(ind,1);
            console.log("brand dic>>>",brand_set_dict)
            $.ajax({
                type:"POST",
                dataType:"json",
                'data':{
                    'brands':JSON.stringify(brand_set_dict[active_button]),
                    'price':JSON.stringify(slider_set_dict[active_button]),
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                url: "{% url 'getReqPhones' %}",
                        success: function(data){
                        console.log(data['mobilephones']);
                                $('#mobile_catalog_div').empty();                            
                                // var json_data_mobiles=data['samsung_phones']
                                var json_data_mobiles=data['mobilephones']
                                // var row_fluid=document.createElement('div');
                                // row_fluid.setAttribute('class','row-fluid');
                                // row_fluid.setAttribute('id','mobile_catalog_div');
                                row_fluid=$('#mobile_catalog_div');
                                var row=document.createElement('div');
                                row.setAttribute('class','row');
                                row_fluid.append(row);
                                var col_md_12=document.createElement("div");
                                col_md_12.setAttribute('class','col-md-12');
                                row.append(col_md_12);
                                var lps=document.createElement("div");
                                lps.setAttribute("class",'latest-product-section');
                                col_md_12.append(lps);
                                var rtc=document.createElement('DIV');
                                rtc.setAttribute("class","row text-center");
                                lps.append(rtc);
                                for (var i=0;i<json_data_mobiles.length;i++){
                                   
                                    // if (i%3===0 && i!==0){
                                    //     console.log("asd",i)
                                    //     var hr=document.createElement('hr');
                                    //     lps.append(hr); 
                                    //     var rtc=document.createElement('DIV');
                                    //     rtc.setAttribute("class","row text-center");
                                    //     lps.append(rtc);
                                      
                                    // }
                                    var col_md_4_post=document.createElement('DIV');
                                    col_md_4_post.setAttribute("class","col-md-4 sm-margin-b-50 pull-left post");
                                    rtc.append(col_md_4_post);
                                    var margin_b_20=document.createElement('DIV');
                                    margin_b_20.setAttribute("class","margin-b-20");
                                    col_md_4_post.append(margin_b_20);
                                    var input_checkb=document.createElement('input');
                                    input_checkb.type="checkbox";
                                    var temp_set_val_list=[];
                                    temp_set_val_list=slider_set_dict[active_button];
                                    // console.log("temp_set_val_list",temp_set_val_list)

                                    if (slider_set_dict[active_button]===undefined){
                                        slider_set_dict[active_button]=[]
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }else{
                                        slider_set_dict[active_button]=temp_set_val_list
                                    }
                                    // console.log('slider_set_dict',slider_set_dict)
                                    if (phoneset_dic[active_button]===undefined    ){
                                        phoneset_dic[active_button]=[];

                                    }
                                    else{
                                        //  a check to check if the retrieved mob id matches the id in the list 
                                        
                                        if (phoneset_dic[active_button].includes(json_data_mobiles[i]['id'])){
                                            input_checkb.checked=true;
                                        }

                                    }
                                    input_checkb.value=json_data_mobiles[i]['id'];
                                    input_checkb.id=json_data_mobiles[i]['id']+"cat";
                                    input_checkb.name=json_data_mobiles[i]['id']+"-"+json_data_mobiles[i]['Mobile_Name'];
                                    input_checkb.setAttribute('onchange','toggleCheckbox(this)')
                                    var img=document.createElement('img');
                                    img.setAttribute('class','img-responsive')
                                    // console.log("/static/"+json_data_mobiles[i]['imagepath1'])
                                    img.src="/static/"+json_data_mobiles[i]['imagepath1'];

                                    margin_b_20.append(input_checkb);
                                    margin_b_20.append(img);
                                    var mobile_name_p=document.createElement('p')
                                    mobile_name_p.innerHTML=json_data_mobiles[i]['Mobile_Name']
                                    col_md_4_post.append(mobile_name_p)
                                    var mobile_price_p=document.createElement('p')
                                    mobile_price_p.innerHTML=json_data_mobiles[i]['price']
                                    col_md_4_post.append(mobile_price_p)
                                    var link=document.createElement('a');
                                    link.setAttribute('class','link btn btn-success');
                                    // took alot of time finding this solution...
                                    var url = "{% url 'mobileinfo' id=4  %}".replace("4", json_data_mobiles[i]['id']);
                                    link.href= url;
                                    link.target='_blank';
                                    link.text="READ MORE";
                                    col_md_4_post.append(link); 
                                    // if (i%3===0 && i!==0){
                                       
                                    // }
                                    // console.log(i)
                                }
                                // console.log("global_phones_exp_phones",global_phones_exp_phones);
                                for (phones in global_phones_exp_phones){
                                    $('input:checkbox[id^='+global_phones_exp_phones[phones]+"cat"+']:not(:checked)').prop('checked',true);
                                    // console.log("catt",$('input:checkbox[id^='+global_phones_exp_phones[phones].id+"cat"+']:not(:checked)').attr('id'));

                                }
                                $('#pager_div').empty();
                                var pager_div=document.getElementById('pager_div');
                                var pager=document.createElement("div");
                                pager.setAttribute('class','turn-page');
                                pager.id="pager";
                                pager_div.append(pager)
                                $("#mobile_catalog_div").cPager({
                                    // how many items per page
                                    pageSize: 9,
                                    // container ID
                                    pageid: "pager",
                                    // item class
                                    itemClass: "post",
                                    pageIndex: 1
                                    });
                                    $("#pager").show();

                        }
                });
            alert("Unchecked");

        }
      
      }
    function brandCheck_Html_Crt(){
          console.log("brand_set_dict@@@",brand_set_dict)
          var listoftotalbrands=["Samsung","QMobile","Oppo","Apple"];
        
          $("#brand_check_div").empty();
          var brand_check_div=document.getElementById("brand_check_div");
          var col_md_12=document.createElement('div');
          col_md_12.setAttribute("class",'col-md-12');
          brand_check_div.append(col_md_12);
          col_md_12.append("BRANDS")
          var col_md_12=document.createElement('div');
          col_md_12.setAttribute("class",'col-md-12');
          brand_check_div.append(col_md_12);

          for (var i in listoftotalbrands){
              
            console.log("list_element", listoftotalbrands[i])
           
            var row1=document.createElement("div");
            row1.setAttribute("class","row");
            col_md_12.append(row1);
            var col_md_6_1=document.createElement('div');
            col_md_6_1.setAttribute("class",'col-md-6');
            row1.append(col_md_6_1);
            var p_ele=document.createElement("p");
            p_ele.innerHTML=listoftotalbrands[i];
            col_md_6_1.append(p_ele)
            var col_md_6_2=document.createElement('div');
            col_md_6_2.setAttribute("class",'col-md-6');
            row1.append(col_md_6_2);
            var checkbox_inp=document.createElement('input');

            checkbox_inp.setAttribute("onchange","brandCheck_box(this)");
            checkbox_inp.setAttribute("type","checkbox");
            checkbox_inp.value=listoftotalbrands[i];

            if (brand_set_dict[active_button]!==undefined){
                if ( brand_set_dict[active_button].indexOf(listoftotalbrands[i]) > -1){
                checkbox_inp.checked=true;
                }
            }
           
            col_md_6_2.append(checkbox_inp);


          }
      
          



      }
    function cdm_on_co_on_TreeView(){
        $('#cdm_on_co_on_tree_view_div').empty();

            var main_treeview_list=[];
            var main_treeview_dict={};

            main_treeview_dict['name']="CDM On CO ON Criteria Tree View";
            mainchildlist=[];
                    var defaut_criteria_order_dict={};
                    defaut_criteria_order_dict_childlist=[];
                    defaut_criteria_order_dict['name']='Defaut criteria order';

                            for (var i in static_default_crit_show_dict['C.Full'])
                            {
                                
                                var defaut_criteria_order_child_dict={};
                                defaut_criteria_order_child_dict['name']=static_default_crit_show_dict['C.Full'][i];
                                defaut_criteria_order_child_dict['childern']=[];
                                defaut_criteria_order_dict_childlist.push(defaut_criteria_order_child_dict);

                            }
                    defaut_criteria_order_dict['children']=defaut_criteria_order_dict_childlist;
            mainchildlist.push(defaut_criteria_order_dict);
                var colist=block_feat_dict["CO"];
                console.log("OPLO",crit_order_dict)
                console.log("OPLO hide",crit_hide_dict)

                for (var co in colist){
                    var co_dyn_dict={};
                    var co_dyn_childlist=[];
                    co_dyn_dict['name']=colist[co];
                    // C FULL
                        var c_full_dict={};
                        var c_full_childlist=[];
                        c_full_dict['name']="C.Full";

                       
                        if (crit_order_dict[colist[co]+"_C.Full"]!==undefined){

                                    var c_full_selection_dict={};
                                    var c_full_selection_childlist=[];
                                    c_full_selection_dict['name']="C.Full Selection";
                                    for (var i in crit_order_dict[colist[co]+"_C.Full"]){
                                            var c_full_selection_child_dict={};
                                            c_full_selection_child_dict['name']=crit_order_dict[colist[co]+"_C.Full"][i];
                                            c_full_selection_child_dict['childern']=[];
                                            c_full_selection_childlist.push(c_full_selection_child_dict);
                                    }
                                    c_full_selection_dict['children']=c_full_selection_childlist;
                                c_full_childlist.push(c_full_selection_dict);
                        }
                        if (crit_hide_dict[colist[co]+"_C.Full"]!==undefined) {      
                
                                    var c_full_hidden_dict={};
                                    var c_full_hidden_childlist=[];
                                    c_full_hidden_dict['name']="C.Full hidden";
                                    for (var i in crit_hide_dict[colist[co]+"_C.Full"]){
                                            var c_full_hidden_child_dict={};
                                            c_full_hidden_child_dict['name']=crit_hide_dict[colist[co]+"_C.Full"][i];
                                            c_full_hidden_child_dict['childern']=[];
                                            c_full_hidden_childlist.push(c_full_hidden_child_dict);
                                    }
                                    c_full_hidden_dict['children']=c_full_hidden_childlist;
                                c_full_childlist.push(c_full_hidden_dict);
                        }
                        // NExt BOth lines for selection and hidden...
                        c_full_dict['children']=c_full_childlist;

                    co_dyn_childlist.push(c_full_dict);
                    // C_PRUNE
                        var c_prune_dict={};
                        var c_prune_childlist=[];
                        c_prune_dict['name']="C.Prune";
                        if (crit_order_dict[colist[co]+"_C.Prune"]!==undefined){
                                    var c_prune_selection_dict={};
                                    var c_prune_selection_childlist=[];
                                    c_prune_selection_dict['name']="C.Prune Selection";
                                    for (var i in crit_order_dict[colist[co]+"_C.Prune"]){
                                            var c_prune_selection_child_dict={};
                                            c_prune_selection_child_dict['name']=crit_order_dict[colist[co]+"_C.Prune"][i];
                                            c_prune_selection_child_dict['childern']=[];
                                            c_prune_selection_childlist.push(c_prune_selection_child_dict);
                                    }
                                    c_prune_selection_dict['children']=c_prune_selection_childlist;
                                c_prune_childlist.push(c_prune_selection_dict);
                        }
                        if(crit_hide_dict[colist[co]+"_C.Prune"]!==undefined){   
                
                                    var c_prune_hidden_dict={};
                                    var c_prune_hidden_childlist=[];
                                    c_prune_hidden_dict['name']="C.Prune hidden";
                                    for (var i in crit_hide_dict[colist[co]+"_C.Prune"]){
                                            var c_prune_hidden_child_dict={};
                                            c_prune_hidden_child_dict['name']=crit_hide_dict[colist[co]+"_C.Prune"][i];
                                            c_prune_hidden_child_dict['childern']=[];
                                            c_prune_hidden_childlist.push(c_prune_hidden_child_dict);
                                    }
                                    c_prune_hidden_dict['children']=c_prune_hidden_childlist;
                                c_prune_childlist.push(c_prune_hidden_dict);
                        }
                        // NExt BOth lines for selection and hidden...
                        c_prune_dict['children']=c_prune_childlist;
                        
                    co_dyn_childlist.push(c_prune_dict);
                        






                                            
                    


                    co_dyn_dict['children']=co_dyn_childlist
                mainchildlist.push(co_dyn_dict);


                }
                          

    
    main_treeview_dict['children']=mainchildlist


    main_treeview_list.push(main_treeview_dict);
    var tree=main_treeview_list;
    //
    // Create tree
    //
    var t = new TreeView(tree, 'cdm_on_co_on_tree_view_div');
    t.expandAll(); 
       
    }
    function hideFromDisplay_Cdm_CO_On(id) {
           var item = $('#'+id);
           console.log(id);
           var temp=document.getElementById(id);
          //  var temp = item;
          
          item.find(".show_hide").remove();
          //  var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay('+id+'))');
          // var btn = $('<button>Show</button>').attr('width','200px').addClass('show_hide').attr('onclick', '(showToDisplay($(this).parent().attr("id")))');
          var btn=document.createElement('button');
          btn.setAttribute('class','show_hide');
          btn.setAttribute('onclick','showToDisplay_Cdm_CO_On($(this).parent().parent().parent().attr("id"))');
          btn.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');

          btn.innerHTML="show"
          var data = id.split("_");  
          console.log("data",data[0]);
          var arr=[];
          var elem="";
          for (var key in data){   
                        console.log("key",key);
                        arr.push(data[key]);
                        elem=data[key];
                        break;
                    } 
            item.remove();
            // if active_co doesnt exsist then user is using default func so 
            // check if active_co exists, if it doesn't then simply 
            // run default_crit_show_dict['default'].indexOf(elem);;;;
            var colist=block_feat_dict["CO"];
            // def_dict_show_obj=JSON.parse(JSON.stringify(default_crit_show_dict));
            for ( var co in colist){
                var koool=colist[co]+"_"+co_feature_active;
                console.log("KOOOL",koool)
                        // if (crit_order_dict[koool]===undefined){
                        //     crit_order_dict[koool]=[]
                        //     crit_order_dict[koool]=def_dict_show_obj["C.Full"]
                        //     crit_hide_dict[koool]=[]
                console.log("crit_order_dict",crit_order_dict)
                        // }
                var index = crit_order_dict[koool].indexOf(elem);
                    console.log("INDEX",index)
                    if (index > -1) {
                        console.log("crit_order_dict[koool]--",crit_order_dict[koool])
                        crit_order_dict[koool].splice(index, 1);
                        console.log("crit_order_dict[koool]--",crit_order_dict[koool])
                        crit_hide_dict[koool].push(elem);
                        console.log("crit_hide_dict--",crit_hide_dict[koool])

                        }
                
                   

        }
            
           
                console.log("default_crit_show_dict>>>>",default_crit_show_dict);
                console.log("crit_order_dict###",crit_order_dict);
                console.log("crit_hide_dict###",crit_hide_dict);


            
            

                    var mylist=document.getElementById('myList');
                    
                    while (temp.firstChild) {
                    temp.removeChild(temp.firstChild);
                    }
                    console.log("lastchild",temp);
                    mylist.append(temp);

                    var div_row=document.createElement('div');
                    div_row.setAttribute('class','row');
                    temp.append(div_row);
                    var div_col_md_6_1=document.createElement('div');
                    div_col_md_6_1.setAttribute('class','col');
                    div_row.append(div_col_md_6_1);
                    var btn_btn_primary=document.createElement('btn');
                    btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                    btn_btn_primary.innerHTML=data[0];
                    btn_btn_primary.title=data[0];

                    div_col_md_6_1.append(btn_btn_primary);
                    var div_col_md_6_2=document.createElement('div');
                    div_col_md_6_2.setAttribute('class','col');
                    div_row.append(div_col_md_6_2);
                    div_col_md_6_2.append(btn);
                    cdm_on_co_on_TreeView();
 
         } 
    function showToDisplay_Cdm_CO_On(id) {
            console.log("showToDisplayid",id)
            var item = $("#"+id);
            //var item=document.getElementById(id)
            // var item = $(id);
             var temp = document.getElementById(id);
            item.find(".show_hide").remove();
            //  var btn = $('<button>Hide</button>').attr('width', '200px').addClass('show_hide').attr('onclick', '(hideFromDisplay($(this).parent().attr("id")))');
            var btn=document.createElement('button');
            btn.setAttribute('class','show_hide');
            btn.setAttribute('onclick',"hideFromDisplay_Cdm_CO_On($(this).parent().parent().parent().attr('id'))");
            btn.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")

            btn.innerHTML="Hide";
            var data =item.attr('id');
            console.log("showToDisplay_data",data)
            var d=data.split("_");
            var arr=[]; 
            var elem='';
            console.log("Dddd",d)
                for (var key in d)
                  {   
                          console.log("key",key);
                          arr.push(d[key]);
                          elem=d[key];
                          console.log("ELEM",elem)
                          break;
                }
                item.remove();
        
                // temp.append(btn);
            /*
                    // if active_co doesnt exsist then user is using default func so 
                    // check if active_co exists, if it doesn't then simply 
                    // run default_crit_hide_dict['default'].indexOf(elem);;;;
            */
            
               
                    console.log("active_co",active_co)
                    var colist=block_feat_dict["CO"];
                    for (var co in colist){
                        var koool=colist[co]+"_"+co_feature_active;
                        var index = crit_hide_dict[koool].indexOf(elem);
                        console.log("INDEX",index)
                        if (index > -1) {
                        crit_hide_dict[koool].splice(index, 1);
                        crit_order_dict[koool].push(elem);

                        }
                    }
                    console.log("crit_order_dict>>>>",crit_order_dict);
                    console.log("crit_hide_dict>>>>",crit_hide_dict);
                   
                
            
            
         
                var ul_sortable=document.getElementById('sortable');
                ul_sortable.append(temp);
                while (temp.firstChild) {
                temp.removeChild(temp.firstChild);
                }
        
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                temp.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute("class","sortable_custom_show_btns");
                btn_btn_primary.innerHTML=d[0];
                btn_btn_primary.title=d[0];

                div_col_md_6_1.append(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute("class","col");
                div_row.append(div_col_md_6_2);
                div_col_md_6_2.appendChild(btn);
                cdm_on_co_on_TreeView();

           
         }
        
    
    function htmlF(shw_disp,hide_disp,mand,feat_dsp,feat_hide,flg){
        
        var disp_feat_div=document.getElementById('display_feature_div');
        var ul_sortable=document.createElement('ul');
        ul_sortable.setAttribute('id','sortable');
        disp_feat_div.append(ul_sortable);
                for (var i in feat_dsp){
                var li_sortable=document.createElement('li');
                // li_sortable.id=feat_dsp[i].feature+"_"+feat_dsp[i].position;
                    if (flg==="true"){
                        li_sortable.id=feat_dsp[i]+"_"+parseInt(i);

                }else{
                        console.log("feat_dsp[i][0]",feat_dsp[i][0])
                        li_sortable.id=feat_dsp[i][0]+"_"+feat_dsp[i][1];
                }
                ul_sortable.append(li_sortable);
                var div_row=document.createElement('div');
                div_row.setAttribute("class",'row');
                li_sortable.append(div_row);    
                var div_col_md_6_1=document.createElement('div');
                div_col_md_6_1.setAttribute("class","col");
                div_row.append(div_col_md_6_1);
                var btn_btn_primary=document.createElement('button');
                btn_btn_primary.setAttribute("class","sortable_custom_show_btns");

                // btn_btn_primary.innerHTML=feat_dsp[i].feature;
                if (flg==="true"){
                    btn_btn_primary.innerHTML=feat_dsp[i];
                    btn_btn_primary.title=feat_dsp[i];

                }else{
                    btn_btn_primary.innerHTML=feat_dsp[i][0];
                }
                div_col_md_6_1.appendChild(btn_btn_primary);
                var div_col_md_6_2=document.createElement('div');
                div_col_md_6_2.setAttribute('class',"col");
                div_row.append(div_col_md_6_2);
                    // check if i present in mandatory list. If it does dont show the hide button
                if (flg==="true"){
                    var fet_dsp=feat_dsp[i];
                }else{
                    var fet_dsp=feat_dsp[i][0];
                }
                if(mand.includes(fet_dsp)){
                    console.log("HIDE THE HIDE buttOn")
                }
                else {
                    if(cdm_crit_order_on_flag==="true"){

                    }
                    else{
                        var btn_show_hide=document.createElement('button');
                        btn_show_hide.setAttribute("class","show_hide");
                        btn_show_hide.setAttribute("style","background-color: rgba(212, 17, 17, 0.664); border: 1px solid  rgba(212, 17, 17, 0.664); ")
                        if (CO_CDM_COMB==="CDM_off_CO_off"){
                            btn_show_hide.setAttribute("onclick","hideFromDisplay_Default($(this).parent().parent().parent().attr('id'))");

                        }
                        else if (CO_CDM_COMB==="CDM_on_CO_off"){
                            btn_show_hide.setAttribute("onclick","hideFromDisplay_CDM($(this).parent().parent().parent().attr('id'))");

                        }
                        else if (CO_CDM_COMB==="CDM_off_CO_on"){
                            btn_show_hide.setAttribute("onclick","hideFromDisplay_Def_Cdm_CO_On($(this).parent().parent().parent().attr('id'))");

                        }
                        else if (CO_CDM_COMB==="CDM_on_CO_on"){
                            btn_show_hide.setAttribute("onclick","hideFromDisplay_Cdm_CO_On($(this).parent().parent().parent().attr('id'))");

                        }
                        btn_show_hide.innerHTML="Hide";
                        div_col_md_6_2.appendChild(btn_show_hide);
                    
                    }
                
                }
                if (flg==="true"){
                    shw_disp.push(feat_dsp[i]);
                }else{
                    // shw_disp.push(feat_dsp[i].criteria_name);
                    // console.log("feat_dsp[i].criteria_name",feat_dsp[i].criteria_name)
                    shw_disp.push(feat_dsp[i][0]);
                }

            


            }
                                if(feat_hide.length!==0){
                                var hide_feat_div=document.getElementById('hide_feature_div');
                                var ul_hiddenfeat=document.createElement('ul');
                                ul_hiddenfeat.setAttribute("id","hiddenfeat");
                                hide_feat_div.append(ul_hiddenfeat);
                                for (var i in feat_hide){

                                    // console.log(feat_hide[i].feature);
                                    var li_hiddenfeat=document.createElement('li');
                                    // li_hiddenfeat.id=feat_hide[i].feature+"_"+feat_hide[i].position
                                    //li_hiddenfeat.id=feat_hide[i].criteria_name+"_"+feat_hide[i].position
                                if (flg==="true"){
                                        li_hiddenfeat.id=feat_hide[i]+"_"+0

                                }else{
                                        li_hiddenfeat.id=feat_hide[i][0]+"_"+0

                                }

                                    ul_hiddenfeat.append(li_hiddenfeat);

                                    var div_row=document.createElement('div')
                                    div_row.setAttribute('class','row');
                                    li_hiddenfeat.append(div_row);
                                    var div_col_md_6_1=document.createElement('div');
                                    div_col_md_6_1.setAttribute('class','col');
                                    div_row.append(div_col_md_6_1);
                                    var div_col_md_6_2=document.createElement('div');
                                    div_col_md_6_2.setAttribute('class','col');
                                    div_row.append(div_col_md_6_2);
                                    var btn_btn_primary=document.createElement('btn');
                                    btn_btn_primary.setAttribute('class','sortable_custom_hide_btns');
                                    // btn_btn_primary.innerHTML=feat_hide[i].feature;
                                    //btn_btn_primary.innerHTML=feat_hide[i].criteria_name;
                                    if (flg==="true"){
                                        btn_btn_primary.innerHTML=feat_hide[i];
                                        btn_btn_primary.title=feat_hide[i];

                                    }else{
                                        btn_btn_primary.innerHTML=feat_hide[i][0];

                                    }
                                    div_col_md_6_1.append(btn_btn_primary);
                                    if(cdm_crit_order_on_flag==="true"){

                                    }
                                    else{
                                        var btn_show_hide=document.createElement('button');
                                        btn_show_hide.setAttribute('class','show_hide');
                                        btn_show_hide.setAttribute('style','  background-color: rgba(1, 255, 1, 0.664);   border: 1px solid  rgba(1, 255, 1, 0.664);');
                                        if (CO_CDM_COMB==="CDM_off_CO_off"){
                                            btn_show_hide.setAttribute("onclick","showToDisplay_Default($(this).parent().parent().parent().attr('id'))");

                                        }
                                        else if (CO_CDM_COMB==="CDM_on_CO_off"){
                                            btn_show_hide.setAttribute('onclick','showToDisplay_CDM($(this).parent().parent().parent().attr("id"))');

                                        }
                                        else if (CO_CDM_COMB==="CDM_off_CO_on"){
                                            btn_show_hide.setAttribute('onclick','showToDisplay_Def_Cdm_CO_On($(this).parent().parent().parent().attr("id"))');

                                        }
                                        else if (CO_CDM_COMB==="CDM_on_CO_on"){
                                            btn_show_hide.setAttribute('onclick','showToDisplay_Cdm_CO_On($(this).parent().parent().parent().attr("id"))');

                                        }
                                        btn_show_hide.innerHTML="show";
                                        div_col_md_6_2.append(btn_show_hide);
                                    }
                                 
                                    // hide_disp.push(feat_hide[i].feature)
                                    if (flg==="true"){
                                        hide_disp.push(feat_hide[i])

                                        }else{
                                            hide_disp.push(feat_hide[i][0])

                                            // hide_disp.push(feat_hide[i].criteria_name)
                                        }
                               }
                            }
                            
                                
                               
  
  data={}
  data['shw_disp']=shw_disp;
  data['hide_disp']=hide_disp;
  return  data         

}





</script>

<script>

$( function() {
   
    $(this).tooltip();
} );
    
</script>
<script>
//     $(document).ready(function () {
//         $("#loading").hide();

//     $(document).ajaxStart(function () {
//         $("#loading").show();
//     }).ajaxStop(function () {
//         $("#loading").hide();
//     });
// });
$body = $("body");
$(document).on({
    ajaxStart: function() { $body.addClass("loading");    },
     ajaxStop: function() { $body.removeClass("loading"); }    
});

function getDefaultFLevelsFromPlatformFeature(){
    $.ajax({
                type:"POST",
                dataType:"json",
                'data':{
               
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                url: "{% url 'get_default_f_levels_from_platform_feature' %}",
                success: function(data){
                    block_feat_dict_def=JSON.parse(data['def_featlvl_frm_pf_dict']);
                    console.log("block_feat_dict_def",block_feat_dict_def)
                }
        });
}
function submitDescription(){
    $('#text_area_desp').val();
    console.log( $('#text_area_desp').val())
    exp_description=$('#text_area_desp').val();
    alert(exp_id)
    if (exp_id!==""){
        alert(exp_id)
        $.ajax({
                type:"POST",
                dataType:"json",
                'data':{
                    'exp_description':exp_description,
                    'exp_id':exp_id,
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                url: "{% url 'addexpdiscp' %}",
                        success: function(data){}
        });
    }

}
</script>
{%endblock%}